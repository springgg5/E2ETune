SELECT c_name, c_region, COUNT(lo_orderkey) as num_orders, AVG(lo_extendedprice) as avg_price FROM lineorder JOIN customer ON lineorder.lo_custkey = customer.c_custkey WHERE lo_orderpriority = '1-URGENT' AND lo_shippriority = '0' GROUP BY c_name, c_region ORDER BY num_orders DESC, avg_price DESC;
SELECT p_category, p_brand, SUM(lo_quantity) as total_quantity, SUM(lo_revenue) as total_revenue FROM lineorder JOIN part ON lineorder.lo_partkey = part.p_partkey WHERE lo_orderdate BETWEEN (SELECT d_datekey FROM date_dim WHERE d_year = 2021 AND d_monthnuminyear = 1) AND (SELECT d_datekey FROM date_dim WHERE d_year = 2021 AND d_monthnuminyear = 6) AND p_category IN ('MFGR#25', 'MFGR#43', 'MFGR#34') GROUP BY p_category, p_brand ORDER BY total_revenue DESC;
SELECT s_name, s_nation, s_region, COUNT(lo_orderkey) as num_orders, SUM(lo_supplycost) as total_supply_cost FROM lineorder JOIN supplier ON lineorder.lo_suppkey = supplier.s_suppkey WHERE lo_commitdate BETWEEN (SELECT d_datekey FROM date_dim WHERE d_year = 2021 AND d_weeknuminyear = 1) AND (SELECT d_datekey FROM date_dim WHERE d_year = 2021 AND d_weeknuminyear = 26) AND s_region IN ('ASIA', 'MIDDLE EAST', 'AMERICA') GROUP BY s_name, s_nation, s_region ORDER BY num_orders DESC, total_supply_cost DESC;
SELECT d_month, d_year, COUNT(lo_orderkey) as num_orders, SUM(lo_tax) as total_tax FROM lineorder JOIN date_dim ON lineorder.lo_orderdate = date_dim.d_datekey WHERE d_year = 2021 AND d_month IN ('January', 'April', 'July') AND lo_tax IN (1, 2, 3) GROUP BY d_month, d_year ORDER BY d_year, d_month;