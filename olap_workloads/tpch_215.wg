SELECT n_name, r_name, COUNT(c_custkey) AS num_customers, AVG(c_acctbal) AS avg_acctbal FROM customer JOIN nation ON c_nationkey = n_nationkey JOIN region ON n_regionkey = r_regionkey WHERE r_name = 'MIDDLE EAST' GROUP BY n_name, r_name ORDER BY num_customers DESC, avg_acctbal DESC;
SELECT p_type, p_brand, SUM(ps_availqty) AS total_avail_qty, AVG(ps_supplycost) AS avg_supplycost FROM part JOIN partsupp ON p_partkey = ps_partkey WHERE p_brand IN ('Brand#34', 'Brand#43', 'Brand#55') AND p_type IN ('LARGE ANODIZED NICKEL', 'LARGE ANODIZED BRASS', 'PROMO BURNISHED NICKEL') GROUP BY p_type, p_brand ORDER BY total_avail_qty DESC, avg_supplycost;
SELECT o_orderpriority, COUNT(o_orderkey) AS num_orders, SUM(l_extendedprice * (1 - l_discount)) AS revenue FROM orders JOIN lineitem ON o_orderkey = l_orderkey WHERE o_orderdate BETWEEN '1996-01-01' AND '1996-12-31' AND l_shipdate > o_orderdate GROUP BY o_orderpriority ORDER BY revenue DESC;
SELECT s_name, s_suppkey, COUNT(l_orderkey) AS num_orders, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue FROM supplier JOIN lineitem ON s_suppkey = l_suppkey JOIN orders ON l_orderkey = o_orderkey WHERE o_orderdate BETWEEN '1996-01-01' AND '1996-12-31' AND l_shipdate > o_orderdate GROUP BY s_name, s_suppkey HAVING COUNT(l_orderkey) > 10 ORDER BY total_revenue DESC;