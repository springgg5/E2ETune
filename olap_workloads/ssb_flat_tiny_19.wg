SELECT c_region, s_region, p_category, SUM(lo_revenue) AS revenue, AVG(lo_extendedprice) AS avg_price, COUNT(DISTINCT lo_orderkey) AS num_orders FROM lineorder_flat WHERE lo_discount = 3 AND lo_commitdate = 19940907 AND lo_tax = 3 GROUP BY c_region, s_region, p_category ORDER BY revenue DESC, avg_price DESC, num_orders DESC;
SELECT c_mktsegment, p_brand, p_type, SUM(lo_quantity) AS total_quantity, AVG(lo_supplycost) AS avg_supply_cost, COUNT(DISTINCT lo_suppkey) AS num_suppliers FROM lineorder_flat WHERE lo_discount = 6 AND lo_commitdate = 19971210 AND lo_tax = 6 GROUP BY c_mktsegment, p_brand, p_type ORDER BY total_quantity DESC, avg_supply_cost DESC, num_suppliers DESC;
SELECT lo_orderpriority, c_nation, s_nation, COUNT(DISTINCT lo_custkey) AS num_customers, SUM(lo_ordtotalprice) AS total_order_price, AVG(lo_revenue) AS avg_revenue FROM lineorder_flat WHERE lo_discount = 0 AND lo_commitdate = 19970928 AND lo_tax = 4 GROUP BY lo_orderpriority, c_nation, s_nation ORDER BY num_customers DESC, total_order_price DESC, avg_revenue DESC;