SELECT t1.title, t1.production_year, COUNT(t2.movie_id) AS num_references FROM title AS t1 JOIN movie_link AS t2 ON t1.id = t2.movie_id JOIN link_type AS t3 ON t2.link_type_id = t3.id WHERE t3.link = 'references' GROUP BY t1.title, t1.production_year HAVING COUNT(t2.movie_id) > 10 ORDER BY num_references DESC, t1.production_year DESC;
SELECT t1.title, t1.production_year, AVG(cast_info.nr_order) AS avg_order FROM title AS t1 JOIN cast_info ON t1.id = cast_info.movie_id WHERE t1.production_year BETWEEN 2000 AND 2020 AND t1.kind_id = 1 GROUP BY t1.title, t1.production_year HAVING COUNT(cast_info.person_id) > 5 ORDER BY avg_order ASC, t1.production_year DESC;
SELECT t1.title, t1.production_year, COUNT(DISTINCT keyword_id) AS num_keywords FROM title AS t1 JOIN movie_keyword ON t1.id = movie_keyword.movie_id WHERE t1.production_year >= 1990 AND t1.episode_nr IN (20, 45, 16) GROUP BY t1.title, t1.production_year HAVING COUNT(DISTINCT keyword_id) > 5 ORDER BY num_keywords DESC, t1.production_year DESC;