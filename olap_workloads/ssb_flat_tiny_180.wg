SELECT c_region, p_category, SUM(lo_extendedprice * (1 - lo_discount)) AS revenue FROM lineorder_flat WHERE p_color IN ('dark', 'misty', 'lime') AND lo_quantity BETWEEN 7 AND 36 GROUP BY c_region, p_category ORDER BY c_region, p_category;
SELECT lo_orderpriority, COUNT(*) AS order_count, AVG(lo_ordtotalprice) AS avg_order_price FROM (SELECT lo_orderpriority, lo_orderkey, SUM(lo_extendedprice) AS lo_ordtotalprice FROM lineorder_flat WHERE p_name IN ('navajo azure', 'coral wheat', 'wheat medium') GROUP BY lo_orderpriority, lo_orderkey) AS subquery GROUP BY lo_orderpriority ORDER BY lo_orderpriority;