SELECT t.id, t.title, COUNT(mk.keyword_id) AS keyword_count FROM title AS t JOIN movie_keyword AS mk ON t.id = mk.movie_id WHERE t.kind_id = 3 GROUP BY t.id, t.title HAVING COUNT(mk.keyword_id) > 10 ORDER BY keyword_count DESC, t.title ASC LIMIT 10;
SELECT n.name, COUNT(ci.movie_id) AS movie_count FROM name AS n JOIN cast_info AS ci ON n.id = ci.person_id JOIN role_type AS rt ON ci.role_id = rt.id WHERE rt.role = 'actor' OR rt.role = 'actress' GROUP BY n.name HAVING COUNT(ci.movie_id) > 20 ORDER BY movie_count DESC, n.name ASC;
SELECT t.title, COUNT(DISTINCT ci.person_id) AS cast_count FROM title AS t JOIN cast_info AS ci ON t.id = ci.movie_id WHERE t.kind_id = 6 AND t.production_year BETWEEN 2000 AND 2010 GROUP BY t.title HAVING COUNT(DISTINCT ci.person_id) > 10 ORDER BY cast_count DESC, t.title ASC;
SELECT lt.link, COUNT(ml.link_type_id) AS link_count FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id GROUP BY lt.link HAVING COUNT(ml.link_type_id) > 50 ORDER BY link_count DESC, lt.link ASC;
SELECT t.title, COUNT(DISTINCT mc.company_id) AS company_count FROM title AS t JOIN movie_companies AS mc ON t.id = mc.movie_id WHERE t.kind_id = 5 AND mc.company_type_id = 1 GROUP BY t.title HAVING COUNT(DISTINCT mc.company_id) > 1 ORDER BY company_count DESC, t.title ASC;
SELECT kt.kind, COUNT(t.kind_id) AS kind_count FROM title AS t JOIN kind_type AS kt ON t.kind_id = kt.id WHERE t.production_year BETWEEN 1990 AND 2000 GROUP BY kt.kind HAVING COUNT(t.kind_id) > 10 ORDER BY kind_count DESC, kt.kind ASC;
SELECT t.title, COUNT(DISTINCT ci.person_id) AS director_count FROM title AS t JOIN cast_info AS ci ON t.id = ci.movie_id JOIN role_type AS rt ON ci.role_id = rt.id WHERE rt.role = 'director' AND t.kind_id = 3 GROUP BY t.title HAVING COUNT(DISTINCT ci.person_id) > 1 ORDER BY director_count DESC, t.title ASC;