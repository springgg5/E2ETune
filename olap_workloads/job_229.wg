SELECT cn.name, COUNT(*) AS num_characters, k.keyword, COUNT(*) FILTER (WHERE k.phonetic_code = 'T614' OR k.phonetic_code = 'U5321' OR k.phonetic_code = 'F6235') AS num_keywords FROM char_name AS cn JOIN cast_info AS ci ON cn.id = ci.person_role_id JOIN movie_keyword AS mk ON ci.movie_id = mk.movie_id JOIN keyword AS k ON mk.keyword_id = k.id WHERE cn.name_pcode_nf IN ('C135', 'L3426', 'C5246') AND cn.md5sum IN ('8daf96aadf21b930da482dd770fd7b2c', '18f44b1a7909f6054afcbaafc0aed75c', '2e315b4bff3a0b29959df2d33afc9654') GROUP BY cn.name, k.keyword ORDER BY num_characters DESC, num_keywords DESC;
SELECT p.name, COUNT(*) AS num_persons, SUM(CASE WHEN pi.info_type_id = 35 THEN 1 ELSE 0 END) AS num_birthdays FROM person_info AS pi JOIN name AS p ON pi.person_id = p.id WHERE pi.id IN (250, 672, 171) AND pi.info_type_id IN (28, 39, 35) AND pi.info IN ('Van Zandt County, Texas, USA', 'TV Guide (USA), 2 July 1955', '21 February 1982') GROUP BY p.name HAVING COUNT(*) > 1 ORDER BY num_persons DESC, num_birthdays DESC;