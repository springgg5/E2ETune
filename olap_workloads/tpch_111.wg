SELECT n_name, r_name, COUNT(*) AS num_customers FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey GROUP BY n_name, r_name ORDER BY num_customers DESC;
SELECT s_name, s_phone, SUM(ps_availqty) AS total_inventory FROM supplier s JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey WHERE s.s_nationkey IN (7, 19, 23) GROUP BY s_name, s_phone HAVING SUM(ps_availqty) > 10000 ORDER BY total_inventory DESC;
SELECT o_orderpriority, COUNT(*) AS num_orders, AVG(o_totalprice) AS avg_order_price FROM orders WHERE o_orderdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY o_orderpriority ORDER BY num_orders DESC;
SELECT p_type, p_brand, SUM(l_quantity) AS total_quantity, AVG(l_extendedprice) AS avg_price FROM lineitem l JOIN part p ON l.l_partkey = p.p_partkey WHERE l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY p_type, p_brand ORDER BY total_quantity DESC;
SELECT c_mktsegment, COUNT(DISTINCT o_orderkey) AS num_orders, SUM(l_extendedprice * (1 - l_discount)) AS revenue FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE o.o_orderdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY c_mktsegment ORDER BY revenue DESC;
SELECT s_name, s_address, s_phone, COUNT(DISTINCT l_orderkey) AS num_orders FROM supplier s JOIN lineitem l ON s.s_suppkey = l.l_suppkey WHERE l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY s_name, s_address, s_phone ORDER BY num_orders DESC;
SELECT n_name, COUNT(DISTINCT l_orderkey) AS num_orders, SUM(l_extendedprice * (1 - l_discount)) AS revenue FROM nation n JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE o.o_orderdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY n_name ORDER BY revenue DESC;
SELECT p_name, p_mfgr, COUNT(DISTINCT l_orderkey) AS num_orders, SUM(l_extendedprice * (1 - l_discount)) AS revenue FROM part p JOIN lineitem l ON p.p_partkey = l.l_partkey WHERE l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY p_name, p_mfgr ORDER BY revenue DESC;