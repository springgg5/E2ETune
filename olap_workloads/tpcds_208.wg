SELECT s.s_state, AVG(sr.sr_net_loss) AS average_net_loss FROM store_returns sr JOIN store s ON sr.sr_store_sk = s.s_store_sk WHERE sr.sr_returned_date_sk BETWEEN 2450928 AND 2452657 AND sr.sr_store_credit BETWEEN 1.09 AND 32.73 AND sr.sr_store_sk IN (10, 8, 4) GROUP BY s.s_state ORDER BY average_net_loss DESC;
SELECT ca.ca_location_type, COUNT(c.c_customer_id) AS customer_count, SUM(ss.ss_net_profit) AS total_net_profit FROM customer c JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk WHERE ca.ca_state IN ('HI', 'UT', 'DC') AND ca.ca_address_id IN ('AAAAAAAAPPBAAAAA', 'AAAAAAAAJACAAAAA', 'AAAAAAAAJAAAAAAA') GROUP BY ca.ca_location_type HAVING COUNT(c.c_customer_id) > 10 ORDER BY total_net_profit DESC;