SELECT c_city, c_nation, c_region, SUM(lo_extendedprice) AS total_extended_price, AVG(lo_discount) AS avg_discount FROM lineorder_flat WHERE lo_orderpriority = '1-URGENT' AND lo_shipmode = 'AIR' GROUP BY c_city, c_nation, c_region ORDER BY total_extended_price DESC, avg_discount ASC;
SELECT p_category, p_brand, p_color, COUNT(*) AS product_count, SUM(lo_quantity) AS total_quantity FROM lineorder_flat WHERE lo_orderdate >= 20210101 AND lo_orderdate <= 20211231 AND lo_custkey IN (SELECT lo_custkey FROM lineorder_flat WHERE c_mktsegment = 'AUTOMOBILE') GROUP BY p_category, p_brand, p_color ORDER BY product_count DESC, total_quantity DESC;
SELECT s_name, s_city, s_nation, s_region, COUNT(*) AS order_count, SUM(lo_supplycost) AS total_supply_cost FROM lineorder_flat WHERE lo_commitdate >= 20210101 AND lo_commitdate <= 20211231 AND s_phone IN ('29-852-419-2587', '32-851-493-8588', '34-153-665-8905') GROUP BY s_name, s_city, s_nation, s_region ORDER BY order_count DESC, total_supply_cost DESC;
SELECT c_name, c_city, c_nation, c_region, COUNT(*) AS order_count, SUM(lo_revenue) AS total_revenue FROM lineorder_flat WHERE lo_orderdate >= 20210101 AND lo_orderdate <= 20211231 AND lo_custkey IN (SELECT lo_custkey FROM lineorder_flat WHERE c_mktsegment = 'BUILDING') GROUP BY c_name, c_city, c_nation, c_region HAVING COUNT(*) > 10 ORDER BY total_revenue DESC;
SELECT p_mfgr, p_category, p_brand, COUNT(*) AS product_count, AVG(lo_quantity) AS avg_quantity, AVG(lo_extendedprice) AS avg_extended_price FROM lineorder_flat WHERE lo_orderdate >= 20210101 AND lo_orderdate <= 20211231 AND lo_custkey IN (SELECT lo_custkey FROM lineorder_flat WHERE c_mktsegment = 'FURNITURE') GROUP BY p_mfgr, p_category, p_brand HAVING COUNT(*) > 5 ORDER BY avg_quantity DESC, avg_extended_price DESC;
SELECT s_name, s_city, s_nation, s_region, COUNT(*) AS order_count, SUM(lo_revenue) AS total_revenue FROM lineorder_flat WHERE lo_orderdate >= 20210101 AND lo_orderdate <= 20211231 AND lo_suppkey IN (SELECT lo_suppkey FROM lineorder_flat WHERE s_address IN ('L9kD3Hzc4', 'N4kfEoZRwPnXS', '2xeAFTJ')) GROUP BY s_name, s_city, s_nation, s_region HAVING COUNT(*) > 10 ORDER BY total_revenue DESC;