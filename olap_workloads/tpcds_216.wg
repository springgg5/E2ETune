SELECT ca_state, COUNT(*) AS num_customers FROM customer_address GROUP BY ca_state ORDER BY num_customers DESC LIMIT 5;
SELECT d_year, d_month_seq, SUM(ss_sales_price) AS total_sales FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk GROUP BY d_year, d_month_seq ORDER BY d_year, d_month_seq;
SELECT w_state, AVG(inv_quantity_on_hand) AS avg_inventory FROM inventory JOIN warehouse ON inv_warehouse_sk = w_warehouse_sk GROUP BY w_state HAVING AVG(inv_quantity_on_hand) > 5000 ORDER BY avg_inventory DESC;
SELECT i_category, COUNT(*) AS num_items FROM item GROUP BY i_category HAVING COUNT(*) > 100 ORDER BY num_items DESC;
SELECT c_birth_year, COUNT(*) AS num_customers FROM customer WHERE c_preferred_cust_flag = 'Y' GROUP BY c_birth_year ORDER BY num_customers DESC;
SELECT p_promo_name, SUM(cs_sales_price) AS total_sales FROM catalog_sales JOIN promotion ON cs_promo_sk = p_promo_sk WHERE cs_order_number BETWEEN 100460 AND 100727 GROUP BY p_promo_name HAVING SUM(cs_sales_price) > 10000 ORDER BY total_sales DESC;
SELECT ib_upper_bound, COUNT(*) AS num_customers FROM customer_demographics JOIN income_band ON cd_demo_sk = ib_income_band_sk WHERE ib_lower_bound >= 30001 AND ib_upper_bound <= 150000 GROUP BY ib_upper_bound ORDER BY num_customers DESC;
SELECT d_year, d_qoy, COUNT(*) AS num_orders FROM web_sales JOIN date_dim ON ws_sold_date_sk = d_date_sk WHERE ws_net_paid_inc_ship_tax >= 100 AND ws_net_paid_inc_ship_tax <= 500 GROUP BY d_year, d_qoy ORDER BY d_year, d_qoy;