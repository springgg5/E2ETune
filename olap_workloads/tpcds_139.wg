SELECT s_store_name, COUNT(ss_ticket_number) AS total_tickets, AVG(ss_sales_price) AS avg_sales_price FROM store_sales INNER JOIN store ON store_sales.ss_store_sk = store.s_store_sk WHERE store.s_hours = '8AM-4PM' AND store.s_rec_start_date >= '1999-03-14' GROUP BY s_store_name ORDER BY total_tickets DESC;
SELECT s_store_name, COUNT(ss_ticket_number) AS total_tickets, AVG(ss_sales_price) AS avg_sales_price FROM store_sales INNER JOIN store ON store_sales.ss_store_sk = store.s_store_sk WHERE store.s_hours = '8AM-12AM' AND store.s_rec_start_date >= '2000-03-13' GROUP BY s_store_name ORDER BY total_tickets DESC;
SELECT i_item_id, i_item_desc, SUM(inv_quantity_on_hand) AS total_inventory FROM inventory INNER JOIN item ON inventory.inv_item_sk = item.i_item_sk GROUP BY i_item_id, i_item_desc HAVING SUM(inv_quantity_on_hand) > 1000 ORDER BY total_inventory DESC;
SELECT wr_returning_cdemo_sk, SUM(wr_refunded_cash) AS total_refunded_cash FROM web_returns WHERE wr_refunded_cash > 3.08 AND wr_returning_cdemo_sk = 1890204 GROUP BY wr_returning_cdemo_sk;
SELECT wr_refunded_cdemo_sk, COUNT(wr_order_number) AS total_orders, AVG(wr_refunded_cash) AS avg_refunded_cash FROM web_returns WHERE wr_refunded_cdemo_sk IN (764507, 135659, 1625335) GROUP BY wr_refunded_cdemo_sk HAVING COUNT(wr_order_number) > 10 ORDER BY avg_refunded_cash DESC;
SELECT p_promo_name, COUNT(cs_order_number) AS total_orders, SUM(cs_net_profit) AS total_profit FROM catalog_sales INNER JOIN promotion ON catalog_sales.cs_promo_sk = promotion.p_promo_sk GROUP BY p_promo_name HAVING COUNT(cs_order_number) > 100 AND SUM(cs_net_profit) > 1000 ORDER BY total_profit DESC;
SELECT ws_web_site_sk, COUNT(ws_order_number) AS total_orders, AVG(ws_net_paid) AS avg_net_paid FROM web_sales WHERE ws_web_site_sk IN (SELECT web_site_sk FROM web_site WHERE web_tax_percentage > 5) GROUP BY ws_web_site_sk HAVING COUNT(ws_order_number) > 50 ORDER BY avg_net_paid DESC;