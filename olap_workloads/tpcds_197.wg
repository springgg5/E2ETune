SELECT c.c_first_name, c.c_last_name, SUM(ss.ss_sales_price) as total_sales FROM customer c JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk WHERE c.c_birth_year = 1991 GROUP BY c.c_first_name, c.c_last_name ORDER BY total_sales DESC LIMIT 10;
SELECT wp.wp_web_page_id, COUNT(*) as page_views FROM web_page wp WHERE wp.wp_autogen_flag = 'N' GROUP BY wp.wp_web_page_id HAVING COUNT(*) > 1000 ORDER BY page_views DESC;
SELECT r.r_reason_desc, COUNT(*) as return_count FROM reason r JOIN store_returns sr ON r.r_reason_sk = sr.sr_reason_sk WHERE r.r_reason_desc = 'Did not fit' OR r.r_reason_desc = 'Did not like the model' GROUP BY r.r_reason_desc;
SELECT w.w_warehouse_name, SUM(inv.inv_quantity_on_hand) as total_inventory FROM warehouse w JOIN inventory inv ON w.w_warehouse_sk = inv.inv_warehouse_sk GROUP BY w.w_warehouse_name HAVING SUM(inv.inv_quantity_on_hand) > 10000 ORDER BY total_inventory DESC;
SELECT i.i_class, AVG(i.i_wholesale_cost) as avg_wholesale_cost, AVG(i.i_current_price) as avg_current_price FROM item i GROUP BY i.i_class HAVING AVG(i.i_wholesale_cost) > 100 AND AVG(i.i_current_price) > 100 ORDER BY avg_wholesale_cost DESC, avg_current_price DESC;
SELECT s.s_store_name, SUM(ss.ss_quantity) as total_quantity_sold FROM store s JOIN store_sales ss ON s.s_store_sk = ss.ss_store_sk GROUP BY s.s_store_name ORDER BY total_quantity_sold DESC LIMIT 5;
SELECT p.p_promo_name, COUNT(*) as promo_sales FROM promotion p JOIN store_sales ss ON p.p_promo_sk = ss.ss_promo_sk WHERE p.p_discount_active = 'Y' GROUP BY p.p_promo_name HAVING COUNT(*) > 1000 ORDER BY promo_sales DESC;
SELECT ca.ca_city, ca.ca_state, SUM(sr.sr_net_loss) as total_net_loss FROM customer_address ca JOIN store_returns sr ON ca.ca_address_sk = sr.sr_addr_sk GROUP BY ca.ca_city, ca.ca_state ORDER BY total_net_loss DESC LIMIT 10;
SELECT ss.ss_sold_date_sk, SUM(ss.ss_net_profit) as daily_profit FROM store_sales ss WHERE ss.ss_sold_date_sk BETWEEN 2450815 AND 2450845 GROUP BY ss.ss_sold_date_sk ORDER BY daily_profit DESC;
SELECT i.i_category, COUNT(DISTINCT i.i_item_sk) as item_count FROM item i WHERE i.i_category IN ('Electronics', 'Clothing', 'Toys') GROUP BY i.i_category ORDER BY item_count DESC;