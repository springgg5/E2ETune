SELECT t.title, COUNT(c.id) AS cast_count, AVG(mi.info::numeric) AS avg_ld_disc_size FROM title t JOIN cast_info c ON t.id = c.movie_id JOIN movie_info mi ON t.id = mi.movie_id WHERE mi.info_type_id = 57 AND t.production_year >= 2000 GROUP BY t.title HAVING COUNT(c.id) > 10 ORDER BY avg_ld_disc_size DESC LIMIT 10;
SELECT n.name, rt.role, COUNT(ci.id) AS role_count FROM name n JOIN cast_info ci ON n.id = ci.person_id JOIN role_type rt ON ci.role_id = rt.id WHERE rt.id IN (3, 6, 7) GROUP BY n.name, rt.role HAVING COUNT(ci.id) > 5 ORDER BY role_count DESC;
SELECT t.title, kt.keyword, COUNT(mk.id) AS keyword_count FROM title t JOIN movie_keyword mk ON t.id = mk.movie_id JOIN keyword kt ON mk.keyword_id = kt.id WHERE t.production_year BETWEEN 2010 AND 2020 GROUP BY t.title, kt.keyword HAVING COUNT(mk.id) > 10 ORDER BY keyword_count DESC;
SELECT cn.name, ct.kind, COUNT(mc.id) AS company_count FROM company_name cn JOIN movie_companies mc ON cn.id = mc.company_id JOIN company_type ct ON mc.company_type_id = ct.id GROUP BY cn.name, ct.kind HAVING COUNT(mc.id) > 50 ORDER BY company_count DESC;
SELECT t.title, it.info, COUNT(mi.id) AS info_count FROM title t JOIN movie_info mi ON t.id = mi.movie_id JOIN info_type it ON mi.info_type_id = it.id WHERE it.id IN (34, 56) AND t.production_year >= 2010 GROUP BY t.title, it.info HAVING COUNT(mi.id) > 5 ORDER BY info_count DESC;