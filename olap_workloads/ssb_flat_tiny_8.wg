SELECT c_name, c_city, c_nation, c_region, SUM(lo_extendedprice * (1 - lo_discount)) AS revenue FROM lineorder_flat WHERE lo_custkey IN (132436, 111637, 143074) AND lo_tax = 5 GROUP BY c_name, c_city, c_nation, c_region ORDER BY revenue DESC;
SELECT p_category, p_brand, p_color, p_type, SUM(lo_quantity) AS total_quantity, AVG(lo_extendedprice) AS avg_price FROM lineorder_flat WHERE lo_partkey IN (590, 587, 577) GROUP BY p_category, p_brand, p_color, p_type ORDER BY total_quantity DESC;
SELECT lo_orderpriority, COUNT(*) AS order_count, SUM(lo_ordtotalprice) AS total_price, AVG(lo_ordtotalprice) AS avg_price FROM lineorder_flat WHERE lo_orderdate >= '19940101' AND lo_orderdate <= '19941231' GROUP BY lo_orderpriority ORDER BY order_count DESC;
SELECT s_name, s_city, s_nation, s_region, COUNT(*) AS order_count, SUM(lo_supplycost) AS total_supply_cost FROM lineorder_flat WHERE lo_suppkey IN (SELECT lo_suppkey FROM lineorder_flat WHERE lo_custkey = 132436) GROUP BY s_name, s_city, s_nation, s_region ORDER BY order_count DESC;
SELECT c_name, c_city, c_nation, c_region, COUNT(*) AS order_count, SUM(lo_revenue) AS total_revenue FROM lineorder_flat WHERE lo_custkey IN (SELECT lo_custkey FROM lineorder_flat WHERE lo_orderpriority = '1-URGENT') GROUP BY c_name, c_city, c_nation, c_region ORDER BY total_revenue DESC;
SELECT p_mfgr, p_category, p_brand, COUNT(*) AS part_count, SUM(lo_quantity) AS total_quantity FROM lineorder_flat WHERE lo_partkey IN (SELECT lo_partkey FROM lineorder_flat WHERE lo_custkey = 111637) GROUP BY p_mfgr, p_category, p_brand ORDER BY part_count DESC;
SELECT lo_shipmode, COUNT(*) AS order_count, SUM(lo_extendedprice * (1 - lo_discount)) AS revenue FROM lineorder_flat WHERE lo_orderdate >= '19950101' AND lo_orderdate <= '19951231' GROUP BY lo_shipmode ORDER BY order_count DESC;
SELECT c_mktsegment, COUNT(*) AS customer_count, SUM(lo_ordtotalprice) AS total_price, AVG(lo_ordtotalprice) AS avg_price FROM lineorder_flat GROUP BY c_mktsegment ORDER BY customer_count DESC;