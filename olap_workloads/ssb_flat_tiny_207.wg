SELECT lo_orderpriority, COUNT(*) AS num_orders, AVG(lo_extendedprice) AS avg_price, SUM(lo_revenue) AS total_revenue FROM lineorder_flat WHERE lo_shipmode = 'MAIL' GROUP BY lo_orderpriority ORDER BY num_orders DESC;
SELECT p_category, p_brand, SUM(lo_quantity) AS total_quantity, SUM(lo_supplycost) AS total_supplycost FROM lineorder_flat WHERE lo_orderdate >= 20210101 AND lo_orderdate <= 20211231 GROUP BY p_category, p_brand HAVING SUM(lo_supplycost) > 100000 ORDER BY total_supplycost DESC;
SELECT c_city, c_nation, COUNT(*) AS num_orders, SUM(lo_extendedprice) AS total_sales FROM lineorder_flat WHERE lo_shipmode = 'TRUCK' AND lo_discount >= 5 AND lo_discount <= 15 GROUP BY c_city, c_nation ORDER BY total_sales DESC;
SELECT s_name, s_city, s_nation, COUNT(*) AS num_orders, SUM(lo_revenue) AS total_revenue FROM lineorder_flat WHERE lo_orderkey IN (SELECT lo_orderkey FROM lineorder_flat WHERE lo_shipmode = 'RAIL' AND lo_commitdate >= 20220101 AND lo_commitdate <= 20221231) GROUP BY s_name, s_city, s_nation ORDER BY total_revenue DESC;
SELECT p_container, COUNT(*) AS num_products, SUM(p_size) AS total_size FROM lineorder_flat WHERE p_container IN ('WRAP DRUM', 'MED BAG', 'JUMBO CAN') GROUP BY p_container ORDER BY total_size DESC;
SELECT c_mktsegment, COUNT(DISTINCT lo_custkey) AS num_customers, SUM(lo_extendedprice) AS total_sales FROM lineorder_flat WHERE lo_orderkey IN (SELECT lo_orderkey FROM lineorder_flat WHERE lo_orderdate >= 20220101 AND lo_orderdate <= 20221231 AND lo_shipmode = 'MAIL') GROUP BY c_mktsegment ORDER BY total_sales DESC;