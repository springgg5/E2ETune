SELECT p.p_type, COUNT(*) AS total_parts, AVG(p.p_retailprice) AS avg_price FROM part p WHERE p.p_container IN ('SM BAG', 'p9K', 'SM JAR') AND p.p_comment LIKE '%furiously%' GROUP BY p.p_type HAVING COUNT(*) > 10 ORDER BY avg_price DESC;
SELECT c.c_custkey, c.c_name, SUM(o.o_totalprice) AS total_spent FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey WHERE c.c_acctbal > 5000 AND c.c_phone LIKE '10-%%' GROUP BY c.c_custkey, c.c_name HAVING SUM(o.o_totalprice) > 100000 ORDER BY total_spent DESC;
SELECT r.r_name, COUNT(n.n_nationkey) AS num_nations, AVG(s.s_acctbal) AS avg_supplier_balance FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey GROUP BY r.r_name ORDER BY avg_supplier_balance DESC;
SELECT o.o_orderpriority, COUNT(*) AS num_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue FROM orders o JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE l.l_shipdate >= '1995-01-01' AND l.l_shipdate < '1996-01-01' GROUP BY o.o_orderpriority ORDER BY total_revenue DESC;
SELECT p.p_name, s.s_name, ps.ps_availqty * ps.ps_supplycost AS total_value FROM part p JOIN partsupp ps ON p.p_partkey = ps.ps_partkey JOIN supplier s ON ps.ps_suppkey = s.s_suppkey WHERE p.p_name LIKE '%%chocolate%%' AND ps.ps_availqty > 1000 ORDER BY total_value DESC LIMIT 10;