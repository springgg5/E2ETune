SELECT t.title, COUNT(ci.person_id) AS cast_count FROM title t JOIN cast_info ci ON t.id = ci.movie_id WHERE t.production_year > 2000 GROUP BY t.title HAVING COUNT(ci.person_id) > 10 ORDER BY COUNT(ci.person_id) DESC;
SELECT m.title, AVG(mi.info::numeric) AS average_rating FROM movie_info mi JOIN title m ON mi.movie_id = m.id WHERE mi.info_type_id = 101 AND m.production_year BETWEEN 2000 AND 2010 GROUP BY m.title HAVING AVG(mi.info::numeric) > 7.0 ORDER BY average_rating DESC;
SELECT n.name, COUNT(ci.movie_id) AS movie_count FROM name n JOIN cast_info ci ON n.id = ci.person_id WHERE ci.role_id = 1 AND n.gender = 'M' GROUP BY n.name HAVING COUNT(ci.movie_id) > 5 ORDER BY movie_count DESC;
SELECT k.keyword, COUNT(mk.movie_id) AS keyword_count FROM keyword k JOIN movie_keyword mk ON k.id = mk.keyword_id WHERE k.phonetic_code LIKE 'A%' GROUP BY k.keyword HAVING COUNT(mk.movie_id) > 10 ORDER BY keyword_count DESC;
SELECT t.title, COUNT(ml.linked_movie_id) AS linked_movie_count FROM title t JOIN movie_link ml ON t.id = ml.movie_id WHERE ml.link_type_id IN (1, 3, 10) AND t.production_year BETWEEN 2000 AND 2020 GROUP BY t.title HAVING COUNT(ml.linked_movie_id) > 5 ORDER BY linked_movie_count DESC;