SELECT c_region, s_region, p_category, SUM(lo_revenue) as total_revenue FROM lineorder_flat WHERE lo_orderdate >= 19941105 AND lo_orderdate <= 19961224 AND p_color IN ('cyan', 'aquamarine', 'blush') GROUP BY c_region, s_region, p_category ORDER BY total_revenue DESC;
SELECT c_name, c_city, c_nation, COUNT(DISTINCT lo_orderkey) as total_orders, AVG(lo_ordtotalprice) as avg_order_price FROM lineorder_flat WHERE lo_linenumber IN (1, 4, 7) AND lo_orderdate >= 19951008 AND lo_orderdate <= 19961224 GROUP BY c_name, c_city, c_nation HAVING COUNT(DISTINCT lo_orderkey) > 10 ORDER BY total_orders DESC, avg_order_price ASC;
SELECT p_name, p_mfgr, p_brand, p_type, p_size, p_container, SUM(lo_quantity) as total_quantity, SUM(lo_supplycost) as total_supplycost FROM lineorder_flat WHERE lo_orderdate >= 19941105 AND lo_orderdate <= 19961224 AND lo_discount >= 5 AND lo_discount <= 15 GROUP BY p_name, p_mfgr, p_brand, p_type, p_size, p_container HAVING SUM(lo_quantity) > 1000 ORDER BY total_supplycost DESC;
SELECT c_mktsegment, lo_orderpriority, COUNT(DISTINCT lo_orderkey) as total_orders, SUM(lo_extendedprice) as total_extendedprice, AVG(lo_tax) as avg_tax FROM lineorder_flat WHERE lo_shipmode IN ('AIR', 'RAIL', 'SHIP') AND lo_orderdate >= 19941105 AND lo_orderdate <= 19961224 GROUP BY c_mktsegment, lo_orderpriority ORDER BY total_orders DESC, total_extendedprice DESC;
SELECT s_name, s_city, s_nation, COUNT(DISTINCT lo_orderkey) as total_orders, SUM(lo_revenue) as total_revenue FROM lineorder_flat WHERE lo_orderdate >= 19941105 AND lo_orderdate <= 19961224 AND lo_ordtotalprice >= 1473602 AND lo_ordtotalprice <= 21902763 GROUP BY s_name, s_city, s_nation HAVING COUNT(DISTINCT lo_orderkey) > 10 ORDER BY total_revenue DESC, total_orders DESC;