SELECT i.i_item_id, i.i_item_desc, SUM(ss.ss_quantity) AS total_quantity_sold, AVG(ss.ss_sales_price) AS avg_sales_price FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk WHERE i.i_wholesale_cost > 5.34 AND i.i_manufact_id = 103 GROUP BY i.i_item_id, i.i_item_desc ORDER BY total_quantity_sold DESC LIMIT 10;
SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent FROM catalog_sales cs JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk WHERE cd.cd_purchase_estimate > 4500 AND cd.cd_credit_rating = 'Good' GROUP BY c.c_first_name, c.c_last_name ORDER BY total_spent DESC LIMIT 5;
SELECT w.w_city, w.w_street_number, SUM(inv.inv_quantity_on_hand) AS total_inventory FROM inventory inv JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk WHERE w.w_gmt_offset = -5.00 GROUP BY w.w_city, w.w_street_number HAVING SUM(inv.inv_quantity_on_hand) > 10000 ORDER BY total_inventory DESC;
SELECT p.p_promo_id, p.p_promo_name, COUNT(cs.cs_order_number) AS total_orders FROM catalog_sales cs JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk WHERE p.p_channel_radio = 'N' AND p.p_channel_catalog = 'N' AND p.p_cost < 1000.00 GROUP BY p.p_promo_id, p.p_promo_name ORDER BY total_orders DESC LIMIT 5;
SELECT i.i_category, COUNT(DISTINCT i.i_item_sk) AS item_count, AVG(i.i_wholesale_cost) AS avg_wholesale_cost FROM item i WHERE i.i_manufact_id IN (545, 793) GROUP BY i.i_category HAVING COUNT(DISTINCT i.i_item_sk) > 10 ORDER BY avg_wholesale_cost ASC;
SELECT s.s_store_name, COUNT(DISTINCT sr.sr_ticket_number) AS total_returns, SUM(sr.sr_net_loss) AS total_loss FROM store_returns sr JOIN store s ON sr.sr_store_sk = s.s_store_sk JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk WHERE r.r_reason_desc LIKE 'Damaged%' GROUP BY s.s_store_name HAVING COUNT(DISTINCT sr.sr_ticket_number) > 50 ORDER BY total_loss DESC LIMIT 10;