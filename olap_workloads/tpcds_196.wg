SELECT c.c_customer_id, COUNT(ss.ss_ticket_number) AS num_tickets, SUM(ss.ss_net_paid) AS total_paid FROM store_sales ss INNER JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk WHERE ss.ss_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 2021 AND d_moy = 12) GROUP BY c.c_customer_id HAVING COUNT(ss.ss_ticket_number) > 5 ORDER BY total_paid DESC LIMIT 10;
SELECT i.i_class, AVG(i.i_current_price) AS avg_price, SUM(inv.inv_quantity_on_hand) AS total_stock FROM item i INNER JOIN inventory inv ON i.i_item_sk = inv.inv_item_sk WHERE i.i_class IN ('cooking', 'parenting', 'entertainments') GROUP BY i.i_class;
SELECT r.r_reason_desc, COUNT(cr.cr_order_number) AS num_returns, SUM(cr.cr_net_loss) AS total_loss FROM catalog_returns cr INNER JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk WHERE cr.cr_reason_sk IN ('10', '3', '4') AND cr.cr_returned_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 2021 AND d_qoy = 3) GROUP BY r.r_reason_desc ORDER BY total_loss DESC;