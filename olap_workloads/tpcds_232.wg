SELECT i.i_item_id, SUM(ss.ss_quantity) AS total_sold, AVG(ss.ss_sales_price) AS avg_sales_price FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk WHERE i.i_category = 'Electronics' GROUP BY i.i_item_id ORDER BY total_sold DESC LIMIT 10;
SELECT c.c_customer_id, c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid) AS total_spent FROM catalog_sales cs JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk WHERE c.c_salutation = 'Mr.' AND c.c_current_cdemo_sk = '1006791' GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name ORDER BY total_spent DESC LIMIT 10;
SELECT ib.ib_income_band_sk, COUNT(cd.cd_demo_sk) AS num_customers, SUM(cs.cs_net_paid) AS total_spent FROM catalog_sales cs JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk JOIN income_band ib ON cd.cd_purchase_estimate BETWEEN ib.ib_lower_bound AND ib.ib_upper_bound GROUP BY ib.ib_income_band_sk ORDER BY total_spent DESC;
SELECT w.w_warehouse_name, SUM(inv.inv_quantity_on_hand) AS total_inventory FROM inventory inv JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk GROUP BY w.w_warehouse_name ORDER BY total_inventory DESC;
SELECT d.d_week_seq, COUNT(DISTINCT(ss.ss_ticket_number)) AS num_orders FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE d.d_year = 2023 AND d.d_qoy = 2 GROUP BY d.d_week_seq ORDER BY num_orders DESC;
SELECT p.p_promo_name, COUNT(cs.cs_order_number) AS num_orders, SUM(cs.cs_net_paid) AS total_revenue FROM catalog_sales cs JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk WHERE p.p_channel_tv = 'Y' GROUP BY p.p_promo_name ORDER BY total_revenue DESC;
SELECT s.s_store_name, COUNT(DISTINCT(ss.ss_ticket_number)) AS num_orders, SUM(ss.ss_net_paid) AS total_revenue FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk WHERE s.s_market_id IN (SELECT s_market_id FROM store GROUP BY s_market_id HAVING AVG(s_tax_precentage) > 5) GROUP BY s.s_store_name ORDER BY total_revenue DESC;