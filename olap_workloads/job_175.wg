SELECT t.title, COUNT(DISTINCT ci.person_id) AS total_actors FROM title AS t JOIN cast_info AS ci ON t.id = ci.movie_id WHERE t.production_year BETWEEN 1990 AND 2000 AND ci.role_id = 1 GROUP BY t.title HAVING COUNT(DISTINCT ci.person_id) > 10 ORDER BY total_actors DESC, t.title ASC;
SELECT cn.name, COUNT(ci.id) AS appearances FROM char_name AS cn JOIN cast_info AS ci ON cn.id = ci.person_role_id WHERE cn.surname_pcode IN ('K6', 'S616', 'C514') GROUP BY cn.name HAVING COUNT(ci.id) > 5 ORDER BY appearances DESC, cn.name ASC;
SELECT at.title, COUNT(mk.keyword_id) AS keyword_count FROM aka_title AS at JOIN movie_keyword AS mk ON at.movie_id = mk.movie_id WHERE at.production_year IN (1937, 1954, 1994) AND at.kind_id IN (4, 2, 7) GROUP BY at.title ORDER BY keyword_count DESC, at.title ASC;
SELECT kt.kind, COUNT(t.id) AS title_count FROM kind_type AS kt JOIN title AS t ON kt.id = t.kind_id WHERE t.production_year BETWEEN 2000 AND 2010 GROUP BY kt.kind ORDER BY title_count DESC, kt.kind ASC;
SELECT it.info, AVG(mi.info::numeric) AS average_rating FROM info_type AS it JOIN movie_info AS mi ON it.id = mi.info_type_id WHERE it.info = 'rating' GROUP BY it.info;
SELECT lt.link, COUNT(ml.id) AS link_count FROM link_type AS lt JOIN movie_link AS ml ON lt.id = ml.link_type_id WHERE ml.linked_movie_id IN (223619, 138813, 878820) AND ml.link_type_id IN (15, 7, 11) GROUP BY lt.link ORDER BY link_count DESC, lt.link ASC;
SELECT ct.kind, COUNT(mc.id) AS company_count FROM company_type AS ct JOIN movie_companies AS mc ON ct.id = mc.company_type_id GROUP BY ct.kind HAVING COUNT(mc.id) > 10 ORDER BY company_count DESC, ct.kind ASC;
SELECT n.name, COUNT(DISTINCT pi.person_id) AS person_info_count FROM name AS n JOIN person_info AS pi ON n.id = pi.person_id GROUP BY n.name HAVING COUNT(DISTINCT pi.person_id) > 5 ORDER BY person_info_count DESC, n.name ASC;