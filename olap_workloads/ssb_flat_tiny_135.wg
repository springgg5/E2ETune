SELECT c_region, c_city, COUNT(lo_orderkey) AS num_orders, SUM(lo_extendedprice) AS total_price, AVG(lo_discount) AS avg_discount FROM lineorder_flat WHERE lo_orderkey IN (29036930, 9819552, 1671781) AND lo_tax IN (4, 2, 8) GROUP BY c_region, c_city ORDER BY total_price DESC;
SELECT lo_orderpriority, COUNT(lo_orderkey) AS num_orders, SUM(lo_revenue) AS total_revenue, AVG(lo_supplycost) AS avg_supplycost FROM lineorder_flat WHERE lo_orderdate BETWEEN 20210101 AND 20211231 AND lo_shipmode = 'AIR' GROUP BY lo_orderpriority HAVING COUNT(lo_orderkey) > 10 ORDER BY total_revenue DESC;