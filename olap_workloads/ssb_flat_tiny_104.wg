SELECT c_region, COUNT(lo_orderkey) AS num_orders, SUM(lo_revenue) AS total_revenue FROM lineorder_flat WHERE lo_commitdate >= '19970101' AND lo_commitdate <= '19971231' GROUP BY c_region ORDER BY total_revenue DESC;
SELECT p_category, p_brand, AVG(lo_extendedprice) AS avg_price, COUNT(lo_orderkey) AS num_orders FROM lineorder_flat WHERE lo_linenumber IN (3, 6, 7) AND lo_revenue BETWEEN 4000000 AND 6000000 GROUP BY p_category, p_brand ORDER BY avg_price DESC;
SELECT s_nation, s_city, SUM(lo_supplycost) AS total_supply_cost FROM lineorder_flat WHERE lo_orderpriority = '1-URGENT' OR lo_orderpriority = '2-HIGH' GROUP BY s_nation, s_city ORDER BY total_supply_cost DESC;
SELECT c_mktsegment, p_container, COUNT(lo_orderkey) AS num_orders, SUM(lo_quantity) AS total_quantity FROM lineorder_flat WHERE lo_shipmode = 'AIR' AND lo_shippriority = '0' GROUP BY c_mktsegment, p_container ORDER BY total_quantity DESC;
SELECT c_name, c_city, c_nation, SUM(lo_extendedprice * (1 - lo_discount)) AS total_discounted_price FROM lineorder_flat WHERE lo_orderdate >= '19960101' AND lo_orderdate <= '19961231' GROUP BY c_name, c_city, c_nation ORDER BY total_discounted_price DESC;
SELECT p_name, p_mfgr, p_size, COUNT(lo_orderkey) AS num_orders, SUM(lo_extendedprice) AS total_price FROM lineorder_flat WHERE lo_orderdate >= '19970101' AND lo_orderdate <= '19971231' AND lo_commitdate >= '19970101' AND lo_commitdate <= '19971231' GROUP BY p_name, p_mfgr, p_size ORDER BY total_price DESC;
SELECT c_region, s_region, COUNT(lo_orderkey) AS num_orders, SUM(lo_revenue) AS total_revenue FROM lineorder_flat WHERE lo_orderdate >= '19960101' AND lo_orderdate <= '19961231' AND lo_commitdate >= '19960101' AND lo_commitdate <= '19961231' GROUP BY c_region, s_region ORDER BY total_revenue DESC;