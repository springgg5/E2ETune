SELECT c_region, s_region, p_mfgr, COUNT(lo_orderkey) AS order_count, SUM(lo_extendedprice) AS total_price, AVG(lo_discount) AS avg_discount FROM lineorder_flat WHERE lo_commitdate = '19950110' AND p_name = 'gainsboro violet' GROUP BY c_region, s_region, p_mfgr ORDER BY total_price DESC;
SELECT c_mktsegment, p_category, p_brand, SUM(lo_quantity) AS total_quantity, SUM(lo_supplycost) AS total_supply_cost, AVG(lo_tax) AS avg_tax FROM lineorder_flat WHERE lo_orderkey = '9349379' AND p_mfgr = 'MFGR#5' GROUP BY c_mktsegment, p_category, p_brand HAVING SUM(lo_quantity) > 1000 ORDER BY total_supply_cost ASC;
WITH high_priority_orders AS (SELECT lo_orderkey, lo_orderpriority, lo_custkey, lo_partkey, lo_suppkey, lo_orderdate, lo_shippriority, lo_quantity, lo_extendedprice, lo_ordtotalprice, lo_discount, lo_revenue, lo_supplycost, lo_tax, lo_commitdate, lo_shipmode, c_name, c_address, c_city, c_nation, c_region, c_phone, c_mktsegment, s_name, s_address, s_city, s_nation, s_region, s_phone, p_name, p_mfgr, p_category, p_brand, p_color, p_type, p_size, p_container FROM lineorder_flat WHERE lo_orderpriority = '1-URGENT' OR lo_orderpriority = '2-HIGH') SELECT c_city, s_city, p_type, COUNT(lo_orderkey) AS order_count, SUM(lo_revenue) AS total_revenue, AVG(lo_discount) AS avg_discount FROM high_priority_orders WHERE lo_commitdate = '19970502' AND p_mfgr = 'MFGR#3' GROUP BY c_city, s_city, p_type ORDER BY total_revenue DESC;