SELECT t.title, COUNT(*) AS num_movies FROM title t JOIN movie_companies mc ON t.id = mc.movie_id JOIN company_type ct ON mc.company_type_id = ct.id WHERE ct.kind = 'production companies' GROUP BY t.title HAVING COUNT(*) > 1 ORDER BY num_movies DESC;
SELECT c.name, COUNT(*) AS num_characters FROM char_name c JOIN cast_info ci ON c.id = ci.person_role_id WHERE c.name_pcode_nf = 'N525' GROUP BY c.name HAVING COUNT(*) > 5 ORDER BY num_characters DESC;
SELECT r.role, AVG(t.production_year) AS avg_production_year FROM role_type r JOIN cast_info ci ON r.id = ci.role_id JOIN title t ON ci.movie_id = t.id WHERE r.id IN (8, 1, 5) GROUP BY r.role;
SELECT t1.title, t2.title, lt.link FROM movie_link ml JOIN link_type lt ON ml.link_type_id = lt.id JOIN title t1 ON ml.movie_id = t1.id JOIN title t2 ON ml.linked_movie_id = t2.id WHERE t1.id IN ('136325', '6809', '141140') AND lt.link = 'follows';
SELECT n.name, COUNT(*) AS num_roles FROM name n JOIN cast_info ci ON n.id = ci.person_id JOIN role_type rt ON ci.role_id = rt.id WHERE rt.role = 'composer' AND n.gender = 'F' GROUP BY n.name HAVING COUNT(*) > 10 ORDER BY num_roles DESC;
SELECT k.keyword, COUNT(*) AS num_movies FROM keyword k JOIN movie_keyword mk ON k.id = mk.keyword_id JOIN title t ON mk.movie_id = t.id WHERE k.phonetic_code = 'B4214' GROUP BY k.keyword HAVING COUNT(*) > 5 ORDER BY num_movies DESC;
SELECT t.title, COUNT(*) AS num_special_effects_companies FROM title t JOIN movie_companies mc ON t.id = mc.movie_id JOIN company_type ct ON mc.company_type_id = ct.id WHERE ct.kind = 'special effects companies' GROUP BY t.title HAVING COUNT(*) > 2 ORDER BY num_special_effects_companies DESC;