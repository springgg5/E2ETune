SELECT c.c_first_name, c.c_last_name, sum(ss.ss_net_paid) as total_paid FROM customer c JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk WHERE c.c_current_cdemo_sk IN (SELECT cd_demo_sk FROM customer_demographics WHERE cd_education_status = '4 yr Degree' AND cd_purchase_estimate > 2000 AND cd_dep_college_count = 0) GROUP BY c.c_first_name, c.c_last_name ORDER BY total_paid DESC LIMIT 10;
SELECT w.w_warehouse_name, sum(inv.inv_quantity_on_hand) as total_quantity FROM warehouse w JOIN inventory inv ON w.w_warehouse_sk = inv.inv_warehouse_sk WHERE w.w_state = 'CA' GROUP BY w.w_warehouse_name HAVING sum(inv.inv_quantity_on_hand) > 10000 ORDER BY total_quantity DESC;
SELECT d.d_year, d.d_month_seq, sum(cs.cs_sales_price) as total_sales FROM date_dim d JOIN catalog_sales cs ON d.d_date_sk = cs.cs_sold_date_sk WHERE d.d_year = 2000 AND cs.cs_item_sk IN (SELECT i_item_sk FROM item WHERE i_category = 'Electronics') GROUP BY d.d_year, d.d_month_seq ORDER BY d.d_month_seq;
SELECT ws.ws_web_site_sk, sum(ws.ws_net_profit) as total_profit FROM web_sales ws WHERE ws.ws_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy BETWEEN 1 AND 6) AND ws.ws_item_sk IN (SELECT i_item_sk FROM item WHERE i_class = 'Computers') GROUP BY ws.ws_web_site_sk HAVING sum(ws.ws_net_profit) > 50000 ORDER BY total_profit DESC;
SELECT hd.hd_demo_sk, count(*) as num_households FROM household_demographics hd JOIN customer c ON hd.hd_demo_sk = c.c_current_hdemo_sk WHERE hd.hd_vehicle_count = 0 AND hd.hd_buy_potential = 'Unknown' AND hd.hd_dep_count IN (1, 0, 6) GROUP BY hd.hd_demo_sk HAVING count(*) > 100 ORDER BY num_households DESC;