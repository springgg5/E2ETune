SELECT d_date, COUNT(sr_ticket_number) AS num_returns, SUM(sr_return_amt) AS total_return_amt, AVG(sr_return_amt) AS avg_return_amt FROM date_dim JOIN store_returns ON d_date_sk = sr_returned_date_sk WHERE d_dom IN (27, 20, 24) AND d_current_quarter = 'N' GROUP BY d_date ORDER BY d_date;
SELECT s_store_name, COUNT(ss_ticket_number) AS num_sales, SUM(ss_sales_price) AS total_sales_price, AVG(ss_sales_price) AS avg_sales_price FROM store JOIN store_sales ON s_store_sk = ss_store_sk WHERE ss_customer_sk IN (46258, 7859, 44090) GROUP BY s_store_name ORDER BY s_store_name;
SELECT i_item_id, i_item_desc, SUM(inv_quantity_on_hand) AS total_inventory FROM item JOIN inventory ON i_item_sk = inv_item_sk WHERE inv_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_dom = 27 AND d_current_quarter = 'N') GROUP BY i_item_id, i_item_desc HAVING SUM(inv_quantity_on_hand) > 1000 ORDER BY total_inventory DESC;