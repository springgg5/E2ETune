SELECT i.i_category, AVG(ws.ws_sales_price) AS avg_sales_price FROM item i JOIN web_sales ws ON i.i_item_sk = ws.ws_item_sk GROUP BY i.i_category HAVING AVG(ws.ws_sales_price) > 50 ORDER BY avg_sales_price DESC;
SELECT c.c_first_name, c.c_last_name, SUM(ss.ss_net_paid) AS total_spent FROM customer c JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk WHERE c.c_birth_year = 1980 GROUP BY c.c_first_name, c.c_last_name ORDER BY total_spent DESC LIMIT 10;
SELECT p.p_promo_name, COUNT(cs.cs_order_number) AS total_orders FROM promotion p JOIN catalog_sales cs ON p.p_promo_sk = cs.cs_promo_sk WHERE p.p_channel_tv = 'Y' GROUP BY p.p_promo_name ORDER BY total_orders DESC;
SELECT ib.ib_income_band_sk, COUNT(hd.hd_demo_sk) AS household_count FROM income_band ib JOIN household_demographics hd ON ib.ib_income_band_sk = hd.hd_income_band_sk WHERE ib.ib_lower_bound >= 20001 AND ib.ib_lower_bound <= 110001 GROUP BY ib.ib_income_band_sk ORDER BY household_count DESC;
SELECT ws.ws_web_page_sk, COUNT(ws.ws_order_number) AS total_orders, SUM(ws.ws_net_paid) AS total_revenue FROM web_sales ws WHERE ws.ws_ship_date_sk BETWEEN 2450816 AND 2450846 GROUP BY ws.ws_web_page_sk HAVING COUNT(ws.ws_order_number) > 10 ORDER BY total_revenue DESC;
SELECT ca.ca_state, COUNT(c.c_customer_sk) AS customer_count FROM customer_address ca JOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk GROUP BY ca.ca_state HAVING COUNT(c.c_customer_sk) > 1000 ORDER BY customer_count DESC;
SELECT d.d_year, d.d_month_seq, COUNT(DISTINCT ws.ws_order_number) AS total_orders FROM date_dim d JOIN web_sales ws ON d.d_date_sk = ws.ws_sold_date_sk WHERE d.d_year >= 2000 AND d.d_year <= 2005 GROUP BY d.d_year, d.d_month_seq ORDER BY d.d_year, d.d_month_seq;
SELECT r.r_reason_desc, COUNT(sr.sr_reason_sk) AS return_count FROM reason r JOIN store_returns sr ON r.r_reason_sk = sr.sr_reason_sk GROUP BY r.r_reason_desc HAVING COUNT(sr.sr_reason_sk) > 50 ORDER BY return_count DESC;