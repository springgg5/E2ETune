SELECT t.title, COUNT(c.id) AS cast_count FROM title AS t JOIN cast_info AS c ON t.id = c.movie_id WHERE t.production_year BETWEEN 2000 AND 2020 GROUP BY t.title HAVING COUNT(c.id) > 10 ORDER BY COUNT(c.id) DESC;
SELECT t.title, AVG(c.nr_order) AS avg_order FROM title AS t JOIN cast_info AS c ON t.id = c.movie_id WHERE t.production_year BETWEEN 2000 AND 2020 GROUP BY t.title HAVING AVG(c.nr_order) > 5 ORDER BY AVG(c.nr_order) DESC;
SELECT cn.name, COUNT(ci.id) AS char_count FROM char_name AS cn JOIN cast_info AS ci ON cn.id = ci.person_role_id WHERE ci.nr_order < 10 GROUP BY cn.name HAVING COUNT(ci.id) > 5 ORDER BY COUNT(ci.id) DESC;
SELECT t.title, COUNT(mk.id) AS keyword_count FROM title AS t JOIN movie_keyword AS mk ON t.id = mk.movie_id WHERE t.production_year BETWEEN 2000 AND 2020 GROUP BY t.title HAVING COUNT(mk.id) > 5 ORDER BY COUNT(mk.id) DESC;
SELECT t.title, COUNT(ml.id) AS link_count FROM title AS t JOIN movie_link AS ml ON t.id = ml.movie_id WHERE t.production_year BETWEEN 2000 AND 2020 AND ml.link_type_id IN (18, 8, 11) GROUP BY t.title HAVING COUNT(ml.id) > 1 ORDER BY COUNT(ml.id) DESC;
SELECT n.name, COUNT(ci.id) AS cast_count FROM name AS n JOIN cast_info AS ci ON n.id = ci.person_id WHERE ci.nr_order < 10 GROUP BY n.name HAVING COUNT(ci.id) > 5 ORDER BY COUNT(ci.id) DESC;
SELECT t.title, COUNT(mc.id) AS company_count FROM title AS t JOIN movie_companies AS mc ON t.id = mc.movie_id WHERE t.production_year BETWEEN 2000 AND 2020 AND mc.company_type_id = 1 GROUP BY t.title HAVING COUNT(mc.id) > 1 ORDER BY COUNT(mc.id) DESC;
SELECT t.title, COUNT(mi.id) AS info_count FROM title AS t JOIN movie_info AS mi ON t.id = mi.movie_id WHERE t.production_year BETWEEN 2000 AND 2020 GROUP BY t.title HAVING COUNT(mi.id) > 5 ORDER BY COUNT(mi.id) DESC;
SELECT t.title, COUNT(mc.id) AS company_count, COUNT(c.id) AS cast_count FROM title AS t JOIN movie_companies AS mc ON t.id = mc.movie_id JOIN cast_info AS c ON t.id = c.movie_id WHERE t.production_year BETWEEN 2000 AND 2020 GROUP BY t.title HAVING COUNT(mc.id) > 1 AND COUNT(c.id) > 10 ORDER BY COUNT(mc.id) DESC, COUNT(c.id) DESC;
SELECT t.title, COUNT(mc.id) AS company_count, COUNT(mk.id) AS keyword_count FROM title AS t JOIN movie_companies AS mc ON t.id = mc.movie_id JOIN movie_keyword AS mk ON t.id = mk.movie_id WHERE t.production_year BETWEEN 2000 AND 2020 AND mc.company_type_id = 1 GROUP BY t.title HAVING COUNT(mc.id) > 1 AND COUNT(mk.id) > 5 ORDER BY COUNT(mc.id) DESC, COUNT(mk.id) DESC;