SELECT c_customer_sk, COUNT(ss_ticket_number) AS total_orders, SUM(ss_net_paid) AS total_sales FROM customer JOIN store_sales ON c_customer_sk = ss_customer_sk WHERE c_current_addr_sk IN (SELECT ca_address_sk FROM customer_address WHERE ca_state = 'CA') GROUP BY c_customer_sk HAVING COUNT(ss_ticket_number) > 10 ORDER BY total_sales DESC LIMIT 10;
SELECT i_item_sk, i_product_name, SUM(inv_quantity_on_hand) AS total_inventory FROM item JOIN inventory ON i_item_sk = inv_item_sk WHERE inv_date_sk = 2450815 AND inv_warehouse_sk IN (1, 2, 3, 5) GROUP BY i_item_sk, i_product_name HAVING SUM(inv_quantity_on_hand) > 500 ORDER BY total_inventory DESC;
SELECT p_promo_sk, p_promo_name, COUNT(cs_order_number) AS num_orders, SUM(cs_net_paid) AS total_sales FROM promotion JOIN catalog_sales ON p_promo_sk = cs_promo_sk WHERE cs_ext_tax BETWEEN 47.84 AND 226.72 AND cs_warehouse_sk IN (2, 3, 5) GROUP BY p_promo_sk, p_promo_name HAVING COUNT(cs_order_number) > 50 ORDER BY total_sales DESC;
SELECT wp_web_page_sk, wp_url, SUM(ws_net_paid) AS total_sales FROM web_page JOIN web_sales ON wp_web_page_sk = ws_web_page_sk WHERE wp_max_ad_count IN (2, 3, 0) GROUP BY wp_web_page_sk, wp_url HAVING SUM(ws_net_paid) > 10000 ORDER BY total_sales DESC;
SELECT w_warehouse_sk, w_warehouse_name, COUNT(cs_order_number) AS num_orders, SUM(cs_net_paid) AS total_sales FROM warehouse JOIN catalog_sales ON w_warehouse_sk = cs_warehouse_sk WHERE cs_ext_tax IN (226.72, 47.84, 2.14) GROUP BY w_warehouse_sk, w_warehouse_name HAVING COUNT(cs_order_number) > 20 ORDER BY total_sales DESC;
SELECT d_year, d_month_seq, COUNT(ss_ticket_number) AS num_orders, SUM(ss_net_paid) AS total_sales FROM date_dim JOIN store_sales ON d_date_sk = ss_sold_date_sk WHERE d_year >= 2000 GROUP BY d_year, d_month_seq ORDER BY d_year ASC, d_month_seq ASC, total_sales DESC;
SELECT ca_state, AVG(cs_net_paid) AS avg_sales FROM customer_address JOIN customer ON ca_address_sk = c_current_addr_sk JOIN catalog_sales ON c_customer_sk = cs_bill_customer_sk WHERE cs_net_paid BETWEEN 226.53 AND 2303.95 GROUP BY ca_state HAVING COUNT(cs_order_number) > 100 ORDER BY avg_sales DESC;