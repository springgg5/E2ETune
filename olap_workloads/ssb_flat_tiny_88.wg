SELECT c_city, COUNT(lo_orderkey) AS num_orders, SUM(lo_extendedprice) AS total_price, AVG(lo_discount) AS avg_discount FROM lineorder_flat WHERE c_city IN ('PERU     5', 'INDIA    4', 'CANADA   4') GROUP BY c_city ORDER BY num_orders DESC;
SELECT p_category, p_brand, SUM(lo_quantity) AS total_quantity, SUM(lo_revenue) AS total_revenue FROM lineorder_flat WHERE lo_ordtotalprice BETWEEN 21339532 AND 31323749 GROUP BY p_category, p_brand ORDER BY total_revenue DESC;
SELECT c_region, s_region, COUNT(lo_orderkey) AS num_orders, SUM(lo_supplycost) AS total_supply_cost FROM lineorder_flat WHERE c_region = s_region GROUP BY c_region, s_region ORDER BY num_orders DESC;
SELECT lo_orderpriority, COUNT(lo_orderkey) AS num_orders, SUM(lo_extendedprice * (1 - lo_discount)) AS total_discounted_price FROM lineorder_flat WHERE lo_orderdate >= '19940101' AND lo_orderdate <= '19941231' GROUP BY lo_orderpriority ORDER BY total_discounted_price DESC;
SELECT p_mfgr, p_type, COUNT(lo_orderkey) AS num_orders, SUM(lo_extendedprice) AS total_price FROM lineorder_flat WHERE p_size BETWEEN 1 AND 50 GROUP BY p_mfgr, p_type ORDER BY total_price DESC;
SELECT c_mktsegment, s_nation, COUNT(lo_orderkey) AS num_orders, SUM(lo_extendedprice) AS total_price FROM lineorder_flat WHERE lo_shipmode IN ('AIR', 'RAIL', 'SHIP') AND lo_commitdate < lo_orderdate GROUP BY c_mktsegment, s_nation ORDER BY num_orders DESC;