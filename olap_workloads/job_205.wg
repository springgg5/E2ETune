SELECT t.title, COUNT(c.id) AS cast_count, AVG(mi.info::float) AS average_rating FROM title AS t JOIN cast_info AS c ON t.id = c.movie_id JOIN movie_info AS mi ON t.id = mi.movie_id WHERE mi.info_type_id = 101 AND t.production_year >= 2000 GROUP BY t.title HAVING COUNT(c.id) >= 5 ORDER BY average_rating DESC LIMIT 10;
SELECT ct.kind, COUNT(mc.id) AS company_count, AVG(mi.info::float) AS average_budget FROM company_type AS ct JOIN movie_companies AS mc ON ct.id = mc.company_type_id JOIN movie_info AS mi ON mc.movie_id = mi.movie_id WHERE mi.info_type_id = 100 AND ct.id IN (2, 3, 4) GROUP BY ct.kind HAVING COUNT(mc.id) >= 10 AND AVG(mi.info::float) >= 5000000 ORDER BY average_budget DESC;