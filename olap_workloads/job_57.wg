SELECT t.title, COUNT(DISTINCT ci.person_id) AS num_actors, AVG(mi.info::numeric) AS avg_rating FROM title AS t JOIN cast_info AS ci ON t.id = ci.movie_id JOIN movie_info AS mi ON t.id = mi.movie_id WHERE mi.info_type_id = 101 AND t.production_year BETWEEN 2000 AND 2020 GROUP BY t.title HAVING COUNT(DISTINCT ci.person_id) > 10 ORDER BY avg_rating DESC LIMIT 10;
SELECT k.keyword, COUNT(DISTINCT mk.movie_id) AS num_movies, AVG(t.production_year) AS avg_production_year FROM keyword AS k JOIN movie_keyword AS mk ON k.id = mk.keyword_id JOIN title AS t ON mk.movie_id = t.id WHERE t.production_year BETWEEN 1990 AND 2000 GROUP BY k.keyword HAVING COUNT(DISTINCT mk.movie_id) > 5 ORDER BY avg_production_year DESC;
SELECT n.name, COUNT(DISTINCT ci.movie_id) AS num_movies, SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) AS num_tv_series FROM name AS n JOIN cast_info AS ci ON n.id = ci.person_id JOIN title AS t ON ci.movie_id = t.id WHERE n.gender = 'M' AND t.production_year BETWEEN 2010 AND 2020 GROUP BY n.name HAVING COUNT(DISTINCT ci.movie_id) > 10 AND SUM(CASE WHEN t.kind_id = 1 THEN 1 ELSE 0 END) > 5 ORDER BY num_tv_series DESC;
SELECT cn.name, COUNT(DISTINCT ci.movie_id) AS num_movies, AVG(t.production_year) AS avg_production_year FROM char_name AS cn JOIN cast_info AS ci ON cn.id = ci.person_role_id JOIN title AS t ON ci.movie_id = t.id WHERE t.production_year BETWEEN 2000 AND 2010 GROUP BY cn.name HAVING COUNT(DISTINCT ci.movie_id) > 5 ORDER BY avg_production_year DESC;