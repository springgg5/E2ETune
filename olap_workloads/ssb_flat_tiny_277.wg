SELECT c_city, s_name, COUNT(lo_orderkey) AS num_orders, SUM(lo_extendedprice) AS total_price, AVG(lo_discount) AS avg_discount FROM lineorder_flat WHERE c_city IN ('ARGENTINA2', 'SAUDI ARA8', 'INDONESIA0') AND lo_discount IN (5, 8, 3) GROUP BY c_city, s_name ORDER BY c_city, s_name;
SELECT p_category, p_brand, p_size, SUM(lo_quantity) AS total_quantity, SUM(lo_supplycost) AS total_supply_cost FROM lineorder_flat WHERE s_name IN ('Supplier#000001417', 'Supplier#000006056', 'Supplier#000008845') GROUP BY p_category, p_brand, p_size HAVING SUM(lo_quantity) > 1000 ORDER BY p_category, p_brand, p_size;
SELECT lo_orderpriority, COUNT(lo_orderkey) AS num_orders, SUM(lo_revenue) AS total_revenue, AVG(lo_tax) AS avg_tax FROM (SELECT lo_orderkey, lo_orderpriority, lo_revenue, lo_tax FROM lineorder_flat WHERE lo_commitdate >= lo_orderdate AND lo_shipmode IN ('AIR', 'RAIL', 'SHIP')) AS subquery GROUP BY lo_orderpriority ORDER BY lo_orderpriority;