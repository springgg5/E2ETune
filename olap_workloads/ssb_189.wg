SELECT s.s_region, COUNT(*) AS num_orders, SUM(lo.lo_extendedprice * (1 - lo.lo_discount)) AS revenue FROM lineorder lo JOIN supplier s ON lo.lo_suppkey = s.s_suppkey JOIN date_dim d ON lo.lo_orderdate = d.d_datekey WHERE d.d_year = 1993 AND s.s_region IN ('ASIA', 'AMERICA', 'MIDDLE EAST') GROUP BY s.s_region ORDER BY revenue DESC;
SELECT c.c_mktsegment, AVG(lo.lo_quantity) AS avg_quantity, AVG(lo.lo_extendedprice) AS avg_price, AVG(lo.lo_discount) AS avg_discount FROM lineorder lo JOIN customer c ON lo.lo_custkey = c.c_custkey JOIN date_dim d ON lo.lo_orderdate = d.d_datekey WHERE d.d_yearmonthnum BETWEEN 199301 AND 199312 AND c.c_mktsegment IN ('AUTOMOBILE', 'BUILDING', 'FURNITURE') GROUP BY c.c_mktsegment ORDER BY c.c_mktsegment;
SELECT p.p_brand, p.p_type, SUM(lo.lo_extendedprice * (1 - lo.lo_discount)) AS revenue FROM lineorder lo JOIN part p ON lo.lo_partkey = p.p_partkey JOIN date_dim d ON lo.lo_orderdate = d.d_datekey WHERE d.d_year = 1993 AND p.p_category = 'MFGR#1' AND p.p_brand LIKE 'MFGR#1%' GROUP BY p.p_brand, p.p_type HAVING SUM(lo.lo_extendedprice * (1 - lo.lo_discount)) > 1000000 ORDER BY revenue DESC;