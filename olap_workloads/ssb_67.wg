SELECT c.c_name, SUM(lo.lo_extendedprice * lo.lo_discount) AS revenue FROM lineorder lo JOIN customer c ON lo.lo_custkey = c.c_custkey JOIN date_dim d ON lo.lo_orderdate = d.d_datekey WHERE d.d_month = 'March' AND d.d_year = 1992 GROUP BY c.c_name ORDER BY revenue DESC LIMIT 10;
SELECT p.p_category, COUNT(*) AS num_products FROM part p WHERE p.p_size BETWEEN 10 AND 20 GROUP BY p.p_category HAVING COUNT(*) > 100 ORDER BY num_products DESC;
SELECT s.s_name, s.s_city, SUM(lo.lo_supplycost * lo.lo_quantity) AS total_supply_cost FROM lineorder lo JOIN supplier s ON lo.lo_suppkey = s.s_suppkey JOIN date_dim d ON lo.lo_commitdate = d.d_datekey WHERE d.d_dayofweek = 'Thursday' AND d.d_month = 'November' GROUP BY s.s_name, s.s_city ORDER BY total_supply_cost DESC LIMIT 5;
SELECT c.c_mktsegment, d.d_year, SUM(lo.lo_revenue - lo.lo_supplycost) AS profit FROM lineorder lo JOIN customer c ON lo.lo_custkey = c.c_custkey JOIN date_dim d ON lo.lo_orderdate = d.d_datekey WHERE d.d_year IN (1992, 1993) GROUP BY c.c_mktsegment, d.d_year ORDER BY c.c_mktsegment, d.d_year;
SELECT s.s_name, s.s_address, s.s_phone, SUM(lo.lo_revenue) AS total_revenue FROM lineorder lo JOIN supplier s ON lo.lo_suppkey = s.s_suppkey JOIN date_dim d ON lo.lo_orderdate = d.d_datekey WHERE d.d_date BETWEEN '1992-01-01' AND '1992-12-31' GROUP BY s.s_name, s.s_address, s.s_phone HAVING SUM(lo.lo_revenue) > 1000000 ORDER BY total_revenue DESC;
SELECT p.p_brand, AVG(lo.lo_quantity) AS avg_quantity FROM lineorder lo JOIN part p ON lo.lo_partkey = p.p_partkey JOIN date_dim d ON lo.lo_orderdate = d.d_datekey WHERE d.d_daynuminweek = 7 AND d.d_month = 'July' GROUP BY p.p_brand HAVING AVG(lo.lo_quantity) > 50 ORDER BY avg_quantity DESC;
SELECT c.c_name, c.c_address, c.c_phone, COUNT(lo.lo_orderkey) AS num_orders FROM lineorder lo JOIN customer c ON lo.lo_custkey = c.c_custkey JOIN date_dim d ON lo.lo_orderdate = d.d_datekey WHERE d.d_dayofweek = 'Friday' AND d.d_year = 1993 GROUP BY c.c_name, c.c_address, c.c_phone HAVING COUNT(lo.lo_orderkey) > 10 ORDER BY num_orders DESC;
SELECT s.s_name, s.s_city, COUNT(lo.lo_orderkey) AS num_orders FROM lineorder lo JOIN supplier s ON lo.lo_suppkey = s.s_suppkey JOIN date_dim d ON lo.lo_orderdate = d.d_datekey WHERE d.d_daynuminweek = 3 AND d.d_month = 'March' AND s.s_city = 'KENYA    3' GROUP BY s.s_name, s.s_city HAVING COUNT(lo.lo_orderkey) > 5 ORDER BY num_orders DESC;