SELECT c.c_salutation, c.c_first_name, c.c_birth_year, COUNT(*) AS total_orders FROM customer c JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk WHERE c.c_birth_country = 'NORWAY' AND c.c_birth_year = '1950' GROUP BY c.c_salutation, c.c_first_name, c.c_birth_year ORDER BY total_orders DESC;
SELECT i.i_item_id, i.i_item_desc, SUM(cs.cs_ext_list_price) AS total_list_price FROM item i JOIN catalog_sales cs ON i.i_item_sk = cs.cs_item_sk WHERE cs.cs_ship_addr_sk = '29200' AND cs.cs_catalog_page_sk = '128' GROUP BY i.i_item_id, i.i_item_desc ORDER BY total_list_price DESC;
SELECT ws.ws_web_site_sk, ws.ws_order_number, ws.ws_net_paid, ws.ws_net_paid_inc_tax, ws.ws_net_profit FROM web_sales ws WHERE ws.ws_bill_customer_sk = '306' AND ws.ws_net_paid_inc_tax > (SELECT AVG(ws2.ws_net_paid_inc_tax) FROM web_sales ws2) ORDER BY ws.ws_net_profit DESC;
SELECT s.s_store_name, w.w_warehouse_name, SUM(inv.inv_quantity_on_hand) AS total_inventory FROM store s JOIN inventory inv ON s.s_store_sk = inv.inv_warehouse_sk JOIN warehouse w ON w.w_warehouse_sk = inv.inv_warehouse_sk GROUP BY s.s_store_name, w.w_warehouse_name HAVING SUM(inv.inv_quantity_on_hand) > (SELECT AVG(inv2.inv_quantity_on_hand) FROM inventory inv2) ORDER BY total_inventory DESC;