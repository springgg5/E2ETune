SELECT c.c_name, c.c_mktsegment, SUM(lo.lo_extendedprice * (1 - lo.lo_discount)) AS revenue FROM customer c JOIN lineorder lo ON c.c_custkey = lo.lo_custkey WHERE c.c_mktsegment IN ('AUTOMOBILE', 'MACHINERY', 'HOUSEHOLD') AND lo.lo_orderdate BETWEEN 19940101 AND 19941231 GROUP BY c.c_name, c.c_mktsegment ORDER BY revenue DESC LIMIT 10;
SELECT p.p_category, p.p_container, SUM(lo.lo_quantity) AS total_quantity, AVG(lo.lo_extendedprice) AS avg_extendedprice, COUNT(lo.lo_orderkey) AS order_count FROM part p JOIN lineorder lo ON p.p_partkey = lo.lo_partkey WHERE p.p_category IN ('MFGR#24', 'MFGR#12', 'MFGR#54') AND p.p_container IN ('JUMBO CASE', 'JUMBO BOX', 'LG BAG') GROUP BY p.p_category, p.p_container HAVING COUNT(lo.lo_orderkey) > 10 ORDER BY total_quantity DESC;
SELECT s.s_name, s.s_region, COUNT(lo.lo_orderkey) AS order_count, SUM(lo.lo_extendedprice * (1 - lo.lo_discount)) AS revenue FROM supplier s JOIN lineorder lo ON s.s_suppkey = lo.lo_suppkey WHERE s.s_region IN ('MIDDLE EAST', 'AMERICA', 'EUROPE') AND lo.lo_orderpriority = '1-URGENT' AND lo.lo_shipmode = 'REG AIR' GROUP BY s.s_name, s.s_region HAVING COUNT(lo.lo_orderkey) > 5 ORDER BY revenue DESC LIMIT 5;