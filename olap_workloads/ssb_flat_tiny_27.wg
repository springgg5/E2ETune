SELECT c_region, COUNT(DISTINCT lo_custkey) AS num_customers FROM lineorder_flat WHERE lo_orderdate >= '19971026' AND lo_orderdate <= '19980228' GROUP BY c_region ORDER BY num_customers DESC;
SELECT p_category, p_brand, SUM(lo_quantity) AS total_quantity, AVG(lo_extendedprice) AS avg_extendedprice FROM lineorder_flat WHERE p_color = 'drab' AND lo_orderdate >= '19970912' AND lo_orderdate <= '19980228' GROUP BY p_category, p_brand ORDER BY total_quantity DESC;
SELECT s_nation, COUNT(DISTINCT lo_orderkey) AS num_orders FROM lineorder_flat WHERE lo_orderpriority = '1-URGENT' AND lo_orderdate >= '19971026' AND lo_orderdate <= '19980228' GROUP BY s_nation ORDER BY num_orders DESC;
SELECT c_city, SUM(lo_revenue) AS total_revenue FROM lineorder_flat WHERE lo_orderdate >= '19971026' AND lo_orderdate <= '19980228' AND p_type = 'MEDIUM PLATED BRASS' GROUP BY c_city ORDER BY total_revenue DESC;
SELECT c_mktsegment, COUNT(DISTINCT lo_orderkey) AS num_orders, SUM(lo_revenue) AS total_revenue FROM lineorder_flat WHERE lo_orderdate >= '19971026' AND lo_orderdate <= '19980228' AND p_color = 'sky' GROUP BY c_mktsegment ORDER BY total_revenue DESC;
SELECT s_name, COUNT(DISTINCT lo_orderkey) AS num_orders FROM lineorder_flat WHERE lo_orderdate >= '19971026' AND lo_orderdate <= '19980228' AND lo_orderkey IN (4850817, 16578432, 17181986) GROUP BY s_name ORDER BY num_orders DESC;
SELECT p_name, SUM(lo_supplycost) AS total_supplycost FROM lineorder_flat WHERE lo_orderdate >= '19971026' AND lo_orderdate <= '19980228' AND p_type = 'LARGE ANODIZED NICKEL' GROUP BY p_name ORDER BY total_supplycost DESC;
SELECT c_nation, SUM(lo_tax) AS total_tax FROM lineorder_flat WHERE lo_orderdate >= '19971026' AND lo_orderdate <= '19980228' AND p_color = 'brown' GROUP BY c_nation ORDER BY total_tax DESC;
SELECT lo_orderpriority, COUNT(DISTINCT lo_orderkey) AS num_orders, AVG(lo_discount) AS avg_discount FROM lineorder_flat WHERE lo_orderdate >= '19971026' AND lo_orderdate <= '19980228' GROUP BY lo_orderpriority ORDER BY num_orders DESC;
SELECT p_container, SUM(lo_quantity) AS total_quantity FROM lineorder_flat WHERE lo_orderdate >= '19971026' AND lo_orderdate <= '19980228' AND p_type = 'LARGE PLATED TIN' GROUP BY p_container ORDER BY total_quantity DESC;