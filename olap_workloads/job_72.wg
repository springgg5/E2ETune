SELECT kt.kind, COUNT(*) AS num_movies FROM title t JOIN kind_type kt ON t.kind_id = kt.id WHERE t.production_year >= 2000 GROUP BY kt.kind ORDER BY num_movies DESC;
SELECT n.name, COUNT(*) AS num_roles FROM name n JOIN cast_info ci ON n.id = ci.person_id JOIN role_type rt ON ci.role_id = rt.id WHERE rt.role = 'actor' OR rt.role = 'actress' GROUP BY n.name ORDER BY num_roles DESC LIMIT 10;
SELECT t.title, COUNT(*) AS num_keywords FROM title t JOIN movie_keyword mk ON t.id = mk.movie_id JOIN keyword k ON mk.keyword_id = k.id WHERE t.production_year BETWEEN 2010 AND 2020 GROUP BY t.title ORDER BY num_keywords DESC LIMIT 10;
SELECT cn.name, COUNT(*) AS num_characters FROM char_name cn JOIN cast_info ci ON cn.id = ci.person_role_id JOIN role_type rt ON ci.role_id = rt.id WHERE rt.role = 'actor' OR rt.role = 'actress' GROUP BY cn.name ORDER BY num_characters DESC LIMIT 10;
SELECT t.title, AVG(ci.nr_order) AS avg_order FROM title t JOIN cast_info ci ON t.id = ci.movie_id JOIN role_type rt ON ci.role_id = rt.id WHERE rt.role = 'actor' OR rt.role = 'actress' GROUP BY t.title HAVING COUNT(*) > 10 ORDER BY avg_order ASC LIMIT 10;
SELECT t.title, COUNT(DISTINCT ci.person_id) AS num_actors FROM title t JOIN cast_info ci ON t.id = ci.movie_id JOIN role_type rt ON ci.role_id = rt.id WHERE rt.role = 'actor' OR rt.role = 'actress' AND t.production_year BETWEEN 2000 AND 2020 GROUP BY t.title ORDER BY num_actors DESC LIMIT 10;