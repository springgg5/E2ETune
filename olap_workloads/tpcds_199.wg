SELECT r.r_reason_desc, COUNT(sr.sr_reason_sk) AS return_count FROM store_returns sr JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk WHERE r.r_reason_desc IN ('Wrong size', 'Parts missing', 'Did not like the model') GROUP BY r.r_reason_desc ORDER BY return_count DESC;
SELECT i.i_category, AVG(ws.ws_sales_price) AS average_sales_price FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk GROUP BY i.i_category HAVING AVG(ws.ws_sales_price) > 100 ORDER BY average_sales_price DESC;
SELECT s.s_store_name, SUM(ss.ss_quantity) AS total_quantity_sold FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk WHERE s.s_state = 'TN' GROUP BY s.s_store_name ORDER BY total_quantity_sold DESC;
SELECT w.w_warehouse_name, SUM(inv.inv_quantity_on_hand) AS total_inventory FROM inventory inv JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk GROUP BY w.w_warehouse_name HAVING SUM(inv.inv_quantity_on_hand) > 1000 ORDER BY total_inventory DESC;
SELECT p.p_promo_name, COUNT(cs.cs_promo_sk) AS total_orders FROM catalog_sales cs JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk WHERE p.p_discount_active = 'Y' GROUP BY p.p_promo_name ORDER BY total_orders DESC;
SELECT COUNT(*) AS total_returns FROM (SELECT cr.cr_item_sk, cr.cr_order_number FROM catalog_returns cr UNION ALL SELECT wr.wr_item_sk, wr.wr_order_number FROM web_returns wr) AS all_returns WHERE all_returns.cr_item_sk IN (SELECT i.i_item_sk FROM item i WHERE i.i_category = 'Electronics');