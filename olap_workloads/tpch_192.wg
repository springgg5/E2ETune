SELECT p.p_type, SUM(l.l_quantity) as total_quantity, AVG(l.l_extendedprice) as average_price FROM part p JOIN lineitem l ON p.p_partkey = l.l_partkey WHERE p.p_size = 10 AND l.l_shipinstruct = 'COLLECT COD' AND l.l_returnflag = 'A' GROUP BY p.p_type ORDER BY total_quantity DESC;
SELECT o.o_orderpriority, COUNT(o.o_orderkey) as order_count, SUM(o.o_totalprice) as total_price FROM orders o WHERE o.o_orderstatus = 'F' AND o.o_shippriority = 0 AND o.o_orderdate BETWEEN '2020-01-01' AND '2020-12-31' GROUP BY o.o_orderpriority ORDER BY order_count DESC;
SELECT c.c_mktsegment, s.s_nationkey, COUNT(l.l_orderkey) as lineitem_count, SUM(l.l_quantity) as total_quantity, AVG(l.l_discount) as average_discount FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN supplier s ON l.l_suppkey = s.s_suppkey WHERE o.o_orderstatus = 'O' AND l.l_shipdate BETWEEN '2020-01-01' AND '2020-12-31' GROUP BY c.c_mktsegment, s.s_nationkey ORDER BY lineitem_count DESC;