SELECT i.i_item_id, i.i_item_desc, SUM(ss.ss_quantity) as total_quantity_sold, SUM(ss.ss_net_profit) as total_profit FROM item i JOIN store_sales ss ON i.i_item_sk = ss.ss_item_sk WHERE i.i_rec_start_date = '2001-10-27' GROUP BY i.i_item_id, i.i_item_desc ORDER BY total_profit DESC LIMIT 10;
SELECT ca.ca_state, COUNT(DISTINCT c.c_customer_sk) as num_customers FROM customer c JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk GROUP BY ca.ca_state ORDER BY num_customers DESC;
SELECT w.w_warehouse_name, SUM(inv.inv_quantity_on_hand) as total_inventory FROM warehouse w JOIN inventory inv ON w.w_warehouse_sk = inv.inv_warehouse_sk GROUP BY w.w_warehouse_name HAVING SUM(inv.inv_quantity_on_hand) > 10000 ORDER BY total_inventory DESC;
SELECT r.r_reason_desc, COUNT(sr.sr_reason_sk) as num_returns FROM store_returns sr JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk GROUP BY r.r_reason_desc ORDER BY num_returns DESC;
SELECT p.p_promo_name, SUM(cs.cs_net_profit) as total_profit FROM catalog_sales cs JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk WHERE p.p_start_date_sk >= (SELECT d_date_sk FROM date_dim WHERE d_date = '2000-01-01') AND p.p_end_date_sk <= (SELECT d_date_sk FROM date_dim WHERE d_date = '2000-12-31') GROUP BY p.p_promo_name ORDER BY total_profit DESC;
SELECT s.s_store_name, SUM(ss.ss_net_profit) as total_profit FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk WHERE ss.ss_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy = 12) GROUP BY s.s_store_name ORDER BY total_profit DESC;
SELECT wp.wp_type, COUNT(DISTINCT ws.ws_web_page_sk) as num_sales FROM web_sales ws JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk GROUP BY wp.wp_type HAVING COUNT(DISTINCT ws.ws_web_page_sk) > 10 ORDER BY num_sales DESC;
SELECT i.i_product_name, COUNT(DISTINCT ws.ws_order_number) as num_orders FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk WHERE i.i_rec_start_date = '2001-10-27' GROUP BY i.i_product_name HAVING COUNT(DISTINCT ws.ws_order_number) > 50 ORDER BY num_orders DESC;
SELECT c.c_first_name, c.c_last_name, COUNT(DISTINCT cs.cs_order_number) as num_orders FROM catalog_sales cs JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk WHERE cs.cs_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_qoy = 1) GROUP BY c.c_first_name, c.c_last_name ORDER BY num_orders DESC LIMIT 10;
SELECT hd.hd_income_band_sk, COUNT(DISTINCT c.c_customer_sk) as num_customers FROM customer c JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk GROUP BY hd.hd_income_band_sk HAVING COUNT(DISTINCT c.c_customer_sk) > 100 ORDER BY num_customers DESC;