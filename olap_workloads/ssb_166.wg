SELECT d_year, s_nation, p_category, SUM(lo_revenue - lo_supplycost) AS profit FROM lineorder, date_dim, supplier, part WHERE lo_orderdate = d_datekey AND lo_suppkey = s_suppkey AND lo_partkey = p_partkey AND d_year IN (1992, 1993) AND s_nation IN ('PERU', 'INDONESIA', 'ALGERIA') AND p_category IN ('MFGR#45', 'MFGR#34', 'MFGR#35') GROUP BY d_year, s_nation, p_category ORDER BY d_year, s_nation, p_category;
SELECT c_name, c_address, SUM(lo_revenue) AS revenue FROM lineorder, customer WHERE lo_custkey = c_custkey AND lo_orderpriority = '2-HIGH' AND lo_orderdate BETWEEN 2451545 AND 2451910 GROUP BY c_name, c_address ORDER BY revenue DESC LIMIT 10;
SELECT s_name, s_address, COUNT(*) AS order_count FROM lineorder, supplier WHERE lo_suppkey = s_suppkey AND lo_orderpriority = '5-LOW' AND lo_shipmode IN ('AIR', 'FOB') GROUP BY s_name, s_address ORDER BY order_count DESC LIMIT 10;
SELECT d_year, p_brand, p_type, SUM(lo_quantity) AS total_quantity FROM lineorder, part, date_dim WHERE lo_partkey = p_partkey AND lo_orderdate = d_datekey AND d_year IN (1994, 1993) AND p_brand IN ('MFGR#3121', 'MFGR#5515', 'MFGR#116') AND p_type IN ('STANDARD ANODIZED COPPER', 'ECONOMY ANODIZED NICKEL', 'SMALL BURNISHED BRASS') GROUP BY d_year, p_brand, p_type ORDER BY d_year, p_brand, p_type;
SELECT s_region, s_nation, AVG(lo_discount) AS avg_discount, COUNT(*) AS discount_count FROM lineorder, supplier WHERE lo_suppkey = s_suppkey AND lo_orderpriority = '4-NOT SPECIFIED' AND s_region IN ('ASIA', 'AMERICA', 'EUROPE') GROUP BY s_region, s_nation ORDER BY s_region, s_nation;
SELECT d_year, d_month, SUM(lo_revenue) AS monthly_revenue FROM lineorder, date_dim WHERE lo_orderdate = d_datekey AND d_daynuminweek IN (2, 5, 3) AND d_year IN (1994, 1992, 1993) GROUP BY d_year, d_month ORDER BY d_year, d_month;
SELECT p_mfgr, COUNT(*) AS part_count, SUM(lo_quantity) AS total_quantity, AVG(lo_extendedprice) AS avg_price FROM lineorder, part WHERE lo_partkey = p_partkey AND p_mfgr IN ('MFGR#4', 'MFGR#2', 'MFGR#5') GROUP BY p_mfgr ORDER BY p_mfgr;
SELECT c_city, c_nation, SUM(lo_revenue) AS total_revenue, COUNT(*) AS order_count FROM lineorder, customer WHERE lo_custkey = c_custkey AND c_mktsegment = 'AUTOMOBILE' AND lo_orderdate BETWEEN 2451545 AND 2451910 GROUP BY c_city, c_nation ORDER BY c_city, c_nation;
SELECT d_year, p_category, COUNT(DISTINCT lo_orderkey) AS num_orders FROM lineorder, part, date_dim WHERE lo_partkey = p_partkey AND lo_orderdate = d_datekey AND d_year IN (1994, 1993) AND p_category IN ('MFGR#45', 'MFGR#34', 'MFGR#35') GROUP BY d_year, p_category ORDER BY d_year, p_category;