SELECT c_region, s_region, p_category, SUM(lo_extendedprice * lo_discount) AS revenue FROM lineorder_flat WHERE lo_shipmode = 'RAIL' AND lo_orderdate >= 19940101 AND lo_orderdate <= 19941231 GROUP BY c_region, s_region, p_category ORDER BY c_region, s_region, p_category;
SELECT c_mktsegment, p_brand, p_container, SUM(lo_quantity) AS total_quantity, AVG(lo_extendedprice) AS avg_price FROM lineorder_flat WHERE lo_shipmode = 'MAIL' AND lo_orderdate >= 19950101 AND lo_orderdate <= 19951231 GROUP BY c_mktsegment, p_brand, p_container HAVING SUM(lo_quantity) > 1000 ORDER BY c_mktsegment, p_brand, p_container;
SELECT c_nation, s_nation, p_type, COUNT(DISTINCT lo_orderkey) AS num_orders FROM lineorder_flat WHERE lo_shipmode = 'FOB' AND lo_orderdate >= 19960101 AND lo_orderdate <= 19961231 AND lo_commitdate < lo_orderdate AND lo_discount BETWEEN 5 AND 7 AND lo_quantity < 30 GROUP BY c_nation, s_nation, p_type ORDER BY c_nation, s_nation, p_type;
SELECT c_city, s_city, p_size, p_color, SUM(lo_supplycost * lo_tax) AS total_cost FROM lineorder_flat WHERE s_address = 'ECzkNeC0mPVTX' AND lo_orderpriority = '1-URGENT' AND lo_orderdate >= 19970101 AND lo_orderdate <= 19971231 GROUP BY c_city, s_city, p_size, p_color HAVING SUM(lo_supplycost * lo_tax) > 10000 ORDER BY c_city, s_city, p_size, p_color;