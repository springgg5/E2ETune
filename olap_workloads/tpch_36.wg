SELECT n_name, r_name, COUNT(*) AS num_customers, AVG(c_acctbal) AS avg_acctbal FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey WHERE c.c_acctbal > 5000 GROUP BY n_name, r_name ORDER BY num_customers DESC, avg_acctbal DESC;
SELECT s_name, p_name, SUM(ps_availqty) AS total_avail_qty, AVG(ps_supplycost) AS avg_supply_cost FROM partsupp ps JOIN supplier s ON ps.ps_suppkey = s.s_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey WHERE s.s_nationkey = 6 AND p.p_size BETWEEN 10 AND 50 GROUP BY s_name, p_name HAVING SUM(ps_availqty) > 1000 ORDER BY total_avail_qty DESC, avg_supply_cost ASC;
SELECT o_orderpriority, COUNT(*) AS num_orders, SUM(o_totalprice) AS total_revenue, AVG(l_extendedprice * (1 - l_discount)) AS avg_discounted_price FROM orders o JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE o.o_orderdate BETWEEN '1995-01-01' AND '1995-12-31' AND l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY o_orderpriority ORDER BY num_orders DESC, total_revenue DESC;