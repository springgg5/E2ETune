SELECT c_region, COUNT(lo_orderkey) AS num_orders, SUM(lo_extendedprice) AS total_sales FROM lineorder_flat WHERE lo_orderpriority = '1-URGENT' OR lo_orderpriority = '2-HIGH' GROUP BY c_region ORDER BY total_sales DESC;
SELECT p_category, p_brand, AVG(lo_quantity) AS avg_quantity, AVG(lo_supplycost) AS avg_supplycost FROM lineorder_flat WHERE lo_partkey IN (8590, 8592, 8594) AND c_name IN ('Customer#000059939', 'Customer#000094582', 'Customer#000130220') GROUP BY p_category, p_brand ORDER BY avg_quantity DESC, avg_supplycost ASC;
SELECT s_name, s_city, s_nation, COUNT(lo_orderkey) AS num_orders, SUM(lo_revenue) AS total_revenue FROM (SELECT * FROM lineorder_flat WHERE lo_commitdate >= lo_orderdate AND lo_shipmode IN ('AIR', 'RAIL')) AS subquery WHERE c_address = '3MycOSO' OR c_address = 'u7Vr6NC1WablTBi' OR c_address = 'T1poZqs,k' GROUP BY s_name, s_city, s_nation ORDER BY total_revenue DESC, num_orders DESC;