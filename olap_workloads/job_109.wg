SELECT title.title, kind_type.kind, COUNT(movie_keyword.keyword_id) AS num_keywords FROM title JOIN kind_type ON title.kind_id = kind_type.id JOIN movie_keyword ON title.id = movie_keyword.movie_id WHERE title.production_year >= 2000 GROUP BY title.title, kind_type.kind HAVING COUNT(movie_keyword.keyword_id) > 5 ORDER BY num_keywords DESC;
SELECT name.name, COUNT(cast_info.movie_id) AS num_movies FROM name JOIN cast_info ON name.id = cast_info.person_id JOIN role_type ON cast_info.role_id = role_type.id WHERE role_type.role = 'actor' OR role_type.role = 'actress' GROUP BY name.name HAVING COUNT(cast_info.movie_id) > 10 ORDER BY num_movies DESC;
SELECT movie_info.movie_id, info_type.info, AVG(CAST(movie_info.info AS integer)) AS average_rating FROM movie_info JOIN info_type ON movie_info.info_type_id = info_type.id WHERE info_type.info = 'rating' GROUP BY movie_info.movie_id, info_type.info HAVING COUNT(movie_info.movie_id) > 1 ORDER BY average_rating DESC;
SELECT company_name.name, COUNT(movie_companies.movie_id) AS num_movies FROM company_name JOIN movie_companies ON company_name.id = movie_companies.company_id JOIN company_type ON movie_companies.company_type_id = company_type.id WHERE company_type.kind = 'production' GROUP BY company_name.name HAVING COUNT(movie_companies.movie_id) > 5 ORDER BY num_movies DESC;
SELECT person_info.person_id, name.name, COUNT(person_info.info) AS num_facts FROM person_info JOIN name ON person_info.person_id = name.id WHERE person_info.info_type_id IN (SELECT id FROM info_type WHERE info IN ('birth date', 'death date')) GROUP BY person_info.person_id, name.name HAVING COUNT(person_info.info) > 1 ORDER BY num_facts DESC;
SELECT title.title, COUNT(movie_link.linked_movie_id) AS num_links FROM title JOIN movie_link ON title.id = movie_link.movie_id JOIN link_type ON movie_link.link_type_id = link_type.id WHERE link_type.link = 'followed by' GROUP BY title.title HAVING COUNT(movie_link.linked_movie_id) > 5 ORDER BY num_links DESC;