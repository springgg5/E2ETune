SELECT c_region, p_category, SUM(lo_extendedprice * lo_discount) AS revenue FROM lineorder_flat WHERE lo_orderdate >= '19940101' AND lo_orderdate <= '19941231' AND p_container IN ('MED CASE', 'LG DRUM', 'JUMBO BAG') AND lo_orderpriority IN ('1-URGENT', '2-HIGH', '5-LOW') GROUP BY c_region, p_category ORDER BY c_region, p_category;
SELECT s_name, s_city, s_nation, SUM(lo_revenue - lo_supplycost) AS profit FROM lineorder_flat WHERE lo_orderdate >= '19940101' AND lo_orderdate <= '19941231' AND p_mfgr IN ('MFGR#5', 'MFGR#1', 'MFGR#4') AND lo_shipmode = 'AIR' GROUP BY s_name, s_city, s_nation HAVING SUM(lo_revenue - lo_supplycost) > 100000 ORDER BY profit DESC;
SELECT c_name, c_city, c_nation, AVG(lo_quantity) AS avg_quantity, AVG(lo_extendedprice) AS avg_price, AVG(lo_discount) AS avg_discount, COUNT(*) AS order_count FROM lineorder_flat WHERE lo_orderdate >= '19940101' AND lo_orderdate <= '19941231' AND p_container IN ('MED CASE', 'LG DRUM', 'JUMBO BAG') AND lo_orderpriority IN ('1-URGENT', '2-HIGH', '5-LOW') GROUP BY c_name, c_city, c_nation HAVING COUNT(*) > 10 ORDER BY avg_quantity DESC, avg_price DESC;