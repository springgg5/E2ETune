SELECT kt.kind, COUNT(*) AS num_keywords, SUM(mk.keyword_id) AS total_keyword_id FROM kind_type AS kt JOIN movie_keyword AS mk ON kt.id = mk.keyword_id WHERE mk.keyword_id IN (1581, 22081, 22110) GROUP BY kt.kind HAVING COUNT(*) > 1 ORDER BY num_keywords DESC, total_keyword_id ASC;
SELECT ct.kind, COUNT(*) AS num_companies, AVG(mc.company_id) AS avg_company_id FROM company_type AS ct JOIN movie_companies AS mc ON ct.id = mc.company_type_id WHERE ct.kind IN ('distributors', 'production companies', 'miscellaneous companies') GROUP BY ct.kind HAVING COUNT(*) > 1 ORDER BY num_companies DESC, avg_company_id ASC;
SELECT n.name, COUNT(*) AS num_roles, SUM(ci.role_id) AS total_role_id FROM name AS n JOIN cast_info AS ci ON n.id = ci.person_id WHERE ci.role_id IN (SELECT id FROM role_type WHERE role IN ('actor', 'actress', 'director')) GROUP BY n.name HAVING COUNT(*) > 1 ORDER BY num_roles DESC, total_role_id ASC;
SELECT t.title, COUNT(*) AS num_links, AVG(ml.link_type_id) AS avg_link_type_id FROM title AS t JOIN movie_link AS ml ON t.id = ml.movie_id WHERE ml.link_type_id IN (SELECT id FROM link_type WHERE link IN ('follows', 'precedes', 'remake')) GROUP BY t.title HAVING COUNT(*) > 1 ORDER BY num_links DESC, avg_link_type_id ASC;