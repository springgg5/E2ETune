SELECT c.c_customer_id, c.c_first_name, c.c_last_name, COUNT(ss.ss_ticket_number) AS total_tickets, SUM(ss.ss_net_paid) AS total_payment FROM customer c JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk WHERE c.c_preferred_cust_flag = 'Y' AND c.c_birth_day = 17 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name ORDER BY total_payment DESC LIMIT 10;
SELECT w.w_warehouse_name, SUM(inv.inv_quantity_on_hand) AS total_inventory FROM warehouse w JOIN inventory inv ON w.w_warehouse_sk = inv.inv_warehouse_sk GROUP BY w.w_warehouse_name HAVING SUM(inv.inv_quantity_on_hand) > 1000 ORDER BY total_inventory DESC;
SELECT i.i_item_id, i.i_product_name, COUNT(cs.cs_item_sk) AS total_sales, AVG(cs.cs_sales_price) AS average_price FROM item i JOIN catalog_sales cs ON i.i_item_sk = cs.cs_item_sk WHERE i.i_category = 'Electronics' GROUP BY i.i_item_id, i.i_product_name HAVING COUNT(cs.cs_item_sk) > 10 ORDER BY total_sales DESC, average_price ASC;
SELECT wp.wp_url, COUNT(ws.ws_web_page_sk) AS total_sales, SUM(ws.ws_net_paid) AS total_revenue FROM web_page wp JOIN web_sales ws ON wp.wp_web_page_sk = ws.ws_web_page_sk WHERE wp.wp_link_count >= 18 AND wp.wp_link_count <= 25 GROUP BY wp.wp_url HAVING COUNT(ws.ws_web_page_sk) > 5 ORDER BY total_revenue DESC;
SELECT p.p_promo_name, COUNT(cs.cs_promo_sk) AS total_sales, SUM(cs.cs_net_paid) AS total_revenue FROM promotion p JOIN catalog_sales cs ON p.p_promo_sk = cs.cs_promo_sk WHERE p.p_channel_tv = 'Y' AND p.p_discount_active = 'Y' GROUP BY p.p_promo_name HAVING COUNT(cs.cs_promo_sk) > 10 ORDER BY total_revenue DESC;