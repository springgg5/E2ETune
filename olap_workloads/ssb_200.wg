SELECT c.c_name, c.c_city, SUM(lo.lo_revenue) as total_revenue FROM customer c JOIN lineorder lo ON c.c_custkey = lo.lo_custkey WHERE lo.lo_orderpriority = '1-URGENT' GROUP BY c.c_name, c.c_city ORDER BY total_revenue DESC LIMIT 10;
SELECT p.p_category, p.p_color, SUM(lo.lo_quantity) as total_quantity FROM part p JOIN lineorder lo ON p.p_partkey = lo.lo_partkey WHERE p.p_size = 44 AND lo.lo_orderdate >= 20210101 AND lo.lo_orderdate <= 20211231 GROUP BY p.p_category, p.p_color ORDER BY total_quantity DESC;
SELECT s.s_nation, s.s_region, COUNT(*) as total_suppliers FROM supplier s WHERE s.s_phone LIKE '14%' GROUP BY s.s_nation, s.s_region HAVING COUNT(*) > 5 ORDER BY total_suppliers DESC;
SELECT d.d_month, d.d_sellingseason, SUM(lo.lo_extendedprice * (1 - lo.lo_discount)) as total_sales FROM date_dim d JOIN lineorder lo ON d.d_datekey = lo.lo_orderdate WHERE d.d_year = 2021 GROUP BY d.d_month, d.d_sellingseason ORDER BY total_sales DESC;
SELECT p.p_brand, COUNT(*) as total_orders FROM part p JOIN lineorder lo ON p.p_partkey = lo.lo_partkey WHERE lo.lo_shipmode = 'AIR' AND lo.lo_commitdate BETWEEN 20210101 AND 20211231 GROUP BY p.p_brand HAVING COUNT(*) > 10 ORDER BY total_orders DESC;
SELECT c.c_mktsegment, AVG(lo.lo_revenue) as avg_revenue_per_order FROM customer c JOIN lineorder lo ON c.c_custkey = lo.lo_custkey WHERE lo.lo_orderdate BETWEEN 20210101 AND 20211231 GROUP BY c.c_mktsegment HAVING COUNT(*) > 100 ORDER BY avg_revenue_per_order DESC;
SELECT s.s_name, s.s_city, SUM(lo.lo_supplycost) as total_supply_cost FROM supplier s JOIN lineorder lo ON s.s_suppkey = lo.lo_suppkey WHERE s.s_region = 'EUROPE' AND lo.lo_orderdate BETWEEN 20210101 AND 20211231 GROUP BY s.s_name, s.s_city ORDER BY total_supply_cost DESC LIMIT 10;