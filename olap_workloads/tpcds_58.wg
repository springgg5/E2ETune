SELECT p.p_promo_sk, p.p_promo_name, COUNT(cs.cs_promo_sk) as total_sales FROM catalog_sales cs JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk WHERE p.p_channel_event = 'N' AND p.p_discount_active = 'N' AND p.p_channel_details IN ('Almost old churches ought to occur narrow', 'Numbers drive however. Yesterday ne', 'Strong samples participate. Influential legs fa') GROUP BY p.p_promo_sk, p.p_promo_name HAVING COUNT(cs.cs_promo_sk) > 0 ORDER BY total_sales DESC;
SELECT ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, COUNT(cd.cd_demo_sk) as total_customers FROM customer_demographics cd JOIN income_band ib ON cd.cd_purchase_estimate BETWEEN ib.ib_lower_bound AND ib.ib_upper_bound WHERE ib.ib_lower_bound IN (90001, 160001, 40001) AND ib.ib_upper_bound IN (30000, 20000, 40000) AND ib.ib_income_band_sk IN (10, 19, 14) GROUP BY ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY total_customers DESC;
SELECT i.i_item_id, i.i_product_name, COUNT(ss.ss_item_sk) as total_sold, AVG(ss.ss_sales_price) as average_price FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk GROUP BY i.i_item_id, i.i_product_name HAVING COUNT(ss.ss_item_sk) > 0 ORDER BY total_sold DESC, average_price ASC;
SELECT ws.ws_web_page_sk, wp.wp_url, COUNT(ws.ws_item_sk) as total_items_sold, SUM(ws.ws_net_paid) as total_revenue FROM web_sales ws JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk GROUP BY ws.ws_web_page_sk, wp.wp_url HAVING COUNT(ws.ws_item_sk) > 0 AND SUM(ws.ws_net_paid) > 0 ORDER BY total_items_sold DESC, total_revenue DESC;