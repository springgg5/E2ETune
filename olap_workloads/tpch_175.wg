SELECT o.o_orderpriority, COUNT(*) as order_count, AVG(o.o_totalprice) as avg_totalprice FROM orders o GROUP BY o.o_orderpriority ORDER BY order_count DESC;
SELECT c.c_mktsegment, SUM(l.l_extendedprice * (1 - l.l_discount)) as revenue FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE l.l_returnflag = 'N' GROUP BY c.c_mktsegment ORDER BY revenue DESC;
SELECT s.s_name, s.s_acctbal, n.n_name, s.s_address, s.s_phone FROM supplier s JOIN nation n ON s.s_nationkey = n.n_nationkey WHERE s.s_acctbal > (SELECT AVG(s2.s_acctbal) FROM supplier s2) ORDER BY s.s_acctbal DESC;
SELECT p.p_type, COUNT(*) as part_count, SUM(ps.ps_availqty) as total_avail_qty FROM part p JOIN partsupp ps ON p.p_partkey = ps.ps_partkey GROUP BY p.p_type HAVING SUM(ps.ps_availqty) > (SELECT AVG(total_qty) FROM (SELECT SUM(ps2.ps_availqty) as total_qty FROM partsupp ps2 GROUP BY ps2.ps_partkey) as subquery) ORDER BY total_avail_qty DESC;
SELECT r.r_name, COUNT(DISTINCT s.s_suppkey) as supplier_count FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey GROUP BY r.r_name ORDER BY supplier_count DESC;
SELECT o.o_orderstatus, COUNT(*) as order_count, SUM(l.l_extendedprice * (1 - l.l_discount)) as total_revenue FROM orders o JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE o.o_orderdate BETWEEN '1993-01-01' AND '1995-12-31' GROUP BY o.o_orderstatus ORDER BY total_revenue DESC;