SELECT p.p_type, p.p_color, d.d_sellingseason, COUNT(lo.lo_orderkey) AS order_count, SUM(lo.lo_quantity) AS total_quantity, AVG(lo.lo_extendedprice) AS avg_price FROM lineorder lo JOIN part p ON lo.lo_partkey = p.p_partkey JOIN date_dim d ON lo.lo_orderdate = d.d_datekey WHERE p.p_type IN ('SMALL BRUSHED NICKEL', 'SMALL ANODIZED COPPER', 'STANDARD PLATED BRASS') AND p.p_color IN ('azure', 'coral', 'snow') AND d.d_sellingseason IN ('Christmas', 'Summer', 'Fall') AND d.d_weekdayfl = '1' GROUP BY p.p_type, p.p_color, d.d_sellingseason ORDER BY p.p_type, p.p_color, d.d_sellingseason;
SELECT c.c_mktsegment, d.d_year, lo.lo_orderpriority, COUNT(lo.lo_orderkey) AS order_count, SUM(lo.lo_ordtotalprice) AS total_revenue, AVG(lo.lo_discount) AS avg_discount FROM lineorder lo JOIN customer c ON lo.lo_custkey = c.c_custkey JOIN date_dim d ON lo.lo_orderdate = d.d_datekey WHERE d.d_datekey BETWEEN '19920201' AND '19931011' GROUP BY c.c_mktsegment, d.d_year, lo.lo_orderpriority HAVING COUNT(lo.lo_orderkey) > 10 ORDER BY c.c_mktsegment, d.d_year, lo.lo_orderpriority;