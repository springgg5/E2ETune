SELECT c.c_custkey, c.c_name, c.c_region, SUM(lo.lo_revenue) AS total_revenue FROM customer c JOIN lineorder lo ON c.c_custkey = lo.lo_custkey WHERE c.c_mktsegment = 'FURNITURE' AND lo.lo_orderdate >= '19960111' AND lo.lo_orderdate <= '19961208' GROUP BY c.c_custkey, c.c_name, c.c_region HAVING SUM(lo.lo_revenue) > 5000000 ORDER BY total_revenue DESC;
SELECT p.p_partkey, p.p_name, p.p_color, p.p_type, d.d_year, d.d_sellingseason, COUNT(lo.lo_orderkey) AS num_orders, SUM(lo.lo_quantity) AS total_quantity, AVG(lo.lo_extendedprice) AS avg_extendedprice FROM part p JOIN lineorder lo ON p.p_partkey = lo.lo_partkey JOIN date_dim d ON lo.lo_orderdate = d.d_datekey WHERE p.p_container = 'LG BAG' AND d.d_sellingseason = 'Fall' AND p.p_color IN ('mint', 'ivory', 'beige') GROUP BY p.p_partkey, p.p_name, p.p_color, p.p_type, d.d_year, d.d_sellingseason HAVING COUNT(lo.lo_orderkey) > 10 ORDER BY num_orders DESC, total_quantity DESC;