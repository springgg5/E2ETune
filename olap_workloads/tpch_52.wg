SELECT n_name, COUNT(o_orderkey) AS num_orders, SUM(l_extendedprice * (1 - l_discount)) AS revenue FROM nation JOIN customer ON n_nationkey = c_nationkey JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey WHERE l_shipdate BETWEEN '1994-10-19' AND '1996-08-07' GROUP BY n_name ORDER BY revenue DESC;
SELECT r_name, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue FROM region JOIN nation ON r_regionkey = n_regionkey JOIN customer ON n_nationkey = c_nationkey JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey WHERE l_shipdate >= '1992-10-26' AND l_linestatus = 'F' GROUP BY r_name ORDER BY total_revenue DESC;
SELECT c_name, c_phone, SUM(l_extendedprice * (1 - l_discount)) AS total_spent FROM customer JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey WHERE l_tax IN (0.04, 0.03, 0.06) AND c_nationkey IN (14, 15, 1) GROUP BY c_name, c_phone HAVING SUM(l_extendedprice * (1 - l_discount)) > 100000 ORDER BY total_spent DESC;
SELECT p_type, COUNT(l_orderkey) AS num_orders, AVG(l_quantity) AS avg_quantity, AVG(l_extendedprice) AS avg_price FROM part JOIN lineitem ON p_partkey = l_partkey WHERE l_shipdate <= '1996-08-07' AND l_returnflag = 'O' GROUP BY p_type ORDER BY num_orders DESC;
SELECT o_orderpriority, COUNT(*) AS num_orders, AVG(o_totalprice) AS avg_order_price FROM orders WHERE o_orderdate BETWEEN '1994-10-19' AND '1996-08-07' GROUP BY o_orderpriority ORDER BY num_orders DESC;