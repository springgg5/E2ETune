SELECT c.c_name, SUM(lo.lo_extendedprice * lo.lo_discount) AS revenue FROM lineorder lo JOIN customer c ON lo.lo_custkey = c.c_custkey WHERE lo.lo_orderdate IN (SELECT d_datekey FROM date_dim WHERE d_weekdayfl = '1') GROUP BY c.c_name ORDER BY revenue DESC LIMIT 10;
SELECT p.p_name, p.p_category, COUNT(lo.lo_orderkey) AS num_orders FROM lineorder lo JOIN part p ON lo.lo_partkey = p.p_partkey WHERE lo.lo_discount >= 10 AND lo.lo_orderdate IN (SELECT d_datekey FROM date_dim WHERE d_daynuminmonth = 20) GROUP BY p.p_name, p.p_category ORDER BY num_orders DESC;
SELECT s.s_name, s.s_region, SUM(lo.lo_supplycost) AS total_supply_cost FROM lineorder lo JOIN supplier s ON lo.lo_suppkey = s.s_suppkey WHERE lo.lo_orderkey = 611 AND lo.lo_orderdate IN (SELECT d_datekey FROM date_dim WHERE d_monthnuminyear = 6) GROUP BY s.s_name, s.s_region ORDER BY total_supply_cost DESC;
SELECT c.c_mktsegment, AVG(lo.lo_extendedprice) AS avg_price FROM lineorder lo JOIN customer c ON lo.lo_custkey = c.c_custkey WHERE lo.lo_orderkey = 163 AND lo.lo_orderdate IN (SELECT d_datekey FROM date_dim WHERE d_year = 2020) GROUP BY c.c_mktsegment;
SELECT d.d_month, d.d_year, SUM(lo.lo_revenue) AS monthly_revenue FROM lineorder lo JOIN date_dim d ON lo.lo_orderdate = d.d_datekey WHERE lo.lo_orderpriority = 'High' AND lo.lo_shipmode = 'AIR' GROUP BY d.d_month, d.d_year ORDER BY d.d_year, d.d_month;
SELECT p.p_brand, p.p_color, COUNT(lo.lo_orderkey) AS num_orders FROM lineorder lo JOIN part p ON lo.lo_partkey = p.p_partkey WHERE lo.lo_discount = 0 AND lo.lo_orderdate IN (SELECT d_datekey FROM date_dim WHERE d_daynuminmonth = 8) GROUP BY p.p_brand, p.p_color ORDER BY num_orders DESC;
SELECT s.s_name, s.s_city, SUM(lo.lo_extendedprice * lo.lo_discount) AS revenue FROM lineorder lo JOIN supplier s ON lo.lo_suppkey = s.s_suppkey WHERE lo.lo_orderdate IN (SELECT d_datekey FROM date_dim WHERE d_weekdayfl = '0') GROUP BY s.s_name, s.s_city ORDER BY revenue DESC LIMIT 10;
SELECT c.c_name, c.c_city, COUNT(lo.lo_orderkey) AS num_orders FROM lineorder lo JOIN customer c ON lo.lo_custkey = c.c_custkey WHERE lo.lo_orderkey = 679 AND lo.lo_orderdate IN (SELECT d_datekey FROM date_dim WHERE d_year = 2019) GROUP BY c.c_name, c.c_city ORDER BY num_orders DESC;
SELECT d.d_year, d.d_month, SUM(lo.lo_revenue) AS monthly_revenue FROM lineorder lo JOIN date_dim d ON lo.lo_orderdate = d.d_datekey WHERE lo.lo_orderpriority = 'Low' AND lo.lo_shipmode = 'TRUCK' GROUP BY d.d_year, d.d_month ORDER BY d.d_year, d.d_month;
SELECT p.p_type, p.p_size, COUNT(lo.lo_orderkey) AS num_orders FROM lineorder lo JOIN part p ON lo.lo_partkey = p.p_partkey WHERE lo.lo_discount = 2 AND lo.lo_orderdate IN (SELECT d_datekey FROM date_dim WHERE d_daynuminmonth = 2) GROUP BY p.p_type, p.p_size ORDER BY num_orders DESC;