SELECT c_region, COUNT(lo_orderkey) AS num_orders, SUM(lo_extendedprice) AS total_price FROM lineorder_flat WHERE lo_custkey IN (139028, 18580, 64225) GROUP BY c_region ORDER BY total_price DESC;
SELECT p_category, p_brand, AVG(lo_quantity) AS avg_quantity, AVG(lo_extendedprice) AS avg_price FROM lineorder_flat WHERE lo_custkey IN (139028, 18580, 64225) GROUP BY p_category, p_brand ORDER BY avg_quantity DESC, avg_price DESC;
SELECT c_name, c_city, c_nation, SUM(lo_extendedprice) AS total_spent FROM lineorder_flat WHERE c_name IN ('Customer#000119318', 'Customer#000116696', 'Customer#000137296') GROUP BY c_name, c_city, c_nation ORDER BY total_spent DESC;
SELECT lo_orderpriority, COUNT(lo_orderkey) AS num_orders, SUM(lo_extendedprice) AS total_price FROM lineorder_flat WHERE lo_orderdate BETWEEN '19940101' AND '19941231' GROUP BY lo_orderpriority ORDER BY num_orders DESC;
SELECT s_name, s_city, s_nation, SUM(lo_supplycost) AS total_supply_cost FROM lineorder_flat WHERE lo_custkey IN (139028, 18580, 64225) GROUP BY s_name, s_city, s_nation ORDER BY total_supply_cost DESC;
SELECT p_name, p_mfgr, p_category, COUNT(lo_orderkey) AS num_orders, SUM(lo_extendedprice) AS total_price FROM lineorder_flat WHERE lo_custkey IN (139028, 18580, 64225) AND lo_orderdate BETWEEN '19940101' AND '19941231' GROUP BY p_name, p_mfgr, p_category ORDER BY num_orders DESC, total_price DESC;
SELECT lo_orderpriority, COUNT(lo_orderkey) AS num_orders, AVG(lo_discount) AS avg_discount, AVG(lo_tax) AS avg_tax FROM lineorder_flat WHERE lo_custkey IN (139028, 18580, 64225) GROUP BY lo_orderpriority ORDER BY num_orders DESC, avg_discount DESC, avg_tax DESC;