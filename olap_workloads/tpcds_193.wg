SELECT hd_demo_sk, COUNT(*) as total_customers FROM household_demographics WHERE hd_vehicle_count = 0 GROUP BY hd_demo_sk HAVING hd_demo_sk IN (591, 976, 343);
SELECT ws.ws_item_sk, SUM(ws.ws_sales_price) as total_sales_price, AVG(ws.ws_sales_price) as average_sales_price FROM web_sales ws JOIN web_site wsit ON ws.ws_web_site_sk = wsit.web_site_sk WHERE wsit.web_market_manager = 'James Bernard' GROUP BY ws.ws_item_sk HAVING SUM(ws.ws_sales_price) > 1000 ORDER BY total_sales_price DESC LIMIT 10;
SELECT wsit.web_street_name, wsit.web_city, COUNT(*) as total_sales FROM web_sales ws JOIN web_site wsit ON ws.ws_web_site_sk = wsit.web_site_sk WHERE wsit.web_street_name IN ('Hickory Meadow', 'Lake', 'Broadway South') AND wsit.web_city IN ('Fairview', 'Midway') GROUP BY wsit.web_street_name, wsit.web_city;
SELECT i.i_item_id, i.i_category, COUNT(ss.ss_item_sk) as total_sales FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk GROUP BY i.i_item_id, i.i_category HAVING COUNT(ss.ss_item_sk) > 1000 ORDER BY total_sales DESC;
SELECT w.w_warehouse_name, SUM(inv.inv_quantity_on_hand) as total_inventory FROM inventory inv JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk GROUP BY w.w_warehouse_name HAVING SUM(inv.inv_quantity_on_hand) > 50000 ORDER BY total_inventory DESC;
SELECT c.c_customer_id, COUNT(sr.sr_item_sk) as total_returns FROM store_returns sr JOIN customer c ON sr.sr_customer_sk = c.c_customer_sk GROUP BY c.c_customer_id HAVING COUNT(sr.sr_item_sk) > 5 ORDER BY total_returns DESC;
SELECT p.p_promo_name, COUNT(cs.cs_item_sk) as total_sales FROM catalog_sales cs JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk WHERE p.p_discount_active = 'Y' GROUP BY p.p_promo_name HAVING COUNT(cs.cs_item_sk) > 1000 ORDER BY total_sales DESC;
SELECT COUNT(*) as total_sales, EXTRACT(year FROM d.d_date) as sales_year FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE d.d_weekend = 'Y' GROUP BY sales_year;
SELECT cs.cs_item_sk, COUNT(*) as total_sales, SUM(cs.cs_sales_price) as total_revenue FROM catalog_sales cs WHERE cs.cs_ship_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2000-01-01' AND '2000-12-31') GROUP BY cs.cs_item_sk HAVING COUNT(*) > 10 AND SUM(cs.cs_sales_price) > 5000;
SELECT i.i_product_name, COUNT(cr.cr_item_sk) as total_returns, SUM(cr.cr_net_loss) as total_loss FROM catalog_returns cr JOIN item i ON cr.cr_item_sk = i.i_item_sk WHERE cr.cr_reason_sk IN (SELECT r_reason_sk FROM reason WHERE r_reason_desc LIKE '%damaged%') GROUP BY i.i_product_name HAVING COUNT(cr.cr_item_sk) > 5 AND SUM(cr.cr_net_loss) > 1000 ORDER BY total_loss DESC;