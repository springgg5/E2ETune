SELECT n.name, t.title, COUNT(c.movie_id) AS num_movies FROM name n JOIN cast_info c ON n.id = c.person_id JOIN title t ON c.movie_id = t.id WHERE c.person_id IN (141, 245, 166) GROUP BY n.name, t.title ORDER BY num_movies DESC;
SELECT k.keyword, COUNT(mk.movie_id) AS num_movies FROM keyword k JOIN movie_keyword mk ON k.id = mk.keyword_id GROUP BY k.keyword HAVING COUNT(mk.movie_id) > 10 ORDER BY num_movies DESC;
SELECT t.title, COUNT(*) AS num_cast_members FROM title t JOIN cast_info c ON t.id = c.movie_id WHERE c.role_id = 1 GROUP BY t.title HAVING COUNT(*) > 5 ORDER BY num_cast_members DESC;
SELECT cct.kind, COUNT(cc.movie_id) AS num_movies FROM comp_cast_type cct JOIN complete_cast cc ON cct.id = cc.subject_id WHERE cct.id IN (2, 1, 3) GROUP BY cct.kind ORDER BY num_movies DESC;
SELECT t.title, AVG(c.nr_order) AS avg_order FROM title t JOIN cast_info c ON t.id = c.movie_id WHERE c.role_id = 1 AND t.production_year BETWEEN 2000 AND 2010 GROUP BY t.title HAVING COUNT(*) > 5 ORDER BY avg_order DESC;
SELECT n.name, COUNT(*) AS num_movies FROM name n JOIN cast_info c ON n.id = c.person_id WHERE n.surname_pcode IN ('M5', 'V5', 'D') AND c.role_id = 1 GROUP BY n.name HAVING COUNT(*) > 3 ORDER BY num_movies DESC;
SELECT t.title, COUNT(*) AS num_companies FROM title t JOIN movie_companies mc ON t.id = mc.movie_id JOIN company_name cn ON mc.company_id = cn.id WHERE cn.country_code = 'US' GROUP BY t.title HAVING COUNT(*) > 1 ORDER BY num_companies DESC;
SELECT it.info, COUNT(mi.movie_id) AS num_movies FROM info_type it JOIN movie_info mi ON it.id = mi.info_type_id WHERE it.id = 4 AND mi.info = 'English' GROUP BY it.info ORDER BY num_movies DESC;