SELECT s.s_store_id, AVG(ss.ss_net_profit) AS avg_net_profit, COUNT(ss.ss_ticket_number) AS total_sales FROM store s JOIN store_sales ss ON s.s_store_sk = ss.ss_store_sk WHERE s.s_market_id = 10 AND s.s_hours = '8AM-4PM' AND s.s_street_type = 'Court' GROUP BY s.s_store_id HAVING COUNT(ss.ss_ticket_number) > 1000 ORDER BY avg_net_profit DESC;
SELECT cd.cd_education_status, SUM(cr.cr_refunded_cash) AS total_refunded_cash, COUNT(cr.cr_order_number) AS total_orders FROM customer_demographics cd JOIN catalog_returns cr ON cd.cd_demo_sk = cr.cr_returning_cdemo_sk WHERE cd.cd_credit_rating = 'Good' AND cd.cd_dep_employed_count = 0 AND cr.cr_fee BETWEEN 18.11 AND 68.65 AND cr.cr_return_quantity BETWEEN 1 AND 26 GROUP BY cd.cd_education_status HAVING COUNT(cr.cr_order_number) > 500 ORDER BY total_refunded_cash DESC;