SELECT ws.ws_item_sk, i.i_product_name, SUM(ws.ws_net_paid) AS total_net_paid, AVG(ws.ws_coupon_amt) AS avg_coupon_amt FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk WHERE ws.ws_ship_hdemo_sk IN (1181, 5944, 6953) AND ws.ws_coupon_amt IN (23.66, 271.14, 81.11) GROUP BY ws.ws_item_sk, i.i_product_name HAVING SUM(ws.ws_net_paid) > 10000 ORDER BY total_net_paid DESC;
SELECT cs.cs_item_sk, i.i_product_name, p.p_promo_name, COUNT(cs.cs_order_number) AS total_orders, SUM(cs.cs_net_paid) AS total_net_paid FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk WHERE cs.cs_bill_customer_sk IN (9065, 60494, 82128) AND cs.cs_bill_cdemo_sk IN (483275, 1322910, 704020) AND p.p_start_date_sk IN (2450749, 2450789, 2450146) AND p.p_response_target = 1 AND p.p_channel_demo = 'N' GROUP BY cs.cs_item_sk, i.i_product_name, p.p_promo_name HAVING COUNT(cs.cs_order_number) > 10 AND SUM(cs.cs_net_paid) > 5000 ORDER BY total_orders DESC, total_net_paid DESC;