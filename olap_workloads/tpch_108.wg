SELECT o.o_orderpriority, COUNT(*) AS order_count, AVG(o.o_totalprice) AS avg_order_price FROM orders o JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE o.o_orderdate BETWEEN '1992-08-15' AND '1995-09-19' AND l.l_linestatus = 'F' GROUP BY o.o_orderpriority ORDER BY o.o_orderpriority;
SELECT s.s_name, SUM(ps.ps_availqty) AS total_inventory, COUNT(DISTINCT p.p_partkey) AS num_parts FROM supplier s JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey WHERE s.s_nationkey IN (SELECT n.n_nationkey FROM nation n WHERE n.n_regionkey IN (SELECT r.r_regionkey FROM region r WHERE r.r_name = 'AMERICA')) GROUP BY s.s_name ORDER BY total_inventory DESC;