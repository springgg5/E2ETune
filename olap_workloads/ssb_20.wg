SELECT c.c_name, c.c_region, SUM(lo.lo_revenue) AS total_revenue FROM customer c JOIN lineorder lo ON c.c_custkey = lo.lo_custkey WHERE c.c_nation IN ('FRANCE', 'UNITED KINGDOM', 'ROMANIA') AND lo.lo_orderdate BETWEEN 20210101 AND 20211231 GROUP BY c.c_name, c.c_region ORDER BY total_revenue DESC LIMIT 10;
SELECT p.p_name, p.p_type, COUNT(lo.lo_partkey) AS total_orders, AVG(lo.lo_quantity) AS avg_quantity, SUM(lo.lo_extendedprice) AS total_price FROM part p JOIN lineorder lo ON p.p_partkey = lo.lo_partkey WHERE p.p_name IN ('royal deep', 'seashell burlywood', 'lavender lawn') AND lo.lo_orderdate BETWEEN 20210101 AND 20211231 GROUP BY p.p_name, p.p_type ORDER BY total_orders DESC;
SELECT s.s_name, s.s_city, COUNT(lo.lo_suppkey) AS total_orders, SUM(lo.lo_supplycost) AS total_supply_cost FROM supplier s JOIN lineorder lo ON s.s_suppkey = lo.lo_suppkey WHERE s.s_city IN ('MOZAMBIQU7', 'EGYPT    7', 'EGYPT    4') AND lo.lo_orderdate BETWEEN 20210101 AND 20211231 GROUP BY s.s_name, s.s_city ORDER BY total_supply_cost DESC;
SELECT d.d_month, d.d_year, lo.lo_orderpriority, COUNT(lo.lo_orderkey) AS total_orders, SUM(lo.lo_revenue) AS total_revenue FROM date_dim d JOIN lineorder lo ON d.d_datekey = lo.lo_orderdate WHERE d.d_year = 2021 AND lo.lo_orderpriority IN ('1-URGENT', '2-HIGH', '3-MEDIUM', '4-LOW', '5-NOT SPECIFIED') GROUP BY d.d_month, d.d_year, lo.lo_orderpriority ORDER BY d.d_month, lo.lo_orderpriority;