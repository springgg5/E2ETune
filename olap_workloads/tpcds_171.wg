SELECT s_state, COUNT(ss_ticket_number) AS num_sales, SUM(ss_net_paid) AS total_revenue FROM store_sales JOIN store ON store_sales.ss_store_sk = store.s_store_sk WHERE s_state = 'TN' GROUP BY s_state;
SELECT i_category, AVG(ws_sales_price) AS avg_sales_price FROM web_sales JOIN item ON web_sales.ws_item_sk = item.i_item_sk GROUP BY i_category HAVING AVG(ws_sales_price) > 50;
SELECT p_promo_name, SUM(cs_net_paid_inc_tax) AS total_revenue FROM catalog_sales JOIN promotion ON catalog_sales.cs_promo_sk = promotion.p_promo_sk WHERE p_start_date_sk >= (SELECT d_date_sk FROM date_dim WHERE d_date = '2023-11-01') AND p_end_date_sk <= (SELECT d_date_sk FROM date_dim WHERE d_date = '2023-11-30') GROUP BY p_promo_name;
SELECT w_warehouse_name, SUM(inv_quantity_on_hand) AS total_inventory FROM inventory JOIN warehouse ON inventory.inv_warehouse_sk = warehouse.w_warehouse_sk WHERE w_gmt_offset = -5.00 GROUP BY w_warehouse_name;
SELECT cc_call_center_id, COUNT(cr_order_number) AS num_returns, SUM(cr_net_loss) AS total_loss FROM catalog_returns JOIN call_center ON catalog_returns.cr_call_center_sk = call_center.cc_call_center_sk WHERE cc_rec_start_date <= '2023-11-20' AND (cc_rec_end_date >= '2023-11-20' OR cc_rec_end_date IS NULL) GROUP BY cc_call_center_id HAVING COUNT(cr_order_number) > 10 ORDER BY total_loss DESC;
SELECT wp_url, COUNT(wr_order_number) AS num_returns, SUM(wr_net_loss) AS total_loss FROM web_returns JOIN web_page ON web_returns.wr_web_page_sk = web_page.wp_web_page_sk WHERE wp_autogen_flag = 'N' AND wp_char_count BETWEEN 701 AND 5663 GROUP BY wp_url HAVING COUNT(wr_order_number) > 5 ORDER BY total_loss DESC;