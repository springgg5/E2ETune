SELECT company_name.name, COUNT(movie_companies.movie_id) as movie_count FROM company_name INNER JOIN movie_companies ON company_name.id = movie_companies.company_id WHERE company_name.name_pcode_sf IN ('W4325', 'P6163', 'J2541') AND company_name.name_pcode_nf IN ('U5', 'I5363', 'L5326') GROUP BY company_name.name ORDER BY movie_count DESC;
SELECT comp_cast_type.kind, COUNT(complete_cast.movie_id) as movie_count FROM comp_cast_type INNER JOIN complete_cast ON comp_cast_type.id = complete_cast.subject_id WHERE comp_cast_type.id IN (1, 3, 4) GROUP BY comp_cast_type.kind HAVING COUNT(complete_cast.movie_id) > 10 ORDER BY movie_count DESC;
SELECT title.title, AVG(cast_info.nr_order) as average_order FROM title INNER JOIN cast_info ON title.id = cast_info.movie_id WHERE title.kind_id = (SELECT kind_type.id FROM kind_type WHERE kind_type.kind = 'movie') AND title.production_year BETWEEN 2000 AND 2020 GROUP BY title.title HAVING COUNT(cast_info.person_id) > 5 ORDER BY average_order ASC;