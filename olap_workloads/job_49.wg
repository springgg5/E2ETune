SELECT t.title, COUNT(cast_info.person_id) AS num_actors FROM title AS t JOIN cast_info ON t.id = cast_info.movie_id WHERE t.production_year >= 2000 GROUP BY t.title HAVING COUNT(cast_info.person_id) > 10 ORDER BY num_actors DESC, t.title ASC;
SELECT keyword.keyword, AVG(movie_info.production_year) AS avg_production_year FROM movie_keyword JOIN keyword ON movie_keyword.keyword_id = keyword.id JOIN title AS movie_info ON movie_keyword.movie_id = movie_info.id WHERE keyword.keyword IN ('rich', 'foot-closeup', 'fear-of-ghosts') GROUP BY keyword.keyword;
SELECT company_name.name, COUNT(movie_companies.movie_id) AS num_movies FROM company_name JOIN movie_companies ON company_name.id = movie_companies.company_id WHERE company_name.country_code = 'US' GROUP BY company_name.name HAVING COUNT(movie_companies.movie_id) > 50 ORDER BY num_movies DESC;
SELECT name.name, COUNT(cast_info.movie_id) AS num_movies FROM name JOIN cast_info ON name.id = cast_info.person_id WHERE name.gender = 'F' GROUP BY name.name HAVING COUNT(cast_info.movie_id) > 10 ORDER BY num_movies DESC, name.name ASC;
SELECT kind_type.kind, COUNT(title.id) AS num_titles FROM kind_type JOIN title ON kind_type.id = title.kind_id WHERE title.production_year BETWEEN 1990 AND 2000 GROUP BY kind_type.kind HAVING COUNT(title.id) > 100 ORDER BY num_titles DESC;
SELECT movie_info.info, COUNT(movie_info.movie_id) AS num_movies FROM movie_info JOIN info_type ON movie_info.info_type_id = info_type.id WHERE info_type.info = 'genre' GROUP BY movie_info.info HAVING COUNT(movie_info.movie_id) > 500 ORDER BY num_movies DESC;