SELECT c_nation, COUNT(lo_orderkey) AS num_orders, SUM(lo_extendedprice) AS total_price, AVG(lo_extendedprice) AS avg_price FROM lineorder_flat WHERE lo_supplycost IN (56341, 56701, 56641) GROUP BY c_nation;
SELECT c_region, p_category, SUM(lo_quantity) AS total_quantity, AVG(lo_quantity) AS avg_quantity FROM lineorder_flat WHERE c_nation IN ('CHINA', 'JORDAN', 'SAUDI ARABIA') GROUP BY c_region, p_category ORDER BY c_region, p_category;
SELECT lo_orderpriority, COUNT(lo_orderkey) AS num_orders, SUM(lo_revenue) AS total_revenue, AVG(lo_revenue) AS avg_revenue FROM lineorder_flat WHERE lo_orderdate BETWEEN 20210101 AND 20211231 GROUP BY lo_orderpriority ORDER BY lo_orderpriority;
SELECT p_brand, p_container, COUNT(lo_partkey) AS num_parts, SUM(lo_supplycost) AS total_supply_cost FROM lineorder_flat WHERE lo_shipmode IN ('AIR', 'RAIL', 'SHIP') GROUP BY p_brand, p_container HAVING COUNT(lo_partkey) > 10 ORDER BY p_brand, p_container;
SELECT s_name, s_city, s_nation, SUM(lo_extendedprice * (1 - lo_discount)) AS total_revenue FROM lineorder_flat WHERE lo_commitdate BETWEEN 20210101 AND 20211231 AND c_nation IN ('CHINA', 'JORDAN', 'SAUDI ARABIA') GROUP BY s_name, s_city, s_nation ORDER BY total_revenue DESC;
SELECT c_name, c_city, c_nation, SUM(lo_extendedprice * (1 - lo_discount)) AS total_revenue FROM lineorder_flat WHERE lo_orderdate BETWEEN 20210101 AND 20211231 AND p_mfgr IN ('MFGR#1', 'MFGR#2', 'MFGR#3') GROUP BY c_name, c_city, c_nation HAVING SUM(lo_extendedprice * (1 - lo_discount)) > 1000000 ORDER BY total_revenue DESC;