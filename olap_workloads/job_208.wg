SELECT t.title, COUNT(cast_info.person_id) AS num_actors FROM title AS t JOIN cast_info ON t.id = cast_info.movie_id WHERE t.production_year > 2000 GROUP BY t.title HAVING COUNT(cast_info.person_id) > 5 ORDER BY num_actors DESC;
SELECT name.name, AVG(movie_info.info::float) AS avg_rating FROM movie_info JOIN title ON movie_info.movie_id = title.id JOIN cast_info ON title.id = cast_info.movie_id JOIN name ON cast_info.person_id = name.id WHERE movie_info.info_type_id = 101 GROUP BY name.name HAVING COUNT(title.id) > 3 ORDER BY avg_rating DESC;
SELECT k.keyword, COUNT(movie_keyword.movie_id) AS num_movies FROM keyword AS k JOIN movie_keyword ON k.id = movie_keyword.keyword_id WHERE k.phonetic_code IN ('B3613', 'B4234', 'M2431') GROUP BY k.keyword ORDER BY num_movies DESC;
SELECT t1.title AS movie_title, t2.title AS linked_movie_title, link_type.link FROM movie_link JOIN title AS t1 ON movie_link.movie_id = t1.id JOIN title AS t2 ON movie_link.linked_movie_id = t2.id JOIN link_type ON movie_link.link_type_id = link_type.id WHERE movie_link.movie_id IN (6126, 2661, 2026) AND movie_link.link_type_id IN (7, 6, 11) ORDER BY t1.title;
SELECT company_name.name, COUNT(movie_companies.movie_id) AS num_movies FROM company_name JOIN movie_companies ON company_name.id = movie_companies.company_id JOIN company_type ON movie_companies.company_type_id = company_type.id WHERE company_type.kind = 'Production' GROUP BY company_name.name HAVING COUNT(movie_companies.movie_id) > 10 ORDER BY num_movies DESC;
SELECT title.title, COUNT(movie_keyword.keyword_id) AS num_keywords FROM title JOIN movie_keyword ON title.id = movie_keyword.movie_id WHERE title.production_year BETWEEN 1990 AND 2000 GROUP BY title.title HAVING COUNT(movie_keyword.keyword_id) > 5 ORDER BY num_keywords DESC;
SELECT person_info.person_id, name.name, COUNT(movie_info.movie_id) AS num_movies_directed FROM person_info JOIN name ON person_info.person_id = name.id JOIN movie_info ON person_info.person_id = movie_info.movie_id WHERE person_info.info_type_id = 2 AND movie_info.info_type_id = 8 GROUP BY person_info.person_id, name.name HAVING COUNT(movie_info.movie_id) > 5 ORDER BY num_movies_directed DESC;