SELECT d.d_month_seq, SUM(ss.ss_net_profit) AS net_profit FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE d.d_qoy = 1 GROUP BY d.d_month_seq HAVING SUM(ss.ss_net_profit) > 5000 ORDER BY net_profit DESC;
SELECT i.i_product_name, COUNT(sr.sr_item_sk) AS return_count FROM store_returns sr JOIN item i ON sr.sr_item_sk = i.i_item_sk GROUP BY i.i_product_name HAVING COUNT(sr.sr_item_sk) > 10 ORDER BY return_count DESC;
SELECT w.w_warehouse_name, SUM(inv.inv_quantity_on_hand) AS total_inventory FROM inventory inv JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk GROUP BY w.w_warehouse_name HAVING SUM(inv.inv_quantity_on_hand) > 1000 ORDER BY total_inventory DESC;
SELECT wp.wp_web_page_id, AVG(wp.wp_link_count) AS avg_link_count FROM web_page wp WHERE wp.wp_link_count > 9 AND wp.wp_link_count < 18 GROUP BY wp.wp_web_page_id HAVING AVG(wp.wp_link_count) > 10 ORDER BY avg_link_count DESC;
SELECT d.d_date, COUNT(cs.cs_order_number) AS order_count FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE d.d_current_day = 'N' GROUP BY d.d_date HAVING COUNT(cs.cs_order_number) > 5 ORDER BY order_count DESC;
SELECT s.s_store_name, COUNT(DISTINCT ss.ss_customer_sk) AS unique_customer_count FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk GROUP BY s.s_store_name HAVING COUNT(DISTINCT ss.ss_customer_sk) > 50 ORDER BY unique_customer_count DESC;