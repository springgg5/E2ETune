SELECT c.c_first_name, c.c_last_name, SUM(ss.ss_net_profit) AS total_profit FROM customer c JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk WHERE c.c_current_cdemo_sk IN (SELECT cd_demo_sk FROM customer_demographics WHERE cd_education_status = 'College' AND cd_dep_college_count = '0') AND ss.ss_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 2022) GROUP BY c.c_first_name, c.c_last_name ORDER BY total_profit DESC LIMIT 10;
SELECT hd.hd_buy_potential, COUNT(*) AS num_customers, AVG(ca.ca_gmt_offset) AS avg_gmt_offset FROM household_demographics hd JOIN customer c ON hd.hd_demo_sk = c.c_current_hdemo_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk WHERE hd.hd_dep_count = 2 AND hd.hd_vehicle_count = 0 GROUP BY hd.hd_buy_potential HAVING COUNT(*) > 10 ORDER BY num_customers DESC;
SELECT ca.ca_street_type, ca.ca_street_name, COUNT(*) AS num_addresses FROM customer_address ca WHERE ca.ca_address_sk IN (SELECT c_current_addr_sk FROM customer WHERE c_birth_year BETWEEN 1980 AND 1990) GROUP BY ca.ca_street_type, ca.ca_street_name HAVING COUNT(*) > 5 ORDER BY num_addresses DESC;
SELECT i.i_category, COUNT(DISTINCT(cs.cs_order_number)) AS total_orders, SUM(cs.cs_net_profit) AS total_profit FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk WHERE cs.cs_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 2022 AND d_month_seq BETWEEN 1 AND 3) GROUP BY i.i_category ORDER BY total_profit DESC;