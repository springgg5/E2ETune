SELECT s.s_store_id, COUNT(ss.ss_ticket_number) AS total_sales, SUM(ss.ss_net_profit) AS total_profit FROM store s JOIN store_sales ss ON s.s_store_sk = ss.ss_store_sk WHERE s.s_market_id = 1 GROUP BY s.s_store_id ORDER BY total_profit DESC LIMIT 10;
SELECT cp.cp_catalog_number, cp.cp_department, COUNT(cs.cs_order_number) AS total_orders, SUM(cs.cs_net_profit) AS total_profit FROM catalog_page cp JOIN catalog_sales cs ON cp.cp_catalog_page_sk = cs.cs_catalog_page_sk WHERE cp.cp_catalog_number IN (1, 3, 4) GROUP BY cp.cp_catalog_number, cp.cp_department ORDER BY total_profit DESC;
SELECT sm.sm_code, sm.sm_contract, COUNT(ws.ws_order_number) AS total_orders, SUM(ws.ws_net_profit) AS total_profit FROM ship_mode sm JOIN web_sales ws ON sm.sm_ship_mode_sk = ws.ws_ship_mode_sk WHERE sm.sm_code IN ('BIKE', 'SURFACE', 'SEA') GROUP BY sm.sm_code, sm.sm_contract ORDER BY total_profit DESC;
SELECT i.i_item_id, i.i_category, SUM(inv.inv_quantity_on_hand) AS total_inventory FROM item i JOIN inventory inv ON i.i_item_sk = inv.inv_item_sk WHERE i.i_category IN ('Electronics', 'Clothing', 'Toys') GROUP BY i.i_item_id, i.i_category HAVING SUM(inv.inv_quantity_on_hand) > 1000 ORDER BY total_inventory DESC;
SELECT c.c_customer_id, COUNT(sr.sr_ticket_number) AS total_returns, SUM(sr.sr_net_loss) AS total_loss FROM customer c JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk WHERE c.c_preferred_cust_flag = 'Y' GROUP BY c.c_customer_id HAVING COUNT(sr.sr_ticket_number) > 5 ORDER BY total_loss DESC LIMIT 10;