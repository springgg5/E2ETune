SELECT t.title, COUNT(DISTINCT mk.keyword_id) AS keyword_count FROM title t JOIN movie_keyword mk ON t.id = mk.movie_id WHERE t.production_year BETWEEN 2000 AND 2020 GROUP BY t.title HAVING COUNT(DISTINCT mk.keyword_id) > 10 ORDER BY keyword_count DESC, t.title ASC LIMIT 10;
SELECT n.name, COUNT(DISTINCT ci.movie_id) AS movie_count FROM name n JOIN cast_info ci ON n.id = ci.person_id WHERE ci.role_id = 1 AND ci.person_role_id IN (70, 109, 34) GROUP BY n.name HAVING COUNT(DISTINCT ci.movie_id) > 5 ORDER BY movie_count DESC, n.name ASC LIMIT 10;
SELECT cn.name, COUNT(DISTINCT ci.movie_id) AS movie_count FROM char_name cn JOIN cast_info ci ON cn.id = ci.person_role_id WHERE ci.role_id = 1 AND ci.person_id IN (216, 283, 107) GROUP BY cn.name HAVING COUNT(DISTINCT ci.movie_id) > 3 ORDER BY movie_count DESC, cn.name ASC LIMIT 10;
SELECT kt.kind, COUNT(DISTINCT cc.movie_id) AS movie_count FROM kind_type kt JOIN title t ON kt.id = t.kind_id JOIN complete_cast cc ON t.id = cc.movie_id WHERE cc.status_id IN (4, 3) AND cc.subject_id = 1 GROUP BY kt.kind HAVING COUNT(DISTINCT cc.movie_id) > 5 ORDER BY movie_count DESC, kt.kind ASC LIMIT 5;