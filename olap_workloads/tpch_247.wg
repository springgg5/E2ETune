SELECT r.r_name, COUNT(DISTINCT c.c_custkey) as num_customers, SUM(l.l_extendedprice * (1 - l.l_discount)) as total_revenue FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE l.l_shipdate >= '1995-01-01' AND l.l_shipdate < '1996-01-01' AND r.r_name IN ('EUROPE', 'MIDDLE EAST', 'AFRICA') GROUP BY r.r_name ORDER BY total_revenue DESC;
SELECT p.p_type, p.p_brand, p.p_container, COUNT(DISTINCT l.l_orderkey) as num_orders, AVG(l.l_quantity) as avg_quantity, AVG(l.l_extendedprice) as avg_extendedprice, AVG(l.l_discount) as avg_discount FROM part p JOIN lineitem l ON p.p_partkey = l.l_partkey WHERE l.l_receiptdate >= '1994-01-01' AND l.l_receiptdate < '1995-01-01' AND p.p_type IN ('MEDIUM ANODIZED BRASS', 'MEDIUM ANODIZED NICKEL', 'LARGE PLATED NICKEL') GROUP BY p.p_type, p.p_brand, p.p_container ORDER BY num_orders DESC, p.p_type, p.p_brand, p.p_container;
SELECT o.o_orderpriority, COUNT(*) as num_orders FROM orders o WHERE o.o_orderdate >= '1993-07-01' AND o.o_orderdate < '1993-10-01' AND EXISTS (SELECT 1 FROM lineitem l WHERE l.l_orderkey = o.o_orderkey AND l.l_commitdate < l.l_receiptdate) GROUP BY o.o_orderpriority ORDER BY o.o_orderpriority;