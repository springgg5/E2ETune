SELECT c_city, s_region, COUNT(*) as order_count, SUM(lo_extendedprice) as total_extendedprice, AVG(lo_extendedprice) as avg_extendedprice FROM lineorder_flat WHERE c_city IN ('IRAQ     0', 'MOROCCO  7', 'RUSSIA   5') AND s_region IN ('AMERICA', 'AFRICA', 'EUROPE') GROUP BY c_city, s_region ORDER BY c_city, s_region;
SELECT lo_orderpriority, COUNT(*) as order_count, SUM(lo_quantity) as total_quantity, AVG(lo_quantity) as avg_quantity FROM lineorder_flat WHERE lo_orderdate >= 19940101 AND lo_orderdate <= 19941231 GROUP BY lo_orderpriority ORDER BY lo_orderpriority;
SELECT p_category, p_brand, COUNT(*) as product_count, SUM(lo_supplycost) as total_supplycost, AVG(lo_supplycost) as avg_supplycost FROM lineorder_flat WHERE lo_orderdate >= 19950101 AND lo_orderdate <= 19951231 GROUP BY p_category, p_brand ORDER BY p_category, p_brand;
SELECT c_mktsegment, s_nation, COUNT(*) as order_count, SUM(lo_revenue) as total_revenue, AVG(lo_revenue) as avg_revenue FROM lineorder_flat WHERE lo_commitdate >= 19960101 AND lo_commitdate <= 19961231 GROUP BY c_mktsegment, s_nation ORDER BY c_mktsegment, s_nation;
SELECT p_type, p_size, COUNT(*) as product_count, SUM(lo_extendedprice * (1 - lo_discount)) as total_discounted_price, AVG(lo_extendedprice * (1 - lo_discount)) as avg_discounted_price FROM lineorder_flat WHERE lo_shipmode IN ('AIR', 'RAIL', 'SHIP', 'TRUCK') GROUP BY p_type, p_size ORDER BY p_type, p_size;