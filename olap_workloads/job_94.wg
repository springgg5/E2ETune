SELECT t.title, COUNT(*) AS total_episodes FROM aka_title at JOIN title t ON at.movie_id = t.id WHERE at.episode_of_id IS NOT NULL AND at.season_nr IN (2, 19, 38) GROUP BY t.title ORDER BY total_episodes DESC;
SELECT cn.name, COUNT(*) AS total_characters FROM char_name cn JOIN cast_info ci ON cn.id = ci.person_role_id JOIN name n ON ci.person_id = n.id WHERE n.gender = 'm' AND n.surname_pcode IN ('A435', 'A5', 'A162') GROUP BY cn.name ORDER BY total_characters DESC;
SELECT k.keyword, COUNT(*) AS total_movies FROM keyword k JOIN movie_keyword mk ON k.id = mk.keyword_id JOIN title t ON mk.movie_id = t.id WHERE k.keyword IN ('fugitive', 'reference-to-longfellow', 'deadpan') GROUP BY k.keyword ORDER BY total_movies DESC;
SELECT c.name, COUNT(*) AS total_movies FROM company_name c JOIN movie_companies mc ON c.id = mc.company_id WHERE mc.company_type_id = 1 AND mc.note LIKE '%TV%' GROUP BY c.name ORDER BY total_movies DESC;
SELECT t.title, AVG(mi.info::integer) AS average_runtime FROM title t JOIN movie_info mi ON t.id = mi.movie_id WHERE mi.info_type_id = (SELECT id FROM info_type WHERE info = 'runtime') AND t.production_year BETWEEN 2000 AND 2020 GROUP BY t.title HAVING AVG(mi.info::integer) > 60 ORDER BY average_runtime DESC;
SELECT t.title, COUNT(*) AS total_links FROM title t JOIN movie_link ml ON t.id = ml.movie_id WHERE ml.link_type_id IN (SELECT id FROM link_type WHERE link IN ('follows', 'remake', 'prequel')) GROUP BY t.title HAVING COUNT(*) > 1 ORDER BY total_links DESC;