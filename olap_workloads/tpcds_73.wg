SELECT ca_city, ca_state, SUM(ss_net_profit) AS total_profit FROM store_sales JOIN customer_address ON store_sales.ss_addr_sk = customer_address.ca_address_sk WHERE ca_country = 'United States' AND ca_gmt_offset = '-5.00' GROUP BY ca_city, ca_state ORDER BY total_profit DESC LIMIT 10;
SELECT i_manufact, COUNT(*) as num_items FROM item WHERE i_wholesale_cost BETWEEN 0.18 AND 6.91 AND i_units = 'Tsp' GROUP BY i_manufact HAVING COUNT(*) > 10 ORDER BY num_items DESC;
SELECT w_state, w_city, AVG(inv_quantity_on_hand) as avg_inventory FROM inventory JOIN warehouse ON inventory.inv_warehouse_sk = warehouse.w_warehouse_sk WHERE w_country = 'United States' GROUP BY w_state, w_city ORDER BY avg_inventory DESC;
SELECT d_year, d_moy, SUM(ws_net_paid_inc_tax) as total_sales FROM web_sales JOIN date_dim ON web_sales.ws_sold_date_sk = date_dim.d_date_sk GROUP BY d_year, d_moy ORDER BY d_year, d_moy;
SELECT p_promo_name, COUNT(cs_order_number) as num_orders FROM catalog_sales JOIN promotion ON catalog_sales.cs_promo_sk = promotion.p_promo_sk WHERE p_channel_tv = 'Y' GROUP BY p_promo_name HAVING COUNT(cs_order_number) > 100 ORDER BY num_orders DESC;
SELECT cc_call_center_id, COUNT(cr_order_number) as num_returns FROM catalog_returns JOIN call_center ON catalog_returns.cr_call_center_sk = call_center.cc_call_center_sk WHERE cc_country = 'United States' GROUP BY cc_call_center_id HAVING COUNT(cr_order_number) > 50 ORDER BY num_returns DESC;
SELECT s_store_name, SUM(ss_net_paid_inc_tax) as total_sales FROM store_sales JOIN store ON store_sales.ss_store_sk = store.s_store_sk WHERE s_city = 'Montezuma' OR s_city = 'Calhoun' OR s_city = 'Edgewood' GROUP BY s_store_name ORDER BY total_sales DESC;
SELECT wp_type, COUNT(wr_order_number) as num_returns FROM web_returns JOIN web_page ON web_returns.wr_web_page_sk = web_page.wp_web_page_sk WHERE wp_creation_date_sk BETWEEN 2450815 AND 2450845 GROUP BY wp_type HAVING COUNT(wr_order_number) > 10 ORDER BY num_returns DESC;