SELECT ca_state, COUNT(*) FROM customer_address WHERE ca_street_type = 'Avenue' GROUP BY ca_state ORDER BY COUNT(*) DESC LIMIT 5;
SELECT c_birth_country, AVG(cd_purchase_estimate) AS avg_purchase_estimate FROM customer JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE c_birth_month = 10 GROUP BY c_birth_country ORDER BY avg_purchase_estimate DESC;
SELECT i_category, SUM(ss_sales_price) AS total_sales FROM store_sales JOIN item ON ss_item_sk = i_item_sk GROUP BY i_category ORDER BY total_sales DESC LIMIT 10;
SELECT w_state, COUNT(*) AS num_warehouses FROM warehouse WHERE w_country = 'United States' GROUP BY w_state HAVING COUNT(*) > 1 ORDER BY num_warehouses DESC;
SELECT p_promo_name, SUM(cs_sales_price) AS total_sales FROM catalog_sales JOIN promotion ON cs_promo_sk = p_promo_sk WHERE p_discount_active = 'N' AND p_response_target = 1 GROUP BY p_promo_name ORDER BY total_sales DESC LIMIT 5;
SELECT web_page.wp_type, COUNT(*) AS num_web_sales FROM web_sales JOIN web_page ON ws_web_page_sk = wp_web_page_sk WHERE wp_autogen_flag = 'Y' GROUP BY wp_type ORDER BY num_web_sales DESC;
SELECT s_state, SUM(ss_net_profit) AS total_net_profit FROM store_sales JOIN store ON ss_store_sk = s_store_sk WHERE ss_sold_date_sk BETWEEN 2450745 AND 2450789 GROUP BY s_state ORDER BY total_net_profit DESC;
SELECT c_birth_country, COUNT(*) AS num_customers FROM customer WHERE c_birth_year > 1980 AND c_email_address LIKE '%.com' GROUP BY c_birth_country HAVING COUNT(*) > 100 ORDER BY num_customers DESC;
SELECT i_brand, i_category, SUM(inv_quantity_on_hand) AS total_inventory FROM inventory JOIN item ON inv_item_sk = i_item_sk WHERE inv_date_sk = (SELECT MAX(inv_date_sk) FROM inventory) GROUP BY i_brand, i_category ORDER BY total_inventory DESC LIMIT 10;