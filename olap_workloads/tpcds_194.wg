SELECT hd_demo_sk, AVG(inv_quantity_on_hand) AS average_quantity_on_hand FROM household_demographics JOIN inventory ON household_demographics.hd_demo_sk = inventory.inv_item_sk WHERE hd_buy_potential = '5001-10000' AND hd_dep_count = 4 GROUP BY hd_demo_sk HAVING AVG(inv_quantity_on_hand) > 500;
SELECT ws_bill_hdemo_sk, COUNT(*) AS num_orders, SUM(ws_ext_ship_cost) AS total_ship_cost FROM web_sales WHERE ws_web_page_sk = 30 AND ws_ext_ship_cost > 300 GROUP BY ws_bill_hdemo_sk HAVING COUNT(*) > 5 ORDER BY total_ship_cost DESC;
SELECT s_store_sk, s_store_name, SUM(ss_sales_price) AS total_sales FROM store_sales JOIN store ON store_sales.ss_store_sk = store.s_store_sk WHERE ss_sold_date_sk BETWEEN 100 AND 200 GROUP BY s_store_sk, s_store_name ORDER BY total_sales DESC;
SELECT i_item_sk, i_item_desc, SUM(ss_quantity) AS total_quantity_sold FROM store_sales JOIN item ON store_sales.ss_item_sk = item.i_item_sk WHERE ss_sold_date_sk BETWEEN 100 AND 200 GROUP BY i_item_sk, i_item_desc HAVING SUM(ss_quantity) > 50 ORDER BY total_quantity_sold DESC;
SELECT hd_demo_sk, COUNT(*) AS num_customers FROM household_demographics JOIN customer ON household_demographics.hd_demo_sk = customer.c_current_hdemo_sk WHERE hd_buy_potential = '5001-10000' AND hd_dep_count = 4 GROUP BY hd_demo_sk HAVING COUNT(*) > 10 ORDER BY num_customers DESC;
SELECT w_warehouse_sk, w_warehouse_name, SUM(inv_quantity_on_hand) AS total_quantity_on_hand FROM warehouse JOIN inventory ON warehouse.w_warehouse_sk = inventory.inv_warehouse_sk WHERE w_warehouse_sk = 1 GROUP BY w_warehouse_sk, w_warehouse_name;
SELECT p_promo_sk, p_promo_name, COUNT(*) AS num_orders FROM promotion JOIN store_sales ON promotion.p_promo_sk = store_sales.ss_promo_sk WHERE p_start_date_sk BETWEEN 100 AND 200 GROUP BY p_promo_sk, p_promo_name HAVING COUNT(*) > 10 ORDER BY num_orders DESC;