SELECT s.s_store_name, s.s_city, s.s_state, SUM(ss.ss_net_profit) AS total_profit FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk WHERE s.s_state = 'TN' AND ss.ss_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 2021) GROUP BY s.s_store_name, s.s_city, s.s_state ORDER BY total_profit DESC LIMIT 10;
SELECT c.c_salutation, c.c_first_name, c.c_last_name, COUNT(ss.ss_ticket_number) AS total_orders, SUM(ss.ss_net_paid) AS total_paid FROM store_sales ss JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk WHERE cd.cd_purchase_estimate >= 1000 AND cd.cd_purchase_estimate <= 2500 AND cd.cd_dep_employed_count = 0 AND cd.cd_dep_college_count = 0 GROUP BY c.c_salutation, c.c_first_name, c.c_last_name ORDER BY total_paid DESC LIMIT 10;