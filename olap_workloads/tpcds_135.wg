SELECT s_state, COUNT(*) AS total_sales FROM store_sales JOIN store ON store_sales.ss_store_sk = store.s_store_sk GROUP BY s_state ORDER BY total_sales DESC;
SELECT ws.ws_item_sk, i.i_category, SUM(ws.ws_sales_price) AS total_sales FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk WHERE ws.ws_bill_cdemo_sk IN ('1603603', '70390', '797867') GROUP BY ws.ws_item_sk, i.i_category ORDER BY total_sales DESC LIMIT 10;
SELECT cr.cr_refunded_customer_sk, COUNT(*) AS total_refunds FROM catalog_returns cr WHERE cr.cr_returning_cdemo_sk IN ('794543', '511666', '281933') AND cr.cr_refunded_customer_sk IN ('57876', '6397', '9658') GROUP BY cr.cr_refunded_customer_sk ORDER BY total_refunds DESC;
SELECT web_site.web_street_type, web_site.web_country, SUM(web_sales.ws_wholesale_cost) AS total_wholesale_cost FROM web_sales JOIN web_site ON web_sales.ws_web_site_sk = web_site.web_site_sk WHERE web_site.web_street_type IN ('Road', 'Ct.', 'Wy') AND web_site.web_country = 'United States' GROUP BY web_site.web_street_type, web_site.web_country ORDER BY total_wholesale_cost DESC;
SELECT store.s_state, AVG(store_sales.ss_wholesale_cost) AS avg_wholesale_cost FROM store_sales JOIN store ON store_sales.ss_store_sk = store.s_store_sk WHERE store_sales.ss_cdemo_sk IN ('403645', '642327', '1120018') GROUP BY store.s_state ORDER BY avg_wholesale_cost DESC;