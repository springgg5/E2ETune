SELECT s.s_store_name, COUNT(ss.ss_ticket_number) AS total_sales, AVG(ss.ss_sales_price) AS avg_sales_price FROM store_sales ss INNER JOIN store s ON ss.ss_store_sk = s.s_store_sk WHERE s.s_market_desc = 'Architects coul' GROUP BY s.s_store_name ORDER BY total_sales DESC, avg_sales_price DESC LIMIT 10;
SELECT i.i_category_id, i.i_category, COUNT(ws.ws_order_number) AS total_orders, SUM(ws.ws_ext_list_price) AS total_list_price FROM web_sales ws INNER JOIN item i ON ws.ws_item_sk = i.i_item_sk WHERE ws.ws_ship_mode_sk = 14 AND ws.ws_ship_customer_sk = 42663 GROUP BY i.i_category_id, i.i_category ORDER BY total_orders DESC, total_list_price DESC;
SELECT w.w_warehouse_name, SUM(inv.inv_quantity_on_hand) AS total_inventory FROM inventory inv INNER JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk WHERE w.w_country = 'United States' GROUP BY w.w_warehouse_name HAVING SUM(inv.inv_quantity_on_hand) > 1000 ORDER BY total_inventory DESC;
SELECT c.c_first_name, c.c_last_name, SUM(cs.cs_net_paid_inc_tax) AS total_spent FROM catalog_sales cs INNER JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk WHERE cs.cs_ship_date_sk BETWEEN (SELECT d_date_sk FROM date_dim WHERE d_date = '2003-01-01') AND (SELECT d_date_sk FROM date_dim WHERE d_date = '2003-12-31') GROUP BY c.c_first_name, c.c_last_name HAVING SUM(cs.cs_net_paid_inc_tax) > 1000 ORDER BY total_spent DESC LIMIT 10;