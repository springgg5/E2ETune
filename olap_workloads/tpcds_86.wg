SELECT c_customer_id, COUNT(ss_ticket_number) as total_sales FROM customer INNER JOIN store_sales ON c_customer_sk = ss_customer_sk WHERE c_current_cdemo_sk IN (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'M' AND cd_dep_college_count = 0 AND cd_dep_count = 0) GROUP BY c_customer_id ORDER BY total_sales DESC LIMIT 10;
SELECT i_manufact, AVG(i_current_price) as avg_price FROM item WHERE i_item_sk IN (255, 294, 881) GROUP BY i_manufact;
SELECT cc_city, COUNT(cc_call_center_sk) as call_center_count FROM call_center WHERE cc_street_number IN ('984', '730', '463') AND cc_street_type IN ('RD', 'Boulevard', 'Way') GROUP BY cc_city;
SELECT d_year, d_month_seq, SUM(ss_sales_price) as total_sales FROM store_sales INNER JOIN date_dim ON ss_sold_date_sk = d_date_sk GROUP BY d_year, d_month_seq ORDER BY d_year, d_month_seq;
SELECT w_warehouse_name, SUM(inv_quantity_on_hand) as total_inventory FROM inventory INNER JOIN warehouse ON inv_warehouse_sk = w_warehouse_sk GROUP BY w_warehouse_name ORDER BY total_inventory DESC;
SELECT s_store_name, COUNT(sr_ticket_number) as total_returns FROM store INNER JOIN store_returns ON s_store_sk = sr_store_sk WHERE sr_reason_sk IN (SELECT r_reason_sk FROM reason WHERE r_reason_desc LIKE '%damaged%') GROUP BY s_store_name ORDER BY total_returns DESC;
SELECT p_promo_name, SUM(cs_sales_price) as total_sales FROM catalog_sales INNER JOIN promotion ON cs_promo_sk = p_promo_sk WHERE cs_ship_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy = 12) GROUP BY p_promo_name ORDER BY total_sales DESC;
SELECT web_name, COUNT(ws_order_number) as total_orders FROM web_site INNER JOIN web_sales ON web_site_sk = ws_web_site_sk WHERE ws_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 2002 AND d_qoy = 1) GROUP BY web_name ORDER BY total_orders DESC;
SELECT t_hour, COUNT(sr_ticket_number) as total_returns FROM store_returns INNER JOIN time_dim ON sr_return_time_sk = t_time_sk WHERE sr_reason_sk IN (SELECT r_reason_sk FROM reason WHERE r_reason_desc LIKE '%incorrect%') GROUP BY t_hour ORDER BY total_returns DESC;
SELECT hd_buy_potential, COUNT(c_customer_id) as total_customers FROM customer INNER JOIN household_demographics ON c_current_hdemo_sk = hd_demo_sk WHERE hd_income_band_sk IN (SELECT ib_income_band_sk FROM income_band WHERE ib_lower_bound >= 50000 AND ib_upper_bound <= 100000) GROUP BY hd_buy_potential ORDER BY total_customers DESC;