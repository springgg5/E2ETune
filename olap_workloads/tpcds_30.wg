SELECT s_store_name, SUM(ss_net_profit) AS total_profit FROM store_sales JOIN store ON ss_store_sk = s_store_sk WHERE ss_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_following_holiday = 'Y') GROUP BY s_store_name ORDER BY total_profit DESC LIMIT 10;
SELECT i_item_id, i_category, SUM(ws_sales_price) AS total_sales FROM web_sales JOIN item ON ws_item_sk = i_item_sk WHERE ws_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_same_day_ly = 2415417) GROUP BY i_item_id, i_category ORDER BY total_sales DESC LIMIT 10;
SELECT ca_city, ca_state, COUNT(sr_item_sk) AS total_returns FROM store_returns JOIN customer_address ON sr_addr_sk = ca_address_sk WHERE sr_store_sk IN (10, 2, 1) GROUP BY ca_city, ca_state ORDER BY total_returns DESC;
SELECT d_date, SUM(sr_refunded_cash) AS total_refunded_cash FROM store_returns JOIN date_dim ON sr_returned_date_sk = d_date_sk WHERE sr_item_sk IN (4996, 12803, 14047) GROUP BY d_date ORDER BY total_refunded_cash DESC LIMIT 10;
SELECT COUNT(*) AS total_holidays FROM date_dim WHERE d_following_holiday = 'Y';
SELECT i_item_id, i_category, AVG(inv_quantity_on_hand) AS avg_inventory FROM inventory JOIN item ON inv_item_sk = i_item_sk GROUP BY i_item_id, i_category HAVING AVG(inv_quantity_on_hand) > 1000 ORDER BY avg_inventory DESC;
SELECT p_promo_name, COUNT(cs_order_number) AS total_orders FROM catalog_sales JOIN promotion ON cs_promo_sk = p_promo_sk WHERE cs_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_same_day_ly = 2415366) GROUP BY p_promo_name ORDER BY total_orders DESC;
SELECT w_warehouse_name, SUM(inv_quantity_on_hand) AS total_inventory FROM inventory JOIN warehouse ON inv_warehouse_sk = w_warehouse_sk GROUP BY w_warehouse_name ORDER BY total_inventory DESC;
SELECT sm_carrier, COUNT(cr_order_number) AS total_returns FROM catalog_returns JOIN ship_mode ON cr_ship_mode_sk = sm_ship_mode_sk WHERE cr_returned_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_same_day_ly = 2415332) GROUP BY sm_carrier ORDER BY total_returns DESC;