SELECT o_orderpriority, COUNT(*) AS num_orders FROM orders WHERE o_orderstatus = 'F' GROUP BY o_orderpriority ORDER BY o_orderpriority;
SELECT s_name, s_phone, SUM(ps_availqty) AS total_avail_qty FROM supplier JOIN partsupp ON s_suppkey = ps_suppkey WHERE s_suppkey IN (543, 198, 717) GROUP BY s_name, s_phone;
SELECT l_shipmode, AVG(l_quantity) AS avg_quantity FROM lineitem WHERE l_orderkey IN (115011, 115362, 114692) GROUP BY l_shipmode;
SELECT c_mktsegment, COUNT(DISTINCT c_custkey) AS num_customers FROM customer WHERE c_acctbal > 5000 GROUP BY c_mktsegment;
SELECT r_name, COUNT(n_nationkey) AS num_nations FROM region JOIN nation ON r_regionkey = n_regionkey GROUP BY r_name;
SELECT p_type, p_size, COUNT(*) AS num_parts FROM part WHERE p_retailprice BETWEEN 100 AND 200 GROUP BY p_type, p_size ORDER BY p_type, p_size;
SELECT n_name, SUM(l_extendedprice * (1 - l_discount)) AS revenue FROM nation JOIN customer ON n_nationkey = c_nationkey JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey WHERE l_shipdate >= '1995-01-01' AND l_shipdate < '1996-01-01' GROUP BY n_name ORDER BY revenue DESC;
SELECT s_name, s_address, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue FROM supplier JOIN lineitem ON s_suppkey = l_suppkey WHERE l_shipdate >= '1995-01-01' AND l_shipdate < '1996-01-01' GROUP BY s_name, s_address HAVING SUM(l_extendedprice * (1 - l_discount)) > 1000000 ORDER BY total_revenue DESC;
SELECT p_name, p_brand, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue FROM part JOIN lineitem ON p_partkey = l_partkey WHERE l_shipdate >= '1995-01-01' AND l_shipdate < '1996-01-01' AND l_quantity IN (9.00, 25.00, 31.00) GROUP BY p_name, p_brand HAVING SUM(l_extendedprice * (1 - l_discount)) > 1000000 ORDER BY total_revenue DESC;
SELECT c_name, c_address, SUM(o_totalprice) AS total_spent FROM customer JOIN orders ON c_custkey = o_custkey WHERE o_orderstatus = 'F' GROUP BY c_name, c_address HAVING SUM(o_totalprice) > 100000 ORDER BY total_spent DESC;