SELECT t.title, COUNT(cast_info.person_id) AS num_actors FROM title AS t JOIN cast_info ON t.id = cast_info.movie_id WHERE t.production_year >= 2000 AND t.kind_id = (SELECT id FROM kind_type WHERE kind = 'movie') GROUP BY t.title HAVING COUNT(cast_info.person_id) > 10 ORDER BY num_actors DESC;
SELECT k.keyword, COUNT(mk.movie_id) AS num_movies FROM keyword AS k JOIN movie_keyword AS mk ON k.id = mk.keyword_id WHERE k.phonetic_code IN ('K2', 'D15', 'M2613') GROUP BY k.keyword HAVING COUNT(mk.movie_id) > 5 ORDER BY num_movies DESC;
SELECT t.title, AVG(mi.info::numeric) AS avg_rating FROM title AS t JOIN movie_info AS mi ON t.id = mi.movie_id WHERE t.production_year >= 2000 AND t.kind_id = (SELECT id FROM kind_type WHERE kind = 'movie') AND mi.info_type_id = (SELECT id FROM info_type WHERE info = 'rating') GROUP BY t.title HAVING AVG(mi.info::numeric) > 7.0 ORDER BY avg_rating DESC;
SELECT n.name, COUNT(ci.movie_id) AS num_movies FROM name AS n JOIN cast_info AS ci ON n.id = ci.person_id WHERE ci.role_id = (SELECT id FROM role_type WHERE role = 'actor') AND n.gender = 'M' GROUP BY n.name HAVING COUNT(ci.movie_id) > 20 ORDER BY num_movies DESC;
SELECT t.title, COUNT(ml.linked_movie_id) AS num_linked_movies FROM title AS t JOIN movie_link AS ml ON t.id = ml.movie_id WHERE ml.link_type_id IN (SELECT id FROM link_type WHERE link IN ('alternate language version of', 'version of', 'edited from')) GROUP BY t.title HAVING COUNT(ml.linked_movie_id) > 5 ORDER BY num_linked_movies DESC;