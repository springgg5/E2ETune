SELECT s.s_nation, d.d_monthnuminyear, SUM(lo.lo_revenue) AS total_revenue FROM lineorder lo JOIN supplier s ON lo.lo_suppkey = s.s_suppkey JOIN date_dim d ON lo.lo_orderdate = d.d_datekey WHERE s.s_nation IN ('FRANCE', 'JORDAN', 'IRAQ') AND d.d_monthnuminyear IN (11, 1, 3) GROUP BY s.s_nation, d.d_monthnuminyear ORDER BY s.s_nation, d.d_monthnuminyear;
SELECT c.c_mktsegment, d.d_yearmonthnum, COUNT(lo.lo_orderkey) AS total_orders FROM lineorder lo JOIN customer c ON lo.lo_custkey = c.c_custkey JOIN date_dim d ON lo.lo_orderdate = d.d_datekey WHERE d.d_yearmonthnum IN (199303, 199307, 199407) AND d.d_weekdayfl = '1' GROUP BY c.c_mktsegment, d.d_yearmonthnum ORDER BY c.c_mktsegment, d.d_yearmonthnum;
SELECT p.p_category, d.d_year, AVG(lo.lo_quantity) AS avg_quantity FROM lineorder lo JOIN part p ON lo.lo_partkey = p.p_partkey JOIN date_dim d ON lo.lo_orderdate = d.d_datekey WHERE d.d_daynuminweek IN (4, 7, 1) GROUP BY p.p_category, d.d_year ORDER BY p.p_category, d.d_year;
SELECT s.s_city, COUNT(lo.lo_orderkey) AS total_orders FROM lineorder lo JOIN supplier s ON lo.lo_suppkey = s.s_suppkey WHERE s.s_city IN ('VIETNAM  6', 'MOZAMBIQU6', 'MOROCCO  5') GROUP BY s.s_city ORDER BY s.s_city;
SELECT c.c_nation, d.d_year, SUM(lo.lo_supplycost) AS total_supply_cost FROM lineorder lo JOIN customer c ON lo.lo_custkey = c.c_custkey JOIN date_dim d ON lo.lo_orderdate = d.d_datekey WHERE d.d_year >= 1993 AND d.d_year <= 1997 GROUP BY c.c_nation, d.d_year HAVING SUM(lo.lo_supplycost) > 1000000 ORDER BY c.c_nation, d.d_year;
SELECT p.p_brand, d.d_year, COUNT(lo.lo_orderkey) AS total_orders, SUM(lo.lo_extendedprice) AS total_extended_price FROM lineorder lo JOIN part p ON lo.lo_partkey = p.p_partkey JOIN date_dim d ON lo.lo_orderdate = d.d_datekey WHERE d.d_year >= 1993 AND d.d_year <= 1997 GROUP BY p.p_brand, d.d_year HAVING COUNT(lo.lo_orderkey) > 1000 ORDER BY p.p_brand, d.d_year;