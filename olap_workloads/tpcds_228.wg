SELECT s.s_city, AVG(ss.ss_net_profit) as avg_net_profit FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk WHERE s.s_country = 'United States' AND s.s_city IN ('Fairview', 'Midway') GROUP BY s.s_city;
SELECT ib.ib_income_band_sk, COUNT(c.c_customer_sk) as num_customers FROM customer c JOIN income_band ib ON c.c_current_cdemo_sk = ib.ib_income_band_sk WHERE ib.ib_upper_bound IN (120000, 150000, 30000) AND ib.ib_lower_bound IN (120001, 130001, 180001) GROUP BY ib.ib_income_band_sk;
SELECT i.i_item_id, i.i_category, SUM(inv.inv_quantity_on_hand) as total_inventory FROM inventory inv JOIN item i ON inv.inv_item_sk = i.i_item_sk GROUP BY i.i_item_id, i.i_category HAVING SUM(inv.inv_quantity_on_hand) > 1000 ORDER BY total_inventory DESC;
SELECT d.d_year, d.d_month_seq, COUNT(DISTINCT cs.cs_order_number) as num_orders FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cs.cs_wholesale_cost > 100 AND cs.cs_sales_price < 200 GROUP BY d.d_year, d.d_month_seq ORDER BY d.d_year ASC, d.d_month_seq ASC;