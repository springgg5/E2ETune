SELECT t.title, COUNT(c.id) AS cast_count FROM title t JOIN cast_info c ON t.id = c.movie_id WHERE t.production_year >= 2000 AND t.production_year <= 2020 GROUP BY t.title HAVING COUNT(c.id) > 10 ORDER BY COUNT(c.id) DESC;
SELECT k.keyword, COUNT(mk.movie_id) AS movie_count FROM keyword k JOIN movie_keyword mk ON k.id = mk.keyword_id GROUP BY k.keyword ORDER BY movie_count DESC LIMIT 10;
SELECT cn.name, COUNT(ci.id) AS character_count FROM char_name cn JOIN cast_info ci ON cn.id = ci.person_role_id WHERE ci.role_id = 1 GROUP BY cn.name HAVING COUNT(ci.id) > 5 ORDER BY character_count DESC;
SELECT t.title, AVG(ci.nr_order) AS average_order FROM title t JOIN cast_info ci ON t.id = ci.movie_id WHERE t.kind_id = 1 AND ci.role_id = 1 GROUP BY t.title HAVING COUNT(ci.id) > 10 ORDER BY average_order ASC;
SELECT ct.kind, COUNT(cc.id) AS company_count FROM company_type ct JOIN movie_companies mc ON ct.id = mc.company_type_id JOIN complete_cast cc ON mc.movie_id = cc.movie_id GROUP BY ct.kind ORDER BY company_count DESC;
SELECT n.name, COUNT(ci.id) AS movie_count FROM name n JOIN cast_info ci ON n.id = ci.person_id WHERE ci.role_id = 1 AND ci.movie_id IN (SELECT movie_id FROM movie_link WHERE link_type_id = 2) GROUP BY n.name ORDER BY movie_count DESC;
SELECT t.title, COUNT(k.id) AS keyword_count FROM title t JOIN movie_keyword mk ON t.id = mk.movie_id JOIN keyword k ON mk.keyword_id = k.id WHERE t.production_year = 2020 GROUP BY t.title HAVING COUNT(k.id) > 5 ORDER BY keyword_count DESC;
SELECT t.title, COUNT(ml.id) AS link_count FROM title t JOIN movie_link ml ON t.id = ml.movie_id WHERE ml.link_type_id = 13 AND t.production_year >= 2000 AND t.production_year <= 2020 GROUP BY t.title HAVING COUNT(ml.id) > 1 ORDER BY link_count DESC;
SELECT t.title, COUNT(ml.id) AS link_count FROM title t JOIN movie_link ml ON t.id = ml.movie_id WHERE ml.linked_movie_id = 1330115 AND ml.link_type_id = 3 GROUP BY t.title HAVING COUNT(ml.id) > 1 ORDER BY link_count DESC;
SELECT t.title, COUNT(ci.id) AS cast_count FROM title t JOIN cast_info ci ON t.id = ci.movie_id WHERE ci.role_id = 1 AND ci.person_role_id IN (208, 226, 116) GROUP BY t.title HAVING COUNT(ci.id) > 5 ORDER BY cast_count DESC;