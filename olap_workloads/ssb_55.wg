SELECT c.c_name, SUM(lo.lo_revenue) as total_revenue FROM customer c JOIN lineorder lo ON c.c_custkey = lo.lo_custkey WHERE lo.lo_orderdate >= 20210101 AND lo.lo_orderdate <= 20211231 GROUP BY c.c_name HAVING SUM(lo.lo_revenue) > 1000000 ORDER BY total_revenue DESC;
SELECT p.p_name, p.p_color, p.p_type, p.p_size, COUNT(lo.lo_partkey) as order_count, SUM(lo.lo_quantity) as total_quantity, AVG(lo.lo_extendedprice) as avg_price FROM part p JOIN lineorder lo ON p.p_partkey = lo.lo_partkey WHERE p.p_partkey IN (764, 163, 334) AND p.p_color IN ('almond', 'deep', 'khaki') AND p.p_type IN ('STANDARD PLATED TIN', 'SMALL ANODIZED NICKEL', 'MEDIUM ANODIZED NICKEL') AND p.p_size IN (37, 21, 2) GROUP BY p.p_name, p.p_color, p.p_type, p.p_size ORDER BY order_count DESC;
SELECT s.s_name, s.s_suppkey, COUNT(lo.lo_suppkey) as order_count, SUM(lo.lo_supplycost) as total_supply_cost, AVG(lo.lo_tax) as avg_tax FROM supplier s JOIN lineorder lo ON s.s_suppkey = lo.lo_suppkey WHERE s.s_suppkey IN (897, 835, 488) AND s.s_name IN ('Supplier#000000250', 'Supplier#000000257', 'Supplier#000000973') GROUP BY s.s_name, s.s_suppkey HAVING COUNT(lo.lo_suppkey) > 10 ORDER BY total_supply_cost DESC;