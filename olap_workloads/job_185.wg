SELECT t.id, t.title, t.production_year, COUNT(c.id) AS cast_count FROM title t JOIN cast_info c ON t.id = c.movie_id WHERE t.kind_id = 2 AND t.production_year >= 2000 GROUP BY t.id, t.title, t.production_year HAVING COUNT(c.id) > 10 ORDER BY t.production_year DESC, COUNT(c.id) DESC;
SELECT kt.kind, COUNT(t.id) AS movie_count FROM title t JOIN kind_type kt ON t.kind_id = kt.id WHERE t.production_year BETWEEN 1975 AND 1983 AND kt.kind IN ('tv movie', 'movie', 'tv series') GROUP BY kt.kind ORDER BY movie_count DESC;
SELECT n.name, COUNT(ci.id) AS roles_count FROM name n JOIN cast_info ci ON n.id = ci.person_id WHERE ci.role_id = 1 AND n.gender = 'F' GROUP BY n.name HAVING COUNT(ci.id) > 50 ORDER BY roles_count DESC;
SELECT t.title, t.production_year, COUNT(mk.id) AS keyword_count FROM title t JOIN movie_keyword mk ON t.id = mk.movie_id WHERE t.production_year = 2011 AND t.kind_id = 7 GROUP BY t.title, t.production_year HAVING COUNT(mk.id) > 5 ORDER BY keyword_count DESC;
SELECT t.title, AVG(ci.nr_order) AS avg_order FROM title t JOIN cast_info ci ON t.id = ci.movie_id WHERE t.episode_of_id IN (62082, 99529, 63198) AND ci.role_id = 1 GROUP BY t.title HAVING AVG(ci.nr_order) > 5 ORDER BY avg_order DESC;
SELECT it.info, COUNT(mi.id) AS movie_info_count FROM info_type it JOIN movie_info mi ON it.id = mi.info_type_id WHERE it.id IN (99, 35, 105) AND mi.note IS NOT NULL GROUP BY it.info ORDER BY movie_info_count DESC;
SELECT n.name, COUNT(pi.id) AS person_info_count FROM name n JOIN person_info pi ON n.id = pi.person_id WHERE pi.info_type_id = 35 AND n.gender = 'M' GROUP BY n.name HAVING COUNT(pi.id) > 10 ORDER BY person_info_count DESC;
SELECT cn.name, COUNT(mc.id) AS movie_count FROM company_name cn JOIN movie_companies mc ON cn.id = mc.company_id WHERE mc.company_type_id = 5 GROUP BY cn.name HAVING COUNT(mc.id) > 100 ORDER BY movie_count DESC;
SELECT t.title, COUNT(ml.id) AS movie_link_count FROM title t JOIN movie_link ml ON t.id = ml.movie_id WHERE t.kind_id = 3 AND t.production_year = 2011 GROUP BY t.title HAVING COUNT(ml.id) > 5 ORDER BY movie_link_count DESC;