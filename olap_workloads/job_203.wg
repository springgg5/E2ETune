SELECT t.title, COUNT(c.id) AS total_cast, AVG(c.nr_order) AS avg_order FROM title AS t JOIN cast_info AS c ON t.id = c.movie_id WHERE t.production_year >= 2000 AND t.production_year <= 2010 GROUP BY t.title HAVING COUNT(c.id) > 10 ORDER BY total_cast DESC, avg_order ASC LIMIT 10;
SELECT cn.name, COUNT(ci.id) AS total_characters FROM char_name AS cn JOIN cast_info AS ci ON cn.id = ci.person_role_id WHERE cn.surname_pcode IN ('J2', 'L24', 'C262') GROUP BY cn.name HAVING COUNT(ci.id) > 5 ORDER BY total_characters DESC LIMIT 10;
SELECT lt.link, COUNT(ml.id) AS total_links FROM movie_link AS ml JOIN link_type AS lt ON ml.link_type_id = lt.id WHERE lt.id IN (4, 1, 15) GROUP BY lt.link HAVING COUNT(ml.id) > 10 ORDER BY total_links DESC LIMIT 5;
SELECT n.name, COUNT(pi.id) AS total_info FROM name AS n JOIN person_info AS pi ON n.id = pi.person_id WHERE n.gender = 'F' AND pi.info_type_id = 2 GROUP BY n.name HAVING COUNT(pi.id) > 5 ORDER BY total_info DESC LIMIT 10;
SELECT t.title, COUNT(mi.id) AS total_info FROM title AS t JOIN movie_info AS mi ON t.id = mi.movie_id WHERE t.kind_id = 1 AND mi.info_type_id = 3 GROUP BY t.title HAVING COUNT(mi.id) > 10 ORDER BY total_info DESC LIMIT 10;
SELECT cc.kind, COUNT(cc.id) AS total_companies FROM comp_cast_type AS cc JOIN complete_cast AS c ON cc.id = c.subject_id WHERE c.status_id IN (4, 3) AND c.id IN (757, 860, 171) GROUP BY cc.kind HAVING COUNT(cc.id) > 5 ORDER BY total_companies DESC LIMIT 5;