SELECT r.r_name, n.n_name, COUNT(o.o_orderkey) AS total_orders, SUM(o.o_totalprice) AS total_revenue FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey WHERE r.r_name = 'EUROPE' AND o.o_orderdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY r.r_name, n.n_name ORDER BY total_revenue DESC;
SELECT p.p_brand, p.p_type, COUNT(l.l_orderkey) AS total_lineitems, AVG(l.l_quantity) AS avg_quantity, AVG(l.l_extendedprice) AS avg_extendedprice FROM part p JOIN lineitem l ON p.p_partkey = l.l_partkey WHERE p.p_brand IN ('Brand#42', 'Brand#33', 'Brand#23') AND p.p_mfgr = 'Manufacturer#5' AND l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY p.p_brand, p.p_type ORDER BY total_lineitems DESC;
SELECT s.s_name, n.n_name, SUM(ps.ps_availqty) AS total_availqty, AVG(ps.ps_supplycost) AS avg_supplycost FROM supplier s JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN nation n ON s.s_nationkey = n.n_nationkey WHERE n.n_name IN ('ARGENTINA', 'UNITED KINGDOM', 'PERU') GROUP BY s.s_name, n.n_name HAVING SUM(ps.ps_availqty) > 1000 ORDER BY total_availqty DESC, avg_supplycost ASC;