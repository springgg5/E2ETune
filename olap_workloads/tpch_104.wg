SELECT n_name, r_name, COUNT(c_custkey) AS num_customers, AVG(c_acctbal) AS avg_acctbal FROM customer c JOIN nation n ON c.c_nationkey = n.n_nationkey JOIN region r ON n.n_regionkey = r.r_regionkey WHERE n.n_name IN ('KENYA', 'RUSSIA', 'ROMANIA') GROUP BY n_name, r_name ORDER BY num_customers DESC, avg_acctbal DESC;
SELECT s_name, s_address, p_name, p_type, SUM(ps_availqty) AS total_availqty, AVG(ps_supplycost) AS avg_supplycost FROM partsupp ps JOIN supplier s ON ps.ps_suppkey = s.s_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey WHERE s.s_suppkey IN (333, 203, 835) AND s.s_nationkey IN (4, 10, 5) GROUP BY s_name, s_address, p_name, p_type ORDER BY total_availqty DESC, avg_supplycost ASC;
SELECT o_orderpriority, COUNT(o_orderkey) AS num_orders, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue FROM orders o JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE o.o_orderstatus = 'F' AND l.l_shipdate >= o.o_orderdate AND l.l_shipdate <= o.o_orderdate + INTERVAL '3 months' GROUP BY o_orderpriority ORDER BY total_revenue DESC, num_orders DESC;