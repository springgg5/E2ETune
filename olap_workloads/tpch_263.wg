SELECT p.p_type, COUNT(*) as num_parts, AVG(p.p_retailprice) as avg_retail_price FROM part p GROUP BY p.p_type HAVING COUNT(*) > 10 ORDER BY avg_retail_price DESC;
SELECT s.s_name, SUM(ps.ps_availqty) as total_avail_qty FROM supplier s JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey WHERE s.s_comment LIKE '%daringly bol%' GROUP BY s.s_name ORDER BY total_avail_qty DESC;
SELECT c.c_mktsegment, COUNT(o.o_orderkey) as num_orders, SUM(o.o_totalprice) as total_revenue FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey WHERE o.o_orderstatus = 'F' GROUP BY c.c_mktsegment ORDER BY total_revenue DESC;
SELECT r.r_name, COUNT(n.n_nationkey) as num_nations FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey GROUP BY r.r_name ORDER BY num_nations DESC;
SELECT l.l_returnflag, COUNT(*) as num_lineitems, SUM(l.l_extendedprice) as total_extended_price FROM lineitem l WHERE l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY l.l_returnflag ORDER BY total_extended_price DESC;
SELECT o.o_orderpriority, COUNT(*) as num_orders, AVG(o.o_totalprice) as avg_order_price FROM orders o WHERE o.o_orderdate BETWEEN '1996-01-01' AND '1996-12-31' GROUP BY o.o_orderpriority ORDER BY avg_order_price DESC;
SELECT p.p_mfgr, COUNT(DISTINCT ps.ps_suppkey) as num_unique_suppliers FROM part p JOIN partsupp ps ON p.p_partkey = ps.ps_partkey WHERE p.p_type LIKE '%BRUSHED%' GROUP BY p.p_mfgr ORDER BY num_unique_suppliers DESC;
SELECT n.n_name, COUNT(DISTINCT c.c_custkey) as num_customers, SUM(c.c_acctbal) as total_acct_balance FROM nation n JOIN customer c ON n.n_nationkey = c.c_nationkey GROUP BY n.n_name ORDER BY total_acct_balance DESC;
SELECT t1.region_name, COUNT(*) as num_orders FROM (SELECT r.r_name as region_name, o.o_orderkey as order_key FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey) as t1 GROUP BY t1.region_name ORDER BY num_orders DESC;