SELECT c_name, c_city, SUM(lo_extendedprice * lo_discount) as revenue FROM customer JOIN lineorder ON c_custkey = lo_custkey WHERE lo_orderdate >= 19940101 AND lo_orderdate <= 19941231 GROUP BY c_name, c_city ORDER BY revenue DESC;
SELECT p_name, p_brand, COUNT(*) as num_orders FROM part JOIN lineorder ON p_partkey = lo_partkey WHERE lo_shipmode = 'MAIL' AND p_container = 'JUMBO CAN' GROUP BY p_name, p_brand ORDER BY num_orders DESC;
SELECT d_year, d_month, SUM(lo_revenue - lo_supplycost) as profit FROM date_dim JOIN lineorder ON d_datekey = lo_orderdate WHERE lo_orderpriority = '1-URGENT' OR lo_orderpriority = '2-HIGH' GROUP BY d_year, d_month ORDER BY d_year, d_month;
SELECT c_mktsegment, d_year, SUM(lo_extendedprice * lo_discount) as revenue FROM customer JOIN lineorder ON c_custkey = lo_custkey JOIN date_dim ON lo_orderdate = d_datekey WHERE c_mktsegment = 'AUTOMOBILE' GROUP BY c_mktsegment, d_year ORDER BY d_year;
SELECT p_category, AVG(p_size) as avg_size FROM part WHERE p_color = 'olive rosy' OR p_color = 'medium frosted' OR p_color = 'peach indian' GROUP BY p_category;
SELECT d_year, s_nation, SUM(lo_revenue) as revenue FROM date_dim JOIN lineorder ON d_datekey = lo_orderdate JOIN supplier ON lo_suppkey = s_suppkey WHERE lo_shipmode = 'AIR' AND d_year >= 1995 AND d_year <= 1998 GROUP BY d_year, s_nation ORDER BY d_year, s_nation;
SELECT p_name, p_brand, SUM(lo_quantity) as total_quantity FROM part JOIN lineorder ON p_partkey = lo_partkey WHERE lo_orderkey IN (455, 773, 900) GROUP BY p_name, p_brand ORDER BY total_quantity DESC;
SELECT c_region, d_year, COUNT(DISTINCT lo_orderkey) as num_orders FROM customer JOIN lineorder ON c_custkey = lo_custkey JOIN date_dim ON lo_orderdate = d_datekey WHERE lo_discount >= 5 AND lo_discount <= 10 GROUP BY c_region, d_year ORDER BY c_region, d_year;
SELECT s_region, p_category, SUM(lo_extendedprice * lo_discount) as revenue FROM supplier JOIN lineorder ON s_suppkey = lo_suppkey JOIN part ON lo_partkey = p_partkey WHERE p_container = 'WRAP CAN' GROUP BY s_region, p_category ORDER BY s_region, p_category;