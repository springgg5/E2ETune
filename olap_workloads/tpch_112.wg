SELECT r.r_name, COUNT(*) AS num_nations FROM nation n JOIN region r ON n.n_regionkey = r.r_regionkey GROUP BY r.r_name ORDER BY num_nations DESC;
SELECT s.s_name, SUM(ps.ps_availqty) AS total_avail_qty FROM supplier s JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey WHERE s.s_phone IN ('14-256-573-2660', '17-533-560-8817', '14-471-505-8811') GROUP BY s.s_name ORDER BY total_avail_qty DESC;
SELECT c.c_mktsegment, AVG(c.c_acctbal) AS avg_acctbal FROM customer c WHERE c.c_nationkey IN (3, 12, 14) GROUP BY c.c_mktsegment ORDER BY avg_acctbal DESC;
SELECT p.p_type, COUNT(*) AS num_parts, AVG(p.p_retailprice) AS avg_retailprice FROM part p WHERE p.p_size IN (16, 43, 32) AND p.p_comment LIKE '%%inal gifts. sl%%' GROUP BY p.p_type HAVING COUNT(*) > 1 ORDER BY avg_retailprice DESC;
SELECT n.n_name, SUM(o.o_totalprice) AS total_sales FROM orders o JOIN customer c ON o.o_custkey = c.c_custkey JOIN nation n ON c.c_nationkey = n.n_nationkey WHERE n.n_name IN ('BRAZIL', 'JAPAN', 'UNITED KINGDOM') GROUP BY n.n_name ORDER BY total_sales DESC;
SELECT o.o_orderpriority, COUNT(*) AS num_orders, AVG(o.o_totalprice) AS avg_totalprice FROM orders o WHERE o.o_orderdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY o.o_orderpriority ORDER BY num_orders DESC;
SELECT l.l_returnflag, l.l_linestatus, COUNT(*) AS num_lineitems, SUM(l.l_extendedprice) AS total_extendedprice FROM lineitem l WHERE l.l_shipdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY l.l_returnflag, l.l_linestatus ORDER BY total_extendedprice DESC;
SELECT s.s_name, COUNT(DISTINCT l.l_orderkey) AS num_orders FROM supplier s JOIN lineitem l ON s.s_suppkey = l.l_suppkey WHERE l.l_receiptdate BETWEEN '1995-01-01' AND '1995-12-31' GROUP BY s.s_name HAVING COUNT(DISTINCT l.l_orderkey) > 1 ORDER BY num_orders DESC;