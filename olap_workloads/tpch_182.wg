SELECT o.o_orderpriority, COUNT(*) AS order_count, AVG(o.o_totalprice) AS avg_price FROM orders o JOIN customer c ON o.o_custkey = c.c_custkey WHERE c.c_address = '24Akixb4hqpRD' GROUP BY o.o_orderpriority ORDER BY o.o_orderpriority;
SELECT r.r_name, n.n_name, SUM(s.s_acctbal) AS total_balance FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey WHERE r.r_regionkey = 2 AND s.s_comment LIKE 'sly special sentiments%%' GROUP BY r.r_name, n.n_name ORDER BY total_balance DESC;
SELECT p.p_type, COUNT(*) AS part_count, SUM(ps.ps_availqty) AS total_quantity FROM part p JOIN partsupp ps ON p.p_partkey = ps.ps_partkey JOIN supplier s ON ps.ps_suppkey = s.s_suppkey WHERE s.s_suppkey IN (298, 512, 383) AND p.p_size BETWEEN 10 AND 20 GROUP BY p.p_type ORDER BY total_quantity DESC;
SELECT n.n_name, COUNT(l.l_orderkey) AS order_count, AVG(l.l_extendedprice * (1 - l.l_discount)) AS avg_discounted_price FROM nation n JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE n.n_nationkey IN (6, 11, 14) AND l.l_shipmode = 'AIR' AND l.l_shipdate BETWEEN '1994-01-01' AND '1994-12-31' GROUP BY n.n_name ORDER BY order_count DESC;