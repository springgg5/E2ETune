SELECT i_category, AVG(i_current_price) AS avg_price FROM item WHERE i_manufact_id IN (4, 2, 5) GROUP BY i_category HAVING COUNT(*) > 100 ORDER BY avg_price DESC;
SELECT c_salutation, COUNT(*) AS num_customers FROM customer WHERE c_birth_year BETWEEN 1980 AND 1990 AND c_current_addr_sk IN (SELECT ca_address_sk FROM customer_address WHERE ca_zip IN ('85281', '29275', '74324')) GROUP BY c_salutation;
SELECT r_reason_desc, COUNT(*) AS num_returns FROM store_returns sr INNER JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk WHERE sr.sr_return_amt > 100 GROUP BY r_reason_desc ORDER BY num_returns DESC;
SELECT ws.ws_web_site_sk, ws.ws_item_sk, SUM(ws.ws_net_paid) AS total_paid FROM web_sales ws INNER JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk WHERE w.web_company_id IN ('4', '2', '5') AND w.web_rec_start_date BETWEEN '1997-08-16' AND '2001-08-16' GROUP BY ws.ws_web_site_sk, ws.ws_item_sk ORDER BY total_paid DESC;
SELECT p.p_promo_name, COUNT(*) AS num_promotions FROM catalog_sales cs INNER JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk WHERE cs.cs_sales_price > cs.cs_wholesale_cost GROUP BY p.p_promo_name ORDER BY num_promotions DESC;
SELECT i.i_item_desc, COUNT(*) AS num_sales FROM store_sales ss INNER JOIN item i ON ss.ss_item_sk = i.i_item_sk WHERE ss.ss_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 2000 AND d_moy = 12) GROUP BY i.i_item_desc HAVING COUNT(*) > 10 ORDER BY num_sales DESC;
SELECT ca.ca_city, COUNT(*) AS num_customers FROM customer c INNER JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk WHERE c.c_birth_country = 'United States' AND ca.ca_street_name IN ('4th 14th', 'Mill Third', '12th Lakeview') GROUP BY ca.ca_city ORDER BY num_customers DESC;