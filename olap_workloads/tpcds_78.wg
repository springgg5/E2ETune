SELECT i.i_item_id, SUM(inv.inv_quantity_on_hand) AS total_quantity FROM inventory inv JOIN item i ON inv.inv_item_sk = i.i_item_sk WHERE inv.inv_date_sk = 2450815 AND inv.inv_warehouse_sk = 1 GROUP BY i.i_item_id HAVING SUM(inv.inv_quantity_on_hand) > 400 ORDER BY total_quantity DESC;
SELECT ws.ws_web_page_sk, COUNT(ws.ws_order_number) AS total_orders, SUM(ws.ws_net_paid) AS total_revenue FROM web_sales ws JOIN web_site ws2 ON ws.ws_web_site_sk = ws2.web_site_sk WHERE ws2.web_rec_end_date BETWEEN '1999-08-16' AND '2001-08-15' AND ws2.web_state = 'TN' GROUP BY ws.ws_web_page_sk ORDER BY total_revenue DESC;
SELECT ws.ws_web_site_sk, ws2.web_name, COUNT(ws.ws_order_number) AS total_orders, AVG(ws.ws_net_paid) AS avg_revenue_per_order FROM web_sales ws JOIN web_site ws2 ON ws.ws_web_site_sk = ws2.web_site_sk WHERE ws2.web_site_sk IN (19, 27, 22) GROUP BY ws.ws_web_site_sk, ws2.web_name;
WITH daily_sales AS (SELECT ss.ss_sold_date_sk, COUNT(ss.ss_ticket_number) AS daily_orders, SUM(ss.ss_net_paid) AS daily_revenue FROM store_sales ss GROUP BY ss.ss_sold_date_sk) SELECT d.d_date, ds.daily_orders, ds.daily_revenue FROM daily_sales ds JOIN date_dim d ON ds.ss_sold_date_sk = d.d_date_sk WHERE d.d_date BETWEEN '2000-01-01' AND '2000-12-31' ORDER BY d.d_date ASC;