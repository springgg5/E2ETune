SELECT c_region, COUNT(lo_orderkey) as total_orders, SUM(lo_extendedprice) as total_revenue FROM lineorder_flat WHERE lo_partkey IN (15073, 15075, 15076) AND lo_tax IN (4, 1, 3) GROUP BY c_region ORDER BY total_revenue DESC;
SELECT p_brand, COUNT(lo_orderkey) as total_orders, AVG(lo_extendedprice) as avg_revenue FROM lineorder_flat WHERE p_name IN ('slate green', 'rose lemon', 'frosted floral') GROUP BY p_brand HAVING COUNT(lo_orderkey) > 10 ORDER BY avg_revenue DESC;
SELECT s_name, s_city, s_nation, SUM(lo_supplycost) as total_supply_cost FROM lineorder_flat WHERE p_brand IN ('MFGR#1415', 'MFGR#5534', 'MFGR#1534') GROUP BY s_name, s_city, s_nation ORDER BY total_supply_cost DESC;
SELECT c_mktsegment, COUNT(lo_orderkey) as total_orders, SUM(lo_extendedprice) as total_revenue, AVG(lo_quantity) as avg_quantity FROM lineorder_flat WHERE lo_shipmode IN ('AIR', 'RAIL', 'SHIP', 'TRUCK') GROUP BY c_mktsegment HAVING COUNT(lo_orderkey) > 100 ORDER BY total_revenue DESC;
SELECT p_category, p_type, p_size, COUNT(lo_orderkey) as total_orders, SUM(lo_extendedprice) as total_revenue FROM lineorder_flat WHERE p_container IN ('SM CASE', 'SM BOX', 'LG CASE', 'LG BOX') GROUP BY p_category, p_type, p_size HAVING COUNT(lo_orderkey) > 50 ORDER BY total_revenue DESC;