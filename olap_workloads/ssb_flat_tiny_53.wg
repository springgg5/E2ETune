SELECT c_region, s_region, COUNT(*) AS num_orders FROM lineorder_flat WHERE lo_orderdate = '19930520' GROUP BY c_region, s_region ORDER BY num_orders DESC;
SELECT p_category, AVG(lo_extendedprice) AS avg_price FROM lineorder_flat WHERE lo_orderdate = '19931107' AND lo_discount > 0 GROUP BY p_category ORDER BY avg_price DESC;
SELECT c_mktsegment, COUNT(DISTINCT lo_orderkey) AS num_orders FROM lineorder_flat WHERE lo_orderpriority = '1-URGENT' OR lo_orderpriority = '2-HIGH' GROUP BY c_mktsegment ORDER BY num_orders DESC;
SELECT s_nation, SUM(lo_supplycost) AS total_supply_cost FROM lineorder_flat WHERE p_size IN (41, 13, 3) GROUP BY s_nation ORDER BY total_supply_cost DESC;
SELECT p_brand, COUNT(*) AS num_products FROM lineorder_flat WHERE lo_orderdate = '19970323' AND lo_orderkey IN (29855905, 26332069, 13679395) GROUP BY p_brand ORDER BY num_products DESC;
SELECT c_city, s_city, SUM(lo_revenue) AS total_revenue FROM lineorder_flat WHERE lo_shipmode = 'AIR' AND lo_commitdate >= '19930101' AND lo_commitdate <= '19931231' GROUP BY c_city, s_city ORDER BY total_revenue DESC;
SELECT p_type, COUNT(*) AS num_products FROM lineorder_flat WHERE lo_custkey IN (SELECT lo_custkey FROM lineorder_flat WHERE s_nation = 'MOROCCO' OR s_nation = 'ROMANIA' OR s_nation = 'ETHIOPIA') GROUP BY p_type ORDER BY num_products DESC;
SELECT c_name, SUM(lo_extendedprice * lo_discount) AS total_discounted_price FROM lineorder_flat WHERE lo_orderkey IN (SELECT lo_orderkey FROM lineorder_flat WHERE lo_orderdate >= '19940101' AND lo_orderdate <= '19941231') GROUP BY c_name ORDER BY total_discounted_price DESC;