SELECT c.c_name, c.c_city, c.c_nation, SUM(lo.lo_revenue) AS total_revenue FROM customer c JOIN lineorder lo ON c.c_custkey = lo.lo_custkey WHERE lo.lo_revenue >= 2226654 AND lo.lo_partkey IN (16651, 210223, 82608) GROUP BY c.c_name, c.c_city, c.c_nation HAVING SUM(lo.lo_revenue) > 5000000 ORDER BY total_revenue DESC;
SELECT s.s_name, s.s_region, COUNT(lo.lo_orderkey) AS total_orders, AVG(lo.lo_supplycost) AS avg_supply_cost FROM supplier s JOIN lineorder lo ON s.s_suppkey = lo.lo_suppkey WHERE s.s_nation IN ('CANADA', 'RUSSIA', 'EGYPT') AND s.s_address LIKE 'f6uEipOS%' GROUP BY s.s_name, s.s_region HAVING COUNT(lo.lo_orderkey) > 100 ORDER BY total_orders DESC, avg_supply_cost ASC;
SELECT d.d_year, d.d_month, p.p_category, COUNT(lo.lo_orderkey) AS total_orders, SUM(lo.lo_extendedprice * (1 - lo.lo_discount)) AS total_discounted_price FROM date_dim d JOIN lineorder lo ON d.d_datekey = lo.lo_orderdate JOIN part p ON lo.lo_partkey = p.p_partkey WHERE d.d_year >= 2000 AND lo.lo_orderpriority IN ('1-URGENT', '2-HIGH', '3-MEDIUM', '4-LOW', '5-NOT SPECIFIED') GROUP BY d.d_year, d.d_month, p.p_category ORDER BY d.d_year ASC, d.d_month ASC, total_orders DESC;