SELECT c_mktsegment, COUNT(lo_orderkey) AS num_orders, AVG(lo_extendedprice) AS avg_price, SUM(lo_revenue) AS total_revenue FROM lineorder_flat WHERE lo_orderdate >= 20220101 AND lo_orderdate <= 20221231 GROUP BY c_mktsegment ORDER BY total_revenue DESC;
SELECT s_name, s_city, s_nation, SUM(lo_supplycost) AS total_supply_cost FROM lineorder_flat WHERE lo_shipmode = 'AIR' AND lo_commitdate >= 20220101 AND lo_commitdate <= 20221231 GROUP BY s_name, s_city, s_nation ORDER BY total_supply_cost DESC LIMIT 10;
SELECT p_category, p_brand, p_color, COUNT(lo_partkey) AS num_parts, SUM(lo_quantity) AS total_quantity FROM lineorder_flat WHERE p_size IN (26, 44, 7) AND lo_orderpriority = '1-URGENT' GROUP BY p_category, p_brand, p_color ORDER BY total_quantity DESC;
SELECT c_region, s_region, COUNT(lo_orderkey) AS num_orders, SUM(lo_extendedprice * (1 - lo_discount)) AS total_discounted_price FROM lineorder_flat WHERE lo_linenumber IN (5, 3, 1) AND c_mktsegment = 'HOUSEHOLD' GROUP BY c_region, s_region ORDER BY total_discounted_price DESC;