SELECT c_region, s_nation, p_mfgr, SUM(lo_extendedprice * lo_discount) AS revenue FROM lineorder_flat WHERE c_region = 'AMERICA' AND s_nation = 'GERMANY' AND p_mfgr = 'MFGR#2' GROUP BY c_region, s_nation, p_mfgr ORDER BY revenue DESC;
SELECT p_category, p_brand, AVG(lo_quantity) AS avg_quantity, AVG(lo_extendedprice) AS avg_price, AVG(lo_discount) AS avg_discount FROM lineorder_flat WHERE p_mfgr = 'MFGR#5' AND s_nation = 'ALGERIA' GROUP BY p_category, p_brand ORDER BY avg_quantity DESC, avg_price DESC;
SELECT c_mktsegment, COUNT(DISTINCT lo_orderkey) AS total_orders, SUM(lo_extendedprice * lo_discount) AS total_revenue FROM lineorder_flat WHERE lo_orderdate >= 19940101 AND lo_orderdate <= 19941231 AND c_region = 'ASIA' GROUP BY c_mktsegment ORDER BY total_revenue DESC;
SELECT s_name, s_address, s_city, s_phone, SUM(lo_supplycost * lo_quantity) AS total_supply_cost FROM lineorder_flat WHERE p_mfgr = 'MFGR#1' AND s_nation = 'SAUDI ARABIA' GROUP BY s_name, s_address, s_city, s_phone ORDER BY total_supply_cost DESC;