SELECT c_nation, COUNT(*) AS num_orders, SUM(lo_extendedprice) AS total_revenue FROM lineorder_flat WHERE lo_shipmode = 'REG AIR' GROUP BY c_nation ORDER BY total_revenue DESC;
SELECT lo_orderpriority, AVG(lo_quantity) AS avg_quantity, AVG(lo_extendedprice) AS avg_price, AVG(lo_discount) AS avg_discount FROM lineorder_flat WHERE lo_commitdate = '19950918' GROUP BY lo_orderpriority ORDER BY avg_quantity DESC;
SELECT p_category, p_brand, SUM(lo_quantity) AS total_quantity, SUM(lo_extendedprice) AS total_revenue FROM lineorder_flat WHERE lo_commitdate = '19920917' AND c_nation = 'RUSSIA' GROUP BY p_category, p_brand ORDER BY total_revenue DESC;
SELECT s_name, s_city, s_nation, COUNT(*) AS num_orders, SUM(lo_supplycost) AS total_supply_cost FROM lineorder_flat WHERE lo_shipmode = 'FOB' AND c_nation = 'ARGENTINA' GROUP BY s_name, s_city, s_nation ORDER BY total_supply_cost DESC;
SELECT p_mfgr, p_category, COUNT(*) AS num_products, AVG(p_size) AS avg_size FROM lineorder_flat WHERE lo_shipmode = 'MAIL' AND c_nation = 'BRAZIL' GROUP BY p_mfgr, p_category ORDER BY num_products DESC, avg_size ASC;
SELECT c_mktsegment, COUNT(DISTINCT lo_orderkey) AS num_orders, SUM(lo_extendedprice * (1 - lo_discount)) AS total_revenue FROM lineorder_flat WHERE lo_commitdate = '19980810' GROUP BY c_mktsegment ORDER BY total_revenue DESC;
SELECT s_region, p_type, COUNT(*) AS num_orders, SUM(lo_extendedprice) AS total_revenue, AVG(lo_tax) AS avg_tax FROM (SELECT * FROM lineorder_flat WHERE lo_shipmode = 'REG AIR' AND c_nation = 'ARGENTINA') AS subquery GROUP BY s_region, p_type ORDER BY total_revenue DESC, avg_tax ASC;