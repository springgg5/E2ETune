SELECT cn.name, COUNT(*) AS num_characters FROM char_name AS cn JOIN cast_info AS ci ON cn.id = ci.person_role_id JOIN role_type AS rt ON ci.role_id = rt.id WHERE rt.role = 'actor' GROUP BY cn.name HAVING COUNT(*) > 10 ORDER BY num_characters DESC;
SELECT n.name, COUNT(*) AS num_movies FROM name AS n JOIN cast_info AS ci ON n.id = ci.person_id JOIN movie_keyword AS mk ON ci.movie_id = mk.movie_id WHERE mk.keyword_id IN (22101, 5961, 14275) GROUP BY n.name HAVING COUNT(*) > 5 ORDER BY num_movies DESC;
SELECT comp.name, COUNT(*) AS num_movies FROM company_name AS comp JOIN movie_companies AS mc ON comp.id = mc.company_id JOIN title AS t ON mc.movie_id = t.id WHERE comp.md5sum IN ('707595d5050873bb482c2f33db4ec978', 'd15b28b4f3649300b52c23fb7beb03dd', '4cf75b12a24186e6cfd20a8b6b0d8198') AND t.kind_id = 1 GROUP BY comp.name HAVING COUNT(*) > 10 ORDER BY num_movies DESC;
SELECT k.keyword, COUNT(*) AS num_movies, AVG(t.production_year) AS avg_production_year FROM keyword AS k JOIN movie_keyword AS mk ON k.id = mk.keyword_id JOIN title AS t ON mk.movie_id = t.id WHERE k.phonetic_code IN ('C4525', 'A6323', 'D3521') GROUP BY k.keyword HAVING COUNT(*) > 5 ORDER BY num_movies DESC, avg_production_year DESC;
SELECT n.name, COUNT(DISTINCT t.id) AS num_movies, COUNT(DISTINCT comp.id) AS num_companies FROM name AS n JOIN cast_info AS ci ON n.id = ci.person_id JOIN title AS t ON ci.movie_id = t.id JOIN movie_companies AS mc ON t.id = mc.movie_id JOIN company_name AS comp ON mc.company_id = comp.id WHERE n.gender = 'M' AND t.kind_id = 1 GROUP BY n.name HAVING COUNT(DISTINCT t.id) > 10 AND COUNT(DISTINCT comp.id) > 5 ORDER BY num_movies DESC, num_companies DESC;