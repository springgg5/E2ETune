SELECT c_region, c_city, COUNT(DISTINCT lo_orderkey) AS num_orders, SUM(lo_extendedprice) AS total_price, AVG(lo_quantity) AS avg_quantity FROM lineorder_flat WHERE c_region IN ('ASIA', 'MIDDLE EAST', 'EUROPE') AND lo_orderdate BETWEEN 19940101 AND 19941231 GROUP BY c_region, c_city ORDER BY c_region, c_city;
SELECT p_category, p_brand, p_color, COUNT(DISTINCT lo_orderkey) AS num_orders, SUM(lo_extendedprice * (1 - lo_discount)) AS revenue, AVG(lo_supplycost) AS avg_supply_cost FROM lineorder_flat WHERE lo_orderpriority = '1-URGENT' OR lo_orderpriority = '2-HIGH' AND lo_commitdate < lo_orderdate AND lo_shipmode IN ('REG AIR', 'AIR') GROUP BY p_category, p_brand, p_color HAVING COUNT(DISTINCT lo_orderkey) > 10 ORDER BY p_category, p_brand, p_color;