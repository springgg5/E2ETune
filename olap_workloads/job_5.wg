SELECT t.title, COUNT(*) AS num_movies FROM title t JOIN movie_companies mc ON t.id = mc.movie_id JOIN company_type ct ON mc.company_type_id = ct.id WHERE ct.kind = 'production companies' GROUP BY t.title HAVING COUNT(*) > 1 ORDER BY num_movies DESC;
SELECT n.name, COUNT(*) AS num_roles FROM name n JOIN cast_info ci ON n.id = ci.person_id JOIN role_type rt ON ci.role_id = rt.id WHERE rt.role = 'actor' OR rt.role = 'actress' GROUP BY n.name HAVING COUNT(*) > 10 ORDER BY num_roles DESC;
SELECT k.keyword, COUNT(*) AS num_movies FROM keyword k JOIN movie_keyword mk ON k.id = mk.keyword_id GROUP BY k.keyword HAVING COUNT(*) > 50 ORDER BY num_movies DESC;
SELECT t1.title AS movie1, t2.title AS movie2, lt.link FROM movie_link ml JOIN title t1 ON ml.movie_id = t1.id JOIN title t2 ON ml.linked_movie_id = t2.id JOIN link_type lt ON ml.link_type_id = lt.id WHERE lt.link = 'sequel' OR lt.link = 'prequel' ORDER BY t1.title;
SELECT cn.name, COUNT(*) AS num_characters FROM char_name cn JOIN cast_info ci ON cn.id = ci.person_role_id GROUP BY cn.name HAVING COUNT(*) > 5 ORDER BY num_characters DESC;
SELECT t.title, COUNT(*) AS num_special_effects_companies FROM title t JOIN movie_companies mc ON t.id = mc.movie_id JOIN company_type ct ON mc.company_type_id = ct.id WHERE ct.kind = 'special effects companies' GROUP BY t.title HAVING COUNT(*) > 1 ORDER BY num_special_effects_companies DESC;
SELECT n.name, COUNT(*) AS num_movies, AVG(t.production_year) AS avg_production_year FROM name n JOIN cast_info ci ON n.id = ci.person_id JOIN title t ON ci.movie_id = t.id WHERE t.kind_id = 1 GROUP BY n.name HAVING COUNT(*) > 10 AND AVG(t.production_year) > 2000 ORDER BY avg_production_year DESC;