SELECT t.id, t.title, COUNT(c.id) AS cast_count FROM title AS t JOIN cast_info AS c ON t.id = c.movie_id WHERE t.phonetic_code = 'N3516' GROUP BY t.id, t.title HAVING COUNT(c.id) > 10 ORDER BY COUNT(c.id) DESC;
SELECT t.id, t.title, AVG(mi.info::integer) AS average_rating FROM title AS t JOIN movie_info AS mi ON t.id = mi.movie_id WHERE mi.info_type_id = 101 AND t.id IN ('111913', '65805', '135174') GROUP BY t.id, t.title ORDER BY AVG(mi.info::integer) DESC;
SELECT n.id, n.name, COUNT(c.id) AS movie_count FROM name AS n JOIN cast_info AS c ON n.id = c.person_id WHERE c.note LIKE '%(1993)%' GROUP BY n.id, n.name HAVING COUNT(c.id) > 5 ORDER BY COUNT(c.id) DESC;
WITH movie_actors AS (SELECT DISTINCT c.person_id, c.movie_id FROM cast_info AS c WHERE c.role_id = 1) SELECT n.id, n.name, COUNT(ma.movie_id) AS co_starred_movies FROM movie_actors AS ma JOIN name AS n ON ma.person_id = n.id WHERE ma.movie_id IN (SELECT movie_id FROM movie_actors WHERE person_id = 2373358) AND ma.person_id != 2373358 GROUP BY n.id, n.name ORDER BY COUNT(ma.movie_id) DESC;
SELECT t.id, t.title, COUNT(DISTINCT mk.keyword_id) AS keyword_count FROM title AS t JOIN movie_keyword AS mk ON t.id = mk.movie_id WHERE t.production_year BETWEEN 2000 AND 2010 GROUP BY t.id, t.title HAVING COUNT(DISTINCT mk.keyword_id) > 20 ORDER BY COUNT(DISTINCT mk.keyword_id) DESC;