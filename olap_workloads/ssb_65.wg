SELECT c.c_mktsegment, d.d_sellingseason, COUNT(lo.lo_orderkey) AS num_orders, SUM(lo.lo_extendedprice) AS total_price, AVG(lo.lo_discount) AS avg_discount FROM lineorder lo JOIN customer c ON lo.lo_custkey = c.c_custkey JOIN date_dim d ON lo.lo_orderdate = d.d_datekey WHERE c.c_mktsegment IN ('MACHINERY', 'AUTOMOBILE', 'FURNITURE') AND d.d_sellingseason IN ('Fall', 'Winter', 'Summer') GROUP BY c.c_mktsegment, d.d_sellingseason ORDER BY c.c_mktsegment, d.d_sellingseason;
SELECT p.p_category, p.p_brand, d.d_month, COUNT(lo.lo_orderkey) AS num_orders, SUM(lo.lo_extendedprice) AS total_price, AVG(lo.lo_quantity) AS avg_quantity FROM lineorder lo JOIN part p ON lo.lo_partkey = p.p_partkey JOIN date_dim d ON lo.lo_orderdate = d.d_datekey WHERE d.d_month IN ('December', 'September', 'January') AND p.p_category IN (SELECT DISTINCT p_category FROM part WHERE p_size BETWEEN 10 AND 20) GROUP BY p.p_category, p.p_brand, d.d_month ORDER BY p.p_category, p.p_brand, d.d_month;