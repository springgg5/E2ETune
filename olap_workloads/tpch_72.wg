SELECT p.p_brand, COUNT(*) AS num_parts, AVG(ps.ps_availqty) AS avg_avail_qty, SUM(ps.ps_supplycost) AS total_supply_cost FROM part p JOIN partsupp ps ON p.p_partkey = ps.ps_partkey WHERE p.p_brand IN ('Brand#21', '0qN', 'Brand#52') AND p.p_partkey IN (400, 413, 376) GROUP BY p.p_brand ORDER BY p.p_brand;
SELECT s.s_nationkey, o.o_orderpriority, COUNT(*) AS num_orders, AVG(o.o_totalprice) AS avg_order_price, SUM(o.o_totalprice) AS total_order_price FROM supplier s JOIN orders o ON s.s_suppkey = o.o_custkey WHERE s.s_nationkey IN (0, 14, 7) AND s.s_acctbal BETWEEN 1000 AND 6000 AND o.o_shippriority = 0 GROUP BY s.s_nationkey, o.o_orderpriority ORDER BY s.s_nationkey, o.o_orderpriority;