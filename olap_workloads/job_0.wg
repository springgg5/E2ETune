SELECT t.title, COUNT(c.movie_id) AS num_cast_members FROM title AS t JOIN cast_info AS c ON t.id = c.movie_id WHERE t.production_year BETWEEN 2000 AND 2020 GROUP BY t.title HAVING COUNT(c.movie_id) > 10 ORDER BY num_cast_members DESC;
SELECT k.keyword, COUNT(mk.movie_id) AS num_movies FROM keyword AS k JOIN movie_keyword AS mk ON k.id = mk.keyword_id GROUP BY k.keyword HAVING COUNT(mk.movie_id) > 100 ORDER BY num_movies DESC;
SELECT n.name, COUNT(ci.person_id) AS num_roles FROM name AS n JOIN cast_info AS ci ON n.id = ci.person_id WHERE ci.role_id IN (1, 2) GROUP BY n.name HAVING COUNT(ci.person_id) > 50 ORDER BY num_roles DESC;
SELECT t.title, AVG(mi.info::integer) AS average_rating FROM title AS t JOIN movie_info AS mi ON t.id = mi.movie_id WHERE mi.info_type_id = 101 AND t.production_year BETWEEN 2000 AND 2020 GROUP BY t.title HAVING AVG(mi.info::integer) > 7 ORDER BY average_rating DESC;
SELECT t1.title AS movie1, t2.title AS movie2, lt.link FROM movie_link AS ml JOIN title AS t1 ON ml.movie_id = t1.id JOIN title AS t2 ON ml.linked_movie_id = t2.id JOIN link_type AS lt ON ml.link_type_id = lt.id WHERE ml.link_type_id IN (9, 10, 12) AND t1.production_year BETWEEN 2000 AND 2020;
SELECT t.title, COUNT(mc.company_id) AS num_companies FROM title AS t JOIN movie_companies AS mc ON t.id = mc.movie_id WHERE t.production_year BETWEEN 2000 AND 2020 GROUP BY t.title HAVING COUNT(mc.company_id) > 5 ORDER BY num_companies DESC;
SELECT t.title, COUNT(mk.keyword_id) AS num_keywords FROM title AS t JOIN movie_keyword AS mk ON t.id = mk.movie_id WHERE t.production_year BETWEEN 2000 AND 2020 GROUP BY t.title HAVING COUNT(mk.keyword_id) > 20 ORDER BY num_keywords DESC;
SELECT n.name, COUNT(pi.person_id) AS num_facts FROM name AS n JOIN person_info AS pi ON n.id = pi.person_id WHERE pi.info_type_id IN (2, 3, 4) GROUP BY n.name HAVING COUNT(pi.person_id) > 10 ORDER BY num_facts DESC;
SELECT t.title, COUNT(mi.movie_id) AS num_movie_info FROM title AS t JOIN movie_info AS mi ON t.id = mi.movie_id WHERE t.production_year BETWEEN 2000 AND 2020 GROUP BY t.title HAVING COUNT(mi.movie_id) > 15 ORDER BY num_movie_info DESC;