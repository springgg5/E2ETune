SELECT c_region, s_region, COUNT(*) AS num_orders, SUM(lo_extendedprice) AS total_price, AVG(lo_discount) AS avg_discount FROM lineorder_flat WHERE lo_tax = 6 GROUP BY c_region, s_region ORDER BY num_orders DESC, total_price DESC;
SELECT p_category, p_brand, p_color, SUM(lo_quantity) AS total_quantity, SUM(lo_supplycost) AS total_supply_cost FROM lineorder_flat WHERE s_region = 'MIDDLE EAST' AND lo_orderdate BETWEEN 20210101 AND 20211231 GROUP BY p_category, p_brand, p_color ORDER BY total_quantity DESC, total_supply_cost DESC;
SELECT c_mktsegment, lo_orderpriority, COUNT(*) AS num_orders, SUM(lo_ordtotalprice) AS total_order_price FROM lineorder_flat WHERE c_nation = 'UNITED STATES' AND lo_commitdate BETWEEN 20210101 AND 20211231 GROUP BY c_mktsegment, lo_orderpriority ORDER BY num_orders DESC, total_order_price DESC;
SELECT s_name, s_city, s_nation, COUNT(*) AS num_orders, SUM(lo_revenue) AS total_revenue FROM lineorder_flat WHERE lo_shipmode = 'AIR' AND lo_shippriority = '1' AND s_region = 'EUROPE' GROUP BY s_name, s_city, s_nation ORDER BY num_orders DESC, total_revenue DESC;
SELECT p_mfgr, p_type, COUNT(*) AS num_parts, SUM(lo_supplycost) AS total_supply_cost FROM lineorder_flat WHERE lo_discount BETWEEN 5 AND 10 AND p_size BETWEEN 10 AND 50 GROUP BY p_mfgr, p_type HAVING COUNT(*) > 100 ORDER BY num_parts DESC, total_supply_cost DESC;