SELECT t.title, COUNT(DISTINCT mk.keyword_id) AS num_keywords, AVG(mi.info::numeric) AS avg_height FROM title AS t JOIN movie_keyword AS mk ON t.id = mk.movie_id JOIN movie_info AS mi ON t.id = mi.movie_id JOIN info_type AS it ON mi.info_type_id = it.id WHERE t.kind_id = 2 AND it.info = 'height' GROUP BY t.title HAVING COUNT(DISTINCT mk.keyword_id) > 10 ORDER BY num_keywords DESC, avg_height DESC LIMIT 10;
SELECT n.name, COUNT(DISTINCT ci.movie_id) AS num_movies, SUM(CASE WHEN kt.kind = 'movie' THEN 1 ELSE 0 END) AS num_movie_roles, SUM(CASE WHEN kt.kind = 'tv movie' THEN 1 ELSE 0 END) AS num_tv_movie_roles FROM name AS n JOIN cast_info AS ci ON n.id = ci.person_id JOIN title AS t ON ci.movie_id = t.id JOIN kind_type AS kt ON t.kind_id = kt.id WHERE n.gender = 'M' GROUP BY n.name HAVING COUNT(DISTINCT ci.movie_id) > 50 ORDER BY num_movies DESC, num_movie_roles DESC, num_tv_movie_roles DESC LIMIT 10;