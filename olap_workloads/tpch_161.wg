SELECT r_name, COUNT(n_nationkey) AS nation_count FROM nation JOIN region ON n_regionkey = r_regionkey GROUP BY r_name ORDER BY nation_count DESC;
SELECT s_name, SUM(ps_supplycost * ps_availqty) AS total_supply_cost FROM supplier JOIN partsupp ON s_suppkey = ps_suppkey GROUP BY s_name ORDER BY total_supply_cost DESC LIMIT 10;
SELECT c_name, COUNT(o_orderkey) AS order_count, AVG(o_totalprice) AS avg_order_price FROM customer JOIN orders ON c_custkey = o_custkey WHERE o_orderdate >= '1992-02-22' AND o_orderdate <= '1998-04-07' GROUP BY c_name ORDER BY order_count DESC, avg_order_price ASC;
SELECT p_type, COUNT(l_partkey) AS part_count, SUM(l_extendedprice * (1 - l_discount)) AS total_revenue FROM part JOIN lineitem ON p_partkey = l_partkey WHERE l_shipdate >= '1997-03-16' GROUP BY p_type ORDER BY total_revenue DESC;
SELECT o_orderpriority, COUNT(o_orderkey) AS order_count, SUM(o_totalprice) AS total_price FROM orders WHERE o_shippriority = 0 GROUP BY o_orderpriority ORDER BY total_price DESC;
SELECT c_name, c_phone, SUM(o_totalprice) AS total_spent FROM customer JOIN orders ON c_custkey = o_custkey WHERE c_phone IN ('25-498-699-7824', '30-660-202-7517', '33-937-724-3506') GROUP BY c_name, c_phone ORDER BY total_spent DESC;
SELECT s_name, p_name, SUM(l_quantity) AS total_quantity FROM supplier JOIN lineitem ON s_suppkey = l_suppkey JOIN part ON p_partkey = l_partkey WHERE l_shipmode = 'TRUCK' AND l_shipdate >= '1997-03-16' GROUP BY s_name, p_name ORDER BY total_quantity DESC;
SELECT c_name, c_address, COUNT(o_orderkey) AS order_count FROM customer JOIN orders ON c_custkey = o_custkey WHERE c_address IN ('3vlJp0W8cniEXV', 'QNc2eOlRIzL6jpthwgDuB866uCIUPiOX', 'UsrigSqZBnmbXhXNR6ibloq60qHBUj42kwX') GROUP BY c_name, c_address ORDER BY order_count DESC;
SELECT n_name, COUNT(l_orderkey) AS order_count FROM nation JOIN customer ON n_nationkey = c_nationkey JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey WHERE o_clerk IN ('Clerk#000000047', 'Clerk#000000515', 'Clerk#000000853') GROUP BY n_name ORDER BY order_count DESC;