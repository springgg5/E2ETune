SELECT p.p_type, COUNT(*) as total_parts, AVG(p.p_retailprice) as avg_retailprice FROM part p WHERE p.p_retailprice > 1500 GROUP BY p.p_type HAVING COUNT(*) > 10 ORDER BY total_parts DESC;
SELECT c.c_mktsegment, SUM(o.o_totalprice) as total_revenue, COUNT(o.o_orderkey) as total_orders FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey WHERE o.o_orderpriority = '2-HIGH' GROUP BY c.c_mktsegment ORDER BY total_revenue DESC;
SELECT r.r_name, COUNT(DISTINCT s.s_suppkey) as total_suppliers, COUNT(DISTINCT c.c_custkey) as total_customers FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN customer c ON n.n_nationkey = c.c_nationkey GROUP BY r.r_name;
SELECT p.p_brand, COUNT(l.l_orderkey) as total_orders, SUM(l.l_extendedprice * (1 - l.l_discount)) as revenue FROM part p JOIN lineitem l ON p.p_partkey = l.l_partkey WHERE l.l_shipdate >= '1995-01-01' AND l.l_shipdate < '1995-12-31' GROUP BY p.p_brand ORDER BY revenue DESC;