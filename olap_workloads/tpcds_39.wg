SELECT c.c_first_name, c.c_last_name, SUM(ss.ss_net_profit) as total_profit FROM store_sales ss JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk WHERE ss.ss_sold_date_sk BETWEEN 2450859 AND 2451079 GROUP BY c.c_first_name, c.c_last_name ORDER BY total_profit DESC LIMIT 10;
SELECT i.i_category, COUNT(DISTINCT cr.cr_order_number) as total_orders, AVG(cr.cr_return_amount) as avg_return_amount FROM catalog_returns cr JOIN item i ON cr.cr_item_sk = i.i_item_sk WHERE cr.cr_ship_mode_sk IN ('13', '1', '14') AND cr.cr_returned_date_sk BETWEEN 2450859 AND 2451079 GROUP BY i.i_category ORDER BY total_orders DESC;
SELECT cc.cc_name, COUNT(cs.cs_order_number) as total_orders, SUM(cs.cs_net_profit) as total_profit FROM catalog_sales cs JOIN call_center cc ON cs.cs_call_center_sk = cc.cc_call_center_sk WHERE cs.cs_quantity BETWEEN 67 AND 92 AND cs.cs_bill_customer_sk IN (84546, 38398, 36138) AND cs.cs_bill_addr_sk IN (30040, 7286, 35097) GROUP BY cc.cc_name ORDER BY total_profit DESC;
SELECT w.w_warehouse_name, SUM(inv.inv_quantity_on_hand) as total_inventory FROM inventory inv JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk GROUP BY w.w_warehouse_name HAVING SUM(inv.inv_quantity_on_hand) > 10000 ORDER BY total_inventory DESC;
SELECT s.s_store_name, COUNT(DISTINCT ss.ss_ticket_number) as total_tickets, SUM(ss.ss_net_paid) as total_revenue FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk WHERE ss.ss_sold_date_sk BETWEEN 2450859 AND 2451079 GROUP BY s.s_store_name ORDER BY total_revenue DESC;
SELECT p.p_promo_name, COUNT(DISTINCT ws.ws_order_number) as total_orders, SUM(ws.ws_net_profit) as total_profit FROM web_sales ws JOIN promotion p ON ws.ws_promo_sk = p.p_promo_sk WHERE ws.ws_sold_date_sk BETWEEN 2450859 AND 2451079 AND ws.ws_web_site_sk IN (SELECT web_site_sk FROM web_site WHERE web_tax_percentage > 0.05) GROUP BY p.p_promo_name ORDER BY total_profit DESC;