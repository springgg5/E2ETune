SELECT p.p_brand, p.p_type, COUNT(*) as total_parts, AVG(ps.ps_supplycost) as avg_supply_cost FROM part p JOIN partsupp ps ON p.p_partkey = ps.ps_partkey WHERE p.p_brand IN ('Brand#45', 'Brand#43', 'Brand#52') AND p.p_type IN ('PROMO BURNISHED BRASS', 'SMALL PLATED BRASS', 'MEDIUM BURNISHED BRASS') GROUP BY p.p_brand, p.p_type ORDER BY p.p_brand, p.p_type;
SELECT s.s_address, SUM(ps.ps_availqty) as total_avail_qty, AVG(s.s_acctbal) as avg_acct_bal FROM supplier s JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey WHERE s.s_address IN ('a KnEGf,bqEnGd2Wd9Tl', 'a7ZBr9561n7CHzwtrfoZnpNWf71uKtH', 'PJSCHXMAsqyRr5aPD9lp4tUl1B1WytbosVY8EdNZ') GROUP BY s.s_address ORDER BY total_avail_qty DESC;
SELECT c.c_mktsegment, AVG(c.c_acctbal) as avg_acct_bal, COUNT(o.o_orderkey) as total_orders FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey WHERE o.o_shippriority = 0 GROUP BY c.c_mktsegment ORDER BY avg_acct_bal DESC;
SELECT r.r_name, COUNT(n.n_nationkey) as total_nations, SUM(l.l_extendedprice * (1 - l.l_discount)) as revenue FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE l.l_shipdate >= '1995-01-01' AND l.l_shipdate <= '1995-12-31' GROUP BY r.r_name ORDER BY revenue DESC;
SELECT o.o_orderpriority, COUNT(*) as priority_count, AVG(o.o_totalprice) as avg_order_price FROM orders o WHERE o.o_clerk IN ('Clerk#000000434', 'Clerk#000000598', 'Clerk#000000170') AND o.o_orderdate >= '1996-01-01' AND o.o_orderdate <= '1996-12-31' GROUP BY o.o_orderpriority ORDER BY priority_count DESC;