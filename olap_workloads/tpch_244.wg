SELECT n.n_name, r.r_name, COUNT(c.c_custkey) AS num_customers, SUM(c.c_acctbal) AS total_balance FROM nation n JOIN region r ON n.n_regionkey = r.r_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey WHERE n.n_name IN ('JAPAN', 'JORDAN', 'EGYPT') AND r.r_name IN ('ASIA', 'MIDDLE EAST') GROUP BY n.n_name, r.r_name ORDER BY total_balance DESC;
SELECT p.p_type, p.p_brand, COUNT(l.l_partkey) AS num_parts, AVG(l.l_quantity) AS avg_quantity, SUM(l.l_extendedprice) AS total_price FROM part p JOIN lineitem l ON p.p_partkey = l.l_partkey WHERE p.p_size BETWEEN 10 AND 50 AND l.l_shipmode IN ('AIR', 'RAIL') GROUP BY p.p_type, p.p_brand HAVING COUNT(l.l_partkey) > 10 ORDER BY total_price DESC;
SELECT c.c_mktsegment, o.o_orderpriority, COUNT(o.o_orderkey) AS num_orders, SUM(o.o_totalprice) AS total_order_value FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey WHERE c.c_mktsegment IN ('FURNITURE', 'BUILDING', 'MACHINERY') AND o.o_orderdate BETWEEN '2020-01-01' AND '2020-12-31' GROUP BY c.c_mktsegment, o.o_orderpriority ORDER BY total_order_value DESC;
SELECT s.s_name, COUNT(ps.ps_partkey) AS num_parts, SUM(ps.ps_supplycost * ps.ps_availqty) AS total_inventory_value FROM supplier s JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey WHERE s.s_nationkey IN (SELECT n.n_nationkey FROM nation n WHERE n.n_name IN ('JAPAN', 'JORDAN', 'EGYPT')) AND ps.ps_supplycost >= 100 GROUP BY s.s_name HAVING COUNT(ps.ps_partkey) > 5 ORDER BY total_inventory_value DESC;