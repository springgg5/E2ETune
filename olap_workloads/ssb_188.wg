SELECT c.c_custkey, c.c_name, SUM(lo.lo_revenue) as total_revenue, AVG(lo.lo_discount) as avg_discount FROM customer c JOIN lineorder lo ON c.c_custkey = lo.lo_custkey WHERE c.c_region = 'EUROPE' AND lo.lo_orderpriority = '3-MEDIUM' AND lo.lo_discount BETWEEN 2 AND 4 GROUP BY c.c_custkey, c.c_name HAVING SUM(lo.lo_revenue) > 100000 ORDER BY total_revenue DESC;
SELECT p.p_partkey, p.p_name, p.p_type, COUNT(lo.lo_orderkey) as num_orders, SUM(lo.lo_quantity) as total_quantity FROM part p JOIN lineorder lo ON p.p_partkey = lo.lo_partkey JOIN supplier s ON lo.lo_suppkey = s.s_suppkey WHERE p.p_color = 'frosted brown' AND s.s_region = 'AFRICA' AND lo.lo_shipmode = 'RAIL' GROUP BY p.p_partkey, p.p_name, p.p_type HAVING COUNT(lo.lo_orderkey) > 10 ORDER BY total_quantity DESC;