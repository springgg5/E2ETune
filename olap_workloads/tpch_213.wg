SELECT n.n_name, r.r_name, COUNT(*) AS num_customers FROM nation n JOIN region r ON n.n_regionkey = r.r_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey WHERE n.n_nationkey IN (5, 20, 16) GROUP BY n.n_name, r.r_name ORDER BY num_customers DESC;
SELECT p.p_brand, p.p_type, SUM(ps.ps_availqty) AS total_inventory FROM part p JOIN partsupp ps ON p.p_partkey = ps.ps_partkey WHERE p.p_brand IN ('Brand#53', 'Brand#13', 'Brand#32') AND p.p_type IN ('STANDARD ANODIZED NICKEL', 'SMALL BURNISHED STEEL', 'STANDARD POLISHED BRASS') GROUP BY p.p_brand, p.p_type ORDER BY total_inventory DESC;
SELECT o.o_orderpriority, COUNT(*) AS num_orders, AVG(o.o_totalprice) AS avg_order_price FROM orders o WHERE o.o_totalprice >= 50000 AND o.o_totalprice <= 200000 AND o.o_orderpriority IN ('4-NOT SPECIFIED', '2-HIGH', '5-LOW') GROUP BY o.o_orderpriority ORDER BY num_orders DESC;
SELECT s.s_name, COUNT(*) AS num_lineitems, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue FROM supplier s JOIN lineitem l ON s.s_suppkey = l.l_suppkey WHERE l.l_shipdate >= '1994-01-01' AND l.l_shipdate <= '1995-12-31' GROUP BY s.s_name HAVING COUNT(*) > 10 ORDER BY total_revenue DESC;