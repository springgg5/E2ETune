SELECT i.i_item_id, sum(inv.inv_quantity_on_hand) AS total_quantity FROM item i JOIN inventory inv ON i.i_item_sk = inv.inv_item_sk WHERE i.i_container = 'Unknown' AND inv.inv_warehouse_sk = 1 GROUP BY i.i_item_id HAVING sum(inv.inv_quantity_on_hand) > 1000 ORDER BY total_quantity DESC LIMIT 10;
SELECT ca.ca_country, ca.ca_state, COUNT(ss.ss_item_sk) AS total_sales FROM store_sales ss JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE ca.ca_street_name = 'Main Davis' AND ca.ca_gmt_offset = -7.00 GROUP BY ca.ca_country, ca.ca_state ORDER BY total_sales DESC;
SELECT i.i_class_id, AVG(ws.ws_sales_price) AS average_sales_price FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk WHERE i.i_class_id IN (11, 1, 8) GROUP BY i.i_class_id ORDER BY average_sales_price DESC;
SELECT i.i_product_name, COUNT(cs.cs_item_sk) AS total_orders FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk WHERE i.i_product_name IN ('ableoughtable', 'n steseable', 'n stoughtought') GROUP BY i.i_product_name ORDER BY total_orders DESC;
SELECT ca.ca_street_type, COUNT(cr.cr_item_sk) AS total_returns FROM catalog_returns cr JOIN customer_address ca ON cr.cr_returning_addr_sk = ca.ca_address_sk WHERE ca.ca_street_type IN ('Blvd', 'ST', 'Way') GROUP BY ca.ca_street_type ORDER BY total_returns DESC;
SELECT ca.ca_gmt_offset, COUNT(ws.ws_item_sk) AS total_web_sales FROM web_sales ws JOIN customer_address ca ON ws.ws_bill_addr_sk = ca.ca_address_sk WHERE ca.ca_gmt_offset IN (-7.00, -5.00, -10.00) GROUP BY ca.ca_gmt_offset ORDER BY total_web_sales DESC;