SELECT t.title, COUNT(mc.company_id) AS num_companies FROM title AS t JOIN movie_companies AS mc ON t.id = mc.movie_id WHERE t.production_year BETWEEN 2000 AND 2020 GROUP BY t.title HAVING COUNT(mc.company_id) > 1 ORDER BY num_companies DESC;
SELECT t.title, AVG(ci.nr_order) AS avg_order FROM title AS t JOIN cast_info AS ci ON t.id = ci.movie_id WHERE t.kind_id = 1 AND t.production_year BETWEEN 2000 AND 2020 GROUP BY t.title HAVING COUNT(ci.person_id) > 10 ORDER BY avg_order DESC;
SELECT n.name, COUNT(*) AS num_roles FROM name AS n JOIN cast_info AS ci ON n.id = ci.person_id WHERE ci.role_id = 1 AND ci.movie_id IN (SELECT movie_id FROM movie_companies WHERE company_id IN (SELECT id FROM company_name WHERE country_code = 'US')) GROUP BY n.name HAVING COUNT(*) > 5 ORDER BY num_roles DESC;
SELECT t.title, COUNT(mk.keyword_id) AS num_keywords FROM title AS t JOIN movie_keyword AS mk ON t.id = mk.movie_id WHERE t.production_year BETWEEN 2000 AND 2020 AND t.kind_id = 1 GROUP BY t.title HAVING COUNT(mk.keyword_id) > 10 ORDER BY num_keywords DESC;
SELECT ct.kind, COUNT(mc.company_id) AS num_companies FROM company_type AS ct JOIN movie_companies AS mc ON ct.id = mc.company_type_id WHERE mc.movie_id IN (SELECT id FROM title WHERE production_year BETWEEN 2000 AND 2020) GROUP BY ct.kind ORDER BY num_companies DESC;
SELECT t.title, COUNT(ci.person_id) AS num_actors FROM title AS t JOIN cast_info AS ci ON t.id = ci.movie_id WHERE t.kind_id = 1 AND ci.role_id = 1 AND t.production_year BETWEEN 2000 AND 2020 GROUP BY t.title HAVING COUNT(ci.person_id) > 10 ORDER BY num_actors DESC;
SELECT n.name, COUNT(ci.movie_id) AS num_movies FROM name AS n JOIN cast_info AS ci ON n.id = ci.person_id WHERE ci.role_id = 1 AND ci.movie_id IN (SELECT id FROM title WHERE kind_id = 1 AND production_year BETWEEN 2000 AND 2020) GROUP BY n.name HAVING COUNT(ci.movie_id) > 5 ORDER BY num_movies DESC;
SELECT t.title, COUNT(DISTINCT ci.person_id) AS num_unique_actors FROM title AS t JOIN cast_info AS ci ON t.id = ci.movie_id WHERE t.production_year BETWEEN 2000 AND 2020 AND ci.role_id = 1 GROUP BY t.title HAVING COUNT(DISTINCT ci.person_id) > 10 ORDER BY num_unique_actors DESC;