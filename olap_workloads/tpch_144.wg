SELECT o.o_orderkey, o.o_orderdate, o.o_totalprice, SUM(l.l_extendedprice) AS total_lineitem_price FROM orders o JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE o.o_orderkey IN (3207, 674, 1156) GROUP BY o.o_orderkey, o.o_orderdate, o.o_totalprice HAVING SUM(l.l_extendedprice) > 100000 ORDER BY o.o_orderdate DESC;
SELECT p.p_partkey, p.p_name, SUM(ps.ps_availqty) AS total_available_quantity, AVG(ps.ps_supplycost) AS average_supply_cost FROM part p JOIN partsupp ps ON p.p_partkey = ps.ps_partkey WHERE ps.ps_supplycost BETWEEN 500 AND 600 AND ps.ps_comment LIKE '%%PwR%%' GROUP BY p.p_partkey, p.p_name HAVING SUM(ps.ps_availqty) > 3000 ORDER BY AVG(ps.ps_supplycost) ASC;
SELECT c.c_custkey, c.c_name, c.c_mktsegment, COUNT(o.o_orderkey) AS total_orders, AVG(o.o_totalprice) AS average_order_price FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey WHERE o.o_orderpriority IN ('1-URGENT', '2-HIGH', '3-MEDIUM', '4-LOW', '5-NOT SPECIFIED') GROUP BY c.c_custkey, c.c_name, c.c_mktsegment HAVING COUNT(o.o_orderkey) > 10 AND AVG(o.o_totalprice) > 50000 ORDER BY c.c_mktsegment ASC, AVG(o.o_totalprice) DESC;