SELECT c_region, COUNT(DISTINCT lo_orderkey) AS num_orders FROM lineorder_flat WHERE lo_extendedprice BETWEEN 3971786 AND 7008606 GROUP BY c_region ORDER BY num_orders DESC;
SELECT p_category, AVG(lo_quantity) AS avg_quantity, SUM(lo_supplycost) AS total_supply_cost FROM lineorder_flat WHERE s_address = 'GW20L,Z72sUbJZMAfTieS' GROUP BY p_category ORDER BY avg_quantity DESC;
SELECT c_name, SUM(lo_revenue) AS total_revenue FROM lineorder_flat WHERE p_color IN ('orchid', 'rose', 'peru') AND lo_orderdate >= '19940101' AND lo_orderdate <= '19941231' GROUP BY c_name ORDER BY total_revenue DESC LIMIT 10;
SELECT s_name, COUNT(DISTINCT lo_orderkey) AS num_orders, SUM(lo_extendedprice * (1 - lo_discount)) AS revenue FROM lineorder_flat WHERE lo_orderpriority = '1-URGENT' OR lo_orderpriority = '2-HIGH' GROUP BY s_name ORDER BY revenue DESC;
SELECT p_brand, p_type, p_size, SUM(lo_quantity) AS total_quantity FROM lineorder_flat WHERE c_name = 'Customer#000149309' AND lo_orderdate >= '19950101' AND lo_orderdate <= '19951231' GROUP BY p_brand, p_type, p_size ORDER BY total_quantity DESC;
SELECT p_mfgr, COUNT(DISTINCT lo_orderkey) AS num_orders FROM lineorder_flat WHERE lo_orderdate >= '19960101' AND lo_orderdate <= '19961231' AND lo_discount BETWEEN 0.02 AND 0.08 AND lo_quantity < 24 GROUP BY p_mfgr ORDER BY num_orders DESC;
SELECT c_mktsegment, SUM(lo_extendedprice * (1 - lo_discount)) AS revenue FROM lineorder_flat WHERE lo_orderdate >= '19970101' AND lo_orderdate <= '19971231' AND lo_shippriority = '0' GROUP BY c_mktsegment ORDER BY revenue DESC;
SELECT s_region, p_category, SUM(lo_revenue) AS total_revenue FROM lineorder_flat WHERE lo_orderdate >= '19980101' AND lo_orderdate <= '19981231' AND lo_discount BETWEEN 0.05 AND 0.07 AND lo_quantity BETWEEN 36 AND 40 GROUP BY s_region, p_category ORDER BY total_revenue DESC;
SELECT c_nation, p_brand, SUM(lo_extendedprice * (1 - lo_discount)) AS revenue FROM lineorder_flat WHERE lo_orderdate >= '19990101' AND lo_orderdate <= '19991231' AND lo_shipmode IN ('MAIL', 'SHIP') GROUP BY c_nation, p_brand ORDER BY revenue DESC;
SELECT s_city, p_name, SUM(lo_quantity) AS total_quantity FROM lineorder_flat WHERE c_name = 'Customer#000078743' AND lo_orderdate >= '20000101' AND lo_orderdate <= '20001231' AND lo_discount BETWEEN 0.01 AND 0.03 AND lo_quantity < 20 GROUP BY s_city, p_name ORDER BY total_quantity DESC;