SELECT c_region, COUNT(DISTINCT lo_orderkey) AS num_orders, SUM(lo_extendedprice * lo_discount) AS total_discounted_price FROM lineorder_flat WHERE lo_orderpriority = '1-URGENT' OR lo_orderpriority = '2-HIGH' GROUP BY c_region ORDER BY total_discounted_price DESC;
SELECT p_category, AVG(lo_quantity) AS avg_quantity, AVG(lo_extendedprice) AS avg_extendedprice, AVG(lo_supplycost) AS avg_supplycost FROM lineorder_flat WHERE p_type IN ('STANDARD PLATED COPPER', 'LARGE BURNISHED COPPER', 'STANDARD BURNISHED NICKEL') GROUP BY p_category;
SELECT s_name, s_city, s_nation, SUM(lo_revenue) AS total_revenue FROM lineorder_flat WHERE lo_revenue IN (796022, 2555787, 1511492) GROUP BY s_name, s_city, s_nation HAVING SUM(lo_revenue) > 1000000 ORDER BY total_revenue DESC;
SELECT c_mktsegment, COUNT(DISTINCT lo_custkey) AS num_customers, SUM(lo_extendedprice) AS total_extendedprice FROM lineorder_flat WHERE lo_orderdate BETWEEN 19940101 AND 19941231 GROUP BY c_mktsegment HAVING COUNT(DISTINCT lo_custkey) > 10 ORDER BY total_extendedprice DESC;
SELECT p_brand, p_color, p_size, COUNT(DISTINCT lo_partkey) AS num_parts, SUM(lo_supplycost) AS total_supplycost FROM lineorder_flat WHERE p_container = 'SM CASE' OR p_container = 'LG CASE' GROUP BY p_brand, p_color, p_size HAVING COUNT(DISTINCT lo_partkey) > 5 ORDER BY total_supplycost DESC;