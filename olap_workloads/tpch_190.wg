SELECT n_name, r_name, COUNT(c_custkey) AS num_customers FROM nation JOIN region ON n_regionkey = r_regionkey JOIN customer ON n_nationkey = c_nationkey GROUP BY n_name, r_name ORDER BY r_name, n_name;
SELECT p_type, p_brand, SUM(ps_availqty) AS total_inventory FROM part JOIN partsupp ON p_partkey = ps_partkey GROUP BY p_type, p_brand HAVING SUM(ps_availqty) > 1000 ORDER BY p_type, p_brand;
SELECT o_orderpriority, COUNT(o_orderkey) AS num_orders, AVG(o_totalprice) AS avg_order_total FROM orders WHERE o_orderdate >= '1994-01-01' AND o_orderdate <= '1994-12-31' GROUP BY o_orderpriority ORDER BY o_orderpriority;
SELECT s_name, COUNT(l_orderkey) AS num_orders FROM supplier JOIN lineitem ON s_suppkey = l_suppkey JOIN orders ON l_orderkey = o_orderkey WHERE o_orderdate >= '1995-01-01' AND o_orderdate <= '1995-12-31' GROUP BY s_name HAVING COUNT(l_orderkey) > 10 ORDER BY num_orders DESC;
SELECT c_name, c_mktsegment, SUM(l_extendedprice * (1 - l_discount)) AS revenue FROM customer JOIN orders ON c_custkey = o_custkey JOIN lineitem ON o_orderkey = l_orderkey WHERE l_shipdate >= '1994-01-01' AND l_shipdate <= '1994-12-31' GROUP BY c_name, c_mktsegment ORDER BY revenue DESC;