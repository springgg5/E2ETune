SELECT ws.ws_web_site_sk, ws.ws_item_sk, SUM(ws.ws_sales_price) AS total_sales FROM web_sales ws INNER JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk WHERE w.web_close_date_sk BETWEEN 2446944 AND 2447046 AND w.web_tax_percentage = 0.09 GROUP BY ws.ws_web_site_sk, ws.ws_item_sk HAVING SUM(ws.ws_sales_price) > 10000 ORDER BY total_sales DESC;
SELECT w.w_warehouse_name, SUM(inv.inv_quantity_on_hand) AS total_inventory FROM inventory inv INNER JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk GROUP BY w.w_warehouse_name HAVING SUM(inv.inv_quantity_on_hand) > 100000 ORDER BY total_inventory DESC;
SELECT c.c_first_name, c.c_last_name, COUNT(ss.ss_ticket_number) AS total_purchases FROM store_sales ss INNER JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk WHERE c.c_birth_year BETWEEN 1980 AND 1990 GROUP BY c.c_first_name, c.c_last_name HAVING COUNT(ss.ss_ticket_number) > 10 ORDER BY total_purchases DESC;
SELECT p.p_promo_name, SUM(cs.cs_sales_price) AS total_sales FROM catalog_sales cs INNER JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk WHERE p.p_discount_active = 'Y' GROUP BY p.p_promo_name HAVING SUM(cs.cs_sales_price) > 5000 ORDER BY total_sales DESC;
SELECT i.i_item_id, i.i_category, COUNT(ws.ws_order_number) AS total_orders FROM web_sales ws INNER JOIN item i ON ws.ws_item_sk = i.i_item_sk WHERE i.i_category IN ('Electronics', 'Clothing', 'Toys') GROUP BY i.i_item_id, i.i_category HAVING COUNT(ws.ws_order_number) > 100 ORDER BY total_orders DESC;
SELECT s.s_store_name, AVG(ss.ss_sales_price) AS avg_sales_price FROM store_sales ss INNER JOIN store s ON ss.ss_store_sk = s.s_store_sk WHERE s.s_state IN ('CA', 'NY', 'TX') GROUP BY s.s_store_name HAVING AVG(ss.ss_sales_price) > 50 ORDER BY avg_sales_price DESC;