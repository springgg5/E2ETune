SELECT c_region, s_nation, p_category, COUNT(lo_orderkey) AS order_count, SUM(lo_revenue) AS total_revenue, AVG(lo_revenue) AS avg_revenue FROM lineorder_flat WHERE lo_orderkey IN (26567078, 3029989, 14885538) AND lo_quantity IN (13, 14, 41) AND s_nation IN ('INDONESIA', 'FRANCE', 'JORDAN') GROUP BY c_region, s_nation, p_category ORDER BY c_region, s_nation, p_category;
SELECT lo_orderpriority, COUNT(lo_orderkey) AS order_count, SUM(lo_extendedprice) AS total_extended_price, AVG(lo_extendedprice) AS avg_extended_price FROM lineorder_flat WHERE lo_orderdate BETWEEN 20210101 AND 20211231 GROUP BY lo_orderpriority HAVING COUNT(lo_orderkey) > 10 ORDER BY lo_orderpriority;
SELECT s_name, s_city, s_nation, SUM(lo_supplycost) AS total_supply_cost, COUNT(lo_orderkey) AS order_count FROM lineorder_flat WHERE lo_commitdate BETWEEN 20210101 AND 20211231 AND s_nation IN ('INDONESIA', 'FRANCE', 'JORDAN') GROUP BY s_name, s_city, s_nation HAVING COUNT(lo_orderkey) > 5 ORDER BY total_supply_cost DESC;
SELECT p_name, p_mfgr, p_category, p_brand, SUM(lo_quantity) AS total_quantity_sold, COUNT(lo_orderkey) AS order_count FROM lineorder_flat WHERE lo_shipmode IN ('AIR', 'RAIL', 'SHIP', 'TRUCK') AND p_size BETWEEN 1 AND 50 GROUP BY p_name, p_mfgr, p_category, p_brand HAVING COUNT(lo_orderkey) > 10 ORDER BY total_quantity_sold DESC;