SELECT r.r_name, n.n_name, COUNT(c.c_custkey) as num_customers, AVG(c.c_acctbal) as avg_acctbal, SUM(o.o_totalprice) as total_revenue FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN customer c ON n.n_nationkey = c.c_nationkey JOIN orders o ON c.c_custkey = o.o_custkey WHERE o.o_orderdate BETWEEN '1996-01-01' AND '1996-12-31' GROUP BY r.r_name, n.n_name ORDER BY r.r_name, total_revenue DESC;
SELECT p.p_name, p.p_type, p.p_container, SUM(l.l_quantity) as total_quantity, COUNT(DISTINCT l.l_orderkey) as num_orders FROM part p JOIN lineitem l ON p.p_partkey = l.l_partkey WHERE l.l_shipdate BETWEEN '1996-01-01' AND '1996-12-31' AND p.p_size IN (24, 11, 33) AND l.l_linestatus = 'F' GROUP BY p.p_name, p.p_type, p.p_container HAVING SUM(l.l_quantity) > 1000 ORDER BY total_quantity DESC, num_orders DESC;