SELECT ws.ws_web_site_sk, ws.ws_item_sk, ws.ws_order_number, i.i_category, COUNT(*) AS total_sales, SUM(ws.ws_net_paid) AS total_revenue FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk WHERE ws.ws_ship_addr_sk IN (30226, 18428, 39932) AND ws.ws_ext_wholesale_cost IN (1127.00, 1637.48, 1129.36) AND ws.ws_net_paid_inc_ship_tax IN (2066.07, 3308.56, 1858.52) GROUP BY ws.ws_web_site_sk, ws.ws_item_sk, ws.ws_order_number, i.i_category ORDER BY total_sales DESC, total_revenue DESC LIMIT 10;
SELECT s.s_store_id, s.s_store_name, SUM(ss.ss_quantity) AS total_items_sold, AVG(ss.ss_net_profit) AS avg_profit FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk WHERE ss.ss_sold_date_sk BETWEEN 2450966 AND 2451468 AND ss.ss_hdemo_sk IN (2010, 5964, 4288) GROUP BY s.s_store_id, s.s_store_name HAVING AVG(ss.ss_net_profit) > 0 ORDER BY avg_profit DESC;
SELECT w.web_site_id, w.web_manager, COUNT(DISTINCT wp.wp_web_page_sk) AS total_pages, SUM(wp.wp_image_count) AS total_images, SUM(wp.wp_char_count) AS total_chars FROM web_site w JOIN web_page wp ON w.web_site_sk = wp.wp_web_page_sk WHERE w.web_mkt_id IN ('1', '5', '4') AND w.web_manager IN ('Jimmy Pope', 'Charles Castillo', 'James Austin') AND wp.wp_rec_start_date >= '1997-09-03' AND wp.wp_rec_end_date <= '2001-09-02' GROUP BY w.web_site_id, w.web_manager ORDER BY total_pages DESC, total_images DESC, total_chars DESC;
SELECT r.r_reason_desc, COUNT(sr.sr_item_sk) AS total_returns, SUM(sr.sr_net_loss) AS total_loss FROM store_returns sr JOIN reason r ON sr.sr_reason_sk = r.r_reason_sk WHERE sr.sr_returned_date_sk BETWEEN 2450966 AND 2451468 AND sr.sr_reason_sk IN (22, 2, 15) GROUP BY r.r_reason_desc HAVING COUNT(sr.sr_item_sk) > 0 ORDER BY total_returns DESC, total_loss DESC;
SELECT i.i_category, i.i_class, COUNT(*) AS total_items, AVG(inv.inv_quantity_on_hand) AS avg_inventory FROM inventory inv JOIN item i ON inv.inv_item_sk = i.i_item_sk WHERE inv.inv_date_sk BETWEEN 2450966 AND 2451468 GROUP BY i.i_category, i.i_class HAVING AVG(inv.inv_quantity_on_hand) > 0 ORDER BY total_items DESC, avg_inventory DESC;
SELECT c.c_first_name, c.c_last_name, COUNT(wr.wr_item_sk) AS total_returns, SUM(wr.wr_net_loss) AS total_loss FROM web_returns wr JOIN customer c ON wr.wr_returning_customer_sk = c.c_customer_sk WHERE wr.wr_returned_date_sk BETWEEN 2450966 AND 2451468 AND wr.wr_order_number IN (11227, 6220, 36996) GROUP BY c.c_first_name, c.c_last_name HAVING COUNT(wr.wr_item_sk) > 0 ORDER BY total_returns DESC, total_loss DESC;