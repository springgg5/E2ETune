SELECT c.c_name, c.c_address, c.c_mktsegment, SUM(o.o_totalprice) AS total_spent FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey WHERE c.c_nationkey = 14 AND c.c_mktsegment = 'HOUSEHOLD' AND o.o_orderdate BETWEEN '1993-05-08' AND '1997-01-04' GROUP BY c.c_name, c.c_address, c.c_mktsegment HAVING SUM(o.o_totalprice) > 100000 ORDER BY total_spent DESC;
SELECT r.r_name, COUNT(DISTINCT s.s_suppkey) AS supplier_count, AVG(ps.ps_supplycost) AS avg_supplycost FROM region r JOIN nation n ON r.r_regionkey = n.n_regionkey JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey WHERE r.r_name = 'ASIA' AND ps.ps_availqty > 1000 GROUP BY r.r_name;
SELECT o.o_orderpriority, COUNT(l.l_orderkey) AS order_count, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue FROM orders o JOIN lineitem l ON o.o_orderkey = l.l_orderkey WHERE o.o_orderdate >= '1993-01-29' AND l.l_shipdate <= '1993-05-08' AND o.o_orderpriority IN ('1-URGENT', '2-HIGH') GROUP BY o.o_orderpriority ORDER BY o.o_orderpriority;