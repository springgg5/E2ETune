SELECT s.s_region, d.d_year, SUM(lo.lo_revenue) AS total_revenue FROM lineorder lo JOIN supplier s ON lo.lo_suppkey = s.s_suppkey JOIN date_dim d ON lo.lo_orderdate = d.d_datekey WHERE s.s_region IN ('EUROPE', 'AMERICA', 'MIDDLE EAST') AND d.d_holidayfl = '1' GROUP BY s.s_region, d.d_year ORDER BY s.s_region, d.d_year;
SELECT p.p_category, p.p_container, COUNT(lo.lo_orderkey) AS total_orders, AVG(lo.lo_quantity) AS avg_quantity FROM lineorder lo JOIN part p ON lo.lo_partkey = p.p_partkey WHERE p.p_category IN ('MFGR#45', 'MFGR#32', 'MFGR#22') AND p.p_container IN ('LG CAN', 'JUMBO CASE', 'WRAP BAG') GROUP BY p.p_category, p.p_container ORDER BY p.p_category, p.p_container;
SELECT c.c_mktsegment, d.d_weeknuminyear, SUM(lo.lo_extendedprice * lo.lo_discount) AS total_discounted_price FROM lineorder lo JOIN customer c ON lo.lo_custkey = c.c_custkey JOIN date_dim d ON lo.lo_orderdate = d.d_datekey WHERE d.d_weeknuminyear IN (46, 18, 19) GROUP BY c.c_mktsegment, d.d_weeknuminyear ORDER BY c.c_mktsegment, d.d_weeknuminyear;
SELECT s.s_city, p.p_type, COUNT(lo.lo_orderkey) AS total_orders, SUM(lo.lo_supplycost) AS total_supply_cost FROM lineorder lo JOIN supplier s ON lo.lo_suppkey = s.s_suppkey JOIN part p ON lo.lo_partkey = p.p_partkey WHERE s.s_city IN ('KENYA    2', 'MOZAMBIQU2', 'MOROCCO  3') AND p.p_type IN ('MEDIUM BURNISHED TIN', 'MEDIUM ANODIZED TIN', 'PROMO POLISHED NICKEL') GROUP BY s.s_city, p.p_type ORDER BY s.s_city, p.p_type;