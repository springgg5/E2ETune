SELECT n_name, COUNT(*) AS num_customers FROM nation JOIN customer ON nation.n_nationkey = customer.c_nationkey GROUP BY n_name ORDER BY num_customers DESC;
SELECT o_orderpriority, AVG(o_totalprice) AS avg_totalprice FROM orders WHERE o_orderdate BETWEEN '1995-01-01' AND '1998-12-31' GROUP BY o_orderpriority ORDER BY avg_totalprice DESC;
SELECT p_name, p_type, SUM(ps_availqty) AS total_avail_qty FROM part JOIN partsupp ON part.p_partkey = partsupp.ps_partkey WHERE p_retailprice BETWEEN 1000 AND 2000 GROUP BY p_name, p_type ORDER BY total_avail_qty DESC;
SELECT c_name, SUM(l_extendedprice * (1 - l_discount)) AS revenue FROM customer JOIN orders ON customer.c_custkey = orders.o_custkey JOIN lineitem ON orders.o_orderkey = lineitem.l_orderkey WHERE c_nationkey IN (SELECT n_nationkey FROM nation WHERE n_regionkey = 3) AND o_orderdate >= '1995-01-01' AND o_orderdate <= '1998-12-31' GROUP BY c_name ORDER BY revenue DESC;
SELECT s_name, COUNT(DISTINCT l_orderkey) AS num_orders FROM supplier JOIN lineitem ON supplier.s_suppkey = lineitem.l_suppkey JOIN orders ON lineitem.l_orderkey = orders.o_orderkey WHERE l_shipdate >= '1995-01-01' AND l_shipdate <= '1998-12-31' GROUP BY s_name ORDER BY num_orders DESC;