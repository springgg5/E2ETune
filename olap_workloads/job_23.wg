SELECT n.name, COUNT(*) AS total_roles FROM name n JOIN cast_info ci ON n.id = ci.person_id WHERE ci.role_id = 1 AND ci.movie_id IN (SELECT id FROM title WHERE kind_id = 3) GROUP BY n.name HAVING COUNT(*) > 5 ORDER BY total_roles DESC;
SELECT t.title, COUNT(*) AS total_episodes FROM title t WHERE t.kind_id = 1 AND t.episode_of_id IN (SELECT id FROM title WHERE kind_id = 2) GROUP BY t.title HAVING COUNT(*) > 50 ORDER BY total_episodes DESC;
SELECT c.name, COUNT(*) AS total_companies FROM company_name c JOIN movie_companies mc ON c.id = mc.company_id WHERE mc.company_type_id = 1 AND mc.movie_id IN (SELECT id FROM title WHERE kind_id = 3) GROUP BY c.name HAVING COUNT(*) > 10 ORDER BY total_companies DESC;
SELECT t.title, COUNT(*) AS total_cast FROM title t JOIN cast_info ci ON t.id = ci.movie_id WHERE t.kind_id = 3 AND ci.role_id = 1 GROUP BY t.title HAVING COUNT(*) > 20 ORDER BY total_cast DESC;
SELECT n.name, COUNT(*) AS total_directed FROM name n JOIN cast_info ci ON n.id = ci.person_id WHERE ci.role_id = 8 AND ci.movie_id IN (SELECT id FROM title WHERE kind_id = 3) GROUP BY n.name HAVING COUNT(*) > 5 ORDER BY total_directed DESC;
SELECT t.title, COUNT(*) AS total_keywords FROM title t JOIN movie_keyword mk ON t.id = mk.movie_id WHERE t.kind_id = 3 GROUP BY t.title HAVING COUNT(*) > 10 ORDER BY total_keywords DESC;
SELECT n.name, COUNT(*) AS total_written FROM name n JOIN cast_info ci ON n.id = ci.person_id WHERE ci.role_id = 2 AND ci.movie_id IN (SELECT id FROM title WHERE kind_id = 3) GROUP BY n.name HAVING COUNT(*) > 5 ORDER BY total_written DESC;
SELECT t.title, AVG(CAST(mi.info AS INTEGER)) AS avg_rating FROM title t JOIN movie_info mi ON t.id = mi.movie_id WHERE t.kind_id = 3 AND mi.info_type_id = 101 GROUP BY t.title HAVING AVG(CAST(mi.info AS INTEGER)) > 8 ORDER BY avg_rating DESC;