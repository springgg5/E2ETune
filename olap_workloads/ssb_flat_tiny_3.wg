SELECT c_region, s_region, p_category, SUM(lo_extendedprice * lo_discount) AS revenue FROM lineorder_flat WHERE lo_orderdate >= 19960120 AND lo_orderdate <= 19971204 AND p_color IN ('floral', 'chartreuse', 'navajo') GROUP BY c_region, s_region, p_category ORDER BY c_region, s_region, p_category;
SELECT c_mktsegment, lo_orderpriority, COUNT(*) AS order_count, AVG(lo_quantity) AS avg_quantity, AVG(lo_extendedprice) AS avg_price, AVG(lo_discount) AS avg_discount FROM lineorder_flat WHERE lo_orderdate >= 19960120 AND lo_orderdate <= 19980506 GROUP BY c_mktsegment, lo_orderpriority ORDER BY c_mktsegment, lo_orderpriority;
SELECT p_mfgr, p_brand, p_container, SUM(lo_supplycost) AS total_supply_cost, COUNT(*) AS num_orders FROM lineorder_flat WHERE lo_orderdate >= 19960120 AND lo_orderdate <= 19971204 AND p_color IN ('floral', 'chartreuse', 'navajo') GROUP BY p_mfgr, p_brand, p_container HAVING COUNT(*) > 10 ORDER BY p_mfgr, p_brand, p_container;