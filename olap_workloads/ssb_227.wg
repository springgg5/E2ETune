SELECT c_name, c_nation, c_city, SUM(lo_extendedprice * lo_discount) AS revenue FROM customer JOIN lineorder ON c_custkey = lo_custkey WHERE lo_orderdate >= 19940101 AND lo_orderdate <= 19941231 AND c_mktsegment = 'HOUSEHOLD' GROUP BY c_name, c_nation, c_city ORDER BY revenue DESC LIMIT 10;
SELECT p_name, p_category, p_brand, p_color, p_size, SUM(lo_quantity) AS total_quantity FROM part JOIN lineorder ON p_partkey = lo_partkey WHERE p_color = 'dark' AND p_size BETWEEN 10 AND 20 GROUP BY p_name, p_category, p_brand, p_color, p_size ORDER BY total_quantity DESC;
SELECT d_yearmonth, SUM(lo_extendedprice * lo_discount) AS monthly_revenue FROM date_dim JOIN lineorder ON d_datekey = lo_orderdate WHERE d_year = 1994 AND lo_discount BETWEEN 4 AND 6 AND lo_quantity < 25 GROUP BY d_yearmonth ORDER BY d_yearmonth ASC;
SELECT s_name, s_nation, s_region, SUM(lo_revenue - lo_supplycost) AS profit FROM supplier JOIN lineorder ON s_suppkey = lo_suppkey WHERE lo_orderdate >= 19940101 AND lo_orderdate <= 19941231 AND s_nation = 'GERMANY' GROUP BY s_name, s_nation, s_region ORDER BY profit DESC;
SELECT d_year, c_nation, SUM(lo_revenue) AS total_revenue FROM date_dim JOIN lineorder ON d_datekey = lo_orderdate JOIN customer ON lo_custkey = c_custkey WHERE d_year IN (1993, 1994) AND c_nation IN ('GERMANY', 'ROMANIA', 'CANADA') GROUP BY d_year, c_nation ORDER BY d_year, c_nation;
SELECT p_type, AVG(lo_quantity) AS avg_quantity, AVG(lo_extendedprice) AS avg_price, AVG(lo_discount) AS avg_discount FROM part JOIN lineorder ON p_partkey = lo_partkey WHERE p_type LIKE 'ECONOMY PLATED%' GROUP BY p_type;
SELECT d_year, COUNT(DISTINCT lo_orderkey) AS num_orders FROM date_dim JOIN lineorder ON d_datekey = lo_orderdate WHERE d_lastdayinweekfl = '1' AND d_year BETWEEN 1993 AND 1997 GROUP BY d_year ORDER BY d_year;
SELECT c_name, c_city, SUM(lo_extendedprice * (1 - lo_discount)) AS net_revenue FROM customer JOIN lineorder ON c_custkey = lo_custkey WHERE c_city IN ('ARGENTINA2', 'FRANCE   7', 'IRAN     7') GROUP BY c_name, c_city ORDER BY net_revenue DESC;
SELECT s_name, s_phone, COUNT(DISTINCT lo_orderkey) AS num_orders FROM supplier JOIN lineorder ON s_suppkey = lo_suppkey WHERE s_nation = 'MOROCCO' AND lo_orderpriority = '1-URGENT' GROUP BY s_name, s_phone ORDER BY num_orders DESC;