SELECT s.s_state, COUNT(DISTINCT ss.ss_ticket_number) AS total_sales, SUM(ss.ss_net_profit) AS total_profit FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN reason r ON ss.ss_promo_sk = r.r_reason_sk WHERE ss.ss_coupon_amt >= 300.44 AND ss.ss_ext_wholesale_cost <= 4441.63 AND r.r_reason_desc = 'reason 29' GROUP BY s.s_state ORDER BY total_profit DESC;
SELECT c.c_customer_sk, c.c_first_name, c.c_last_name, SUM(ss.ss_net_paid_inc_tax) AS total_spent FROM customer c JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk WHERE c.c_preferred_cust_flag = 'Y' AND c.c_current_addr_sk BETWEEN 5617 AND 15896 AND ss.ss_cdemo_sk BETWEEN 45300 AND 280291 GROUP BY c.c_customer_sk, c.c_first_name, c.c_last_name HAVING SUM(ss.ss_net_paid_inc_tax) > 5000 ORDER BY total_spent DESC;
SELECT i.i_item_id, i.i_product_name, COUNT(ss.ss_item_sk) AS total_sold, AVG(ss.ss_sales_price) AS avg_sales_price, AVG(ss.ss_wholesale_cost) AS avg_wholesale_cost FROM store_sales ss JOIN item i ON i.i_item_sk = ss.ss_item_sk WHERE ss.ss_item_sk IN (817, 2107, 420) AND i.i_manufact_id BETWEEN 100 AND 200 GROUP BY i.i_item_id, i.i_product_name HAVING COUNT(ss.ss_item_sk) > 10 ORDER BY total_sold DESC, avg_sales_price DESC;