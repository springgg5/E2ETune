SELECT s.s_state, COUNT(ss.ss_ticket_number) as total_sales, SUM(ss.ss_net_profit) as net_profit FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk WHERE ss.ss_sold_date_sk BETWEEN 2450859 AND 2450860 GROUP BY s.s_state ORDER BY net_profit DESC;
SELECT c.cc_name, c.cc_manager, COUNT(cs.cs_order_number) as total_orders FROM catalog_sales cs JOIN call_center c ON cs.cs_call_center_sk = c.cc_call_center_sk WHERE cs.cs_sold_date_sk BETWEEN 2450984 AND 2450860 AND cs.cs_catalog_page_sk IN (119, 47, 147) GROUP BY c.cc_name, c.cc_manager ORDER BY total_orders DESC;
SELECT s.s_manager, COUNT(sr.sr_ticket_number) as total_returns, SUM(sr.sr_net_loss) as net_loss FROM store_returns sr JOIN store s ON sr.sr_store_sk = s.s_store_sk WHERE s.s_manager IN ('Scott Smith', 'David Thomas', 'Raymond Jacobs') GROUP BY s.s_manager ORDER BY net_loss ASC;
SELECT w.w_warehouse_name, SUM(i.inv_quantity_on_hand) as total_inventory FROM inventory i JOIN warehouse w ON i.inv_warehouse_sk = w.w_warehouse_sk WHERE i.inv_date_sk = 2451044 GROUP BY w.w_warehouse_name HAVING SUM(i.inv_quantity_on_hand) > 10000 ORDER BY total_inventory DESC;
SELECT EXTRACT(YEAR FROM d_date) as year, COUNT(DISTINCT cs.cs_order_number) as total_orders, AVG(cs.cs_net_paid) as avg_net_paid FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE d.d_date >= '2023-11-20' GROUP BY year ORDER BY year ASC, total_orders DESC;