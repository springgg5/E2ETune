SELECT s.s_state, COUNT(*) AS num_returns, SUM(sr.sr_return_amt_inc_tax) AS total_return_amt_inc_tax FROM store_returns sr JOIN store s ON sr.sr_store_sk = s.s_store_sk JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk WHERE d.d_current_month = 'N' GROUP BY s.s_state ORDER BY total_return_amt_inc_tax DESC LIMIT 10;
SELECT d.d_moy, COUNT(*) AS num_sales, SUM(ss.ss_net_paid) AS total_net_paid FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE d.d_current_year = 'Y' GROUP BY d.d_moy ORDER BY d.d_moy;
SELECT ws.ws_web_site_sk, COUNT(*) AS num_web_sales, SUM(ws.ws_net_profit) AS total_net_profit FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE d.d_current_year = 'Y' GROUP BY ws.ws_web_site_sk ORDER BY total_net_profit DESC LIMIT 5;
SELECT i.i_category, SUM(inv.inv_quantity_on_hand) AS total_inventory FROM inventory inv JOIN item i ON inv.inv_item_sk = i.i_item_sk GROUP BY i.i_category ORDER BY total_inventory DESC LIMIT 10;
SELECT p.p_promo_name, COUNT(*) AS num_sales, SUM(cs.cs_net_paid) AS total_net_paid FROM catalog_sales cs JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE d.d_current_year = 'Y' AND p.p_channel_tv = 'Y' GROUP BY p.p_promo_name ORDER BY total_net_paid DESC LIMIT 10;
SELECT r.r_reason_desc, COUNT(*) AS num_returns, SUM(cr.cr_net_loss) AS total_net_loss FROM catalog_returns cr JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk WHERE d.d_current_year = 'Y' GROUP BY r.r_reason_desc ORDER BY total_net_loss DESC LIMIT 5;
SELECT d.d_fy_week_seq, COUNT(*) AS num_sales, SUM(ss.ss_net_paid) AS total_net_paid FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE d.d_current_year = 'Y' GROUP BY d.d_fy_week_seq ORDER BY d.d_fy_week_seq;