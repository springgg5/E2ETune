SELECT c_mktsegment, COUNT(lo_orderkey) AS num_orders, SUM(lo_revenue) AS total_revenue, AVG(lo_revenue) AS avg_revenue FROM lineorder_flat WHERE lo_partkey IN (5151, 5155, 5153) GROUP BY c_mktsegment;
SELECT p_category, p_brand, SUM(lo_quantity) AS total_quantity, COUNT(lo_orderkey) AS num_orders FROM lineorder_flat WHERE lo_revenue BETWEEN 2607710 AND 3865499 AND c_mktsegment = 'MACHINERY' GROUP BY p_category, p_brand ORDER BY total_quantity DESC;
SELECT c_region, s_region, COUNT(lo_orderkey) AS num_orders, SUM(lo_supplycost) AS total_supply_cost FROM lineorder_flat WHERE lo_orderpriority = '1-URGENT' AND lo_shipmode = 'AIR' GROUP BY c_region, s_region HAVING COUNT(lo_orderkey) > 10 ORDER BY total_supply_cost DESC;