SELECT s.s_state, AVG(ss.ss_net_profit) as average_net_profit, COUNT(ss.ss_ticket_number) as total_sales FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk WHERE ss.ss_net_profit BETWEEN -283.00 AND 686.70 GROUP BY s.s_state ORDER BY average_net_profit DESC;
SELECT ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound, COUNT(cd.cd_demo_sk) as num_customers FROM customer_demographics cd JOIN income_band ib ON cd.cd_purchase_estimate BETWEEN ib.ib_lower_bound AND ib.ib_upper_bound GROUP BY ib.ib_income_band_sk, ib.ib_lower_bound, ib.ib_upper_bound ORDER BY ib.ib_income_band_sk;
SELECT cs.cs_ship_mode_sk, COUNT(cs.cs_order_number) as num_orders, SUM(cs.cs_ext_ship_cost) as total_shipping_cost, AVG(cs.cs_wholesale_cost) as average_wholesale_cost FROM catalog_sales cs WHERE cs.cs_sold_date_sk BETWEEN 2450859 AND 2450978 AND cs.cs_ship_mode_sk IN (13, 7, 20) GROUP BY cs.cs_ship_mode_sk ORDER BY num_orders DESC;