SELECT ca_state, COUNT(*) AS num_customers FROM customer_address WHERE ca_address_id IN ('AAAAAAAAECAAAAAA', 'AAAAAAAAEPBAAAAA', 'AAAAAAAACECAAAAA') GROUP BY ca_state;
SELECT s_store_name, SUM(ss_quantity) AS total_quantity_sold FROM store_sales JOIN store ON ss_store_sk = s_store_sk WHERE ss_item_sk IN (267, 347, 781) GROUP BY s_store_name;
SELECT ca_state, AVG(sr_return_amt) AS avg_return_amt, AVG(sr_fee) AS avg_fee FROM store_returns JOIN customer_address ON sr_addr_sk = ca_address_sk WHERE sr_return_amt BETWEEN 296.03 AND 1200.01 AND sr_fee BETWEEN 56.58 AND 96.35 GROUP BY ca_state;
SELECT i_category, SUM(inv_quantity_on_hand) AS total_inventory FROM inventory JOIN item ON inv_item_sk = i_item_sk GROUP BY i_category HAVING SUM(inv_quantity_on_hand) > 1000 ORDER BY total_inventory DESC;
SELECT w_warehouse_name, COUNT(*) AS num_orders FROM catalog_sales JOIN warehouse ON cs_warehouse_sk = w_warehouse_sk WHERE cs_wholesale_cost > 100 AND cs_sales_price > 200 GROUP BY w_warehouse_name HAVING COUNT(*) > 10;
SELECT d_year, d_month_seq, COUNT(*) AS num_orders FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_year BETWEEN 2000 AND 2005 AND ss_net_profit > 0 GROUP BY d_year, d_month_seq ORDER BY d_year, d_month_seq;