SELECT s.s_state, COUNT(ss.ss_ticket_number) AS num_sales, SUM(ss.ss_net_paid) AS total_revenue FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk WHERE ss.ss_sold_date_sk BETWEEN 2415355 AND 2415598 GROUP BY s.s_state HAVING COUNT(ss.ss_ticket_number) > 1000 ORDER BY total_revenue DESC;
SELECT i.i_category, SUM(cs.cs_quantity) AS total_quantity, AVG(cs.cs_sales_price) AS avg_sales_price FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk WHERE cs.cs_sold_date_sk = 2415172 GROUP BY i.i_category ORDER BY total_quantity DESC;
SELECT w.w_state, SUM(inv.inv_quantity_on_hand) AS total_inventory FROM inventory inv JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk GROUP BY w.w_state HAVING SUM(inv.inv_quantity_on_hand) > 500000 ORDER BY total_inventory DESC;
SELECT d.d_year, d.d_month_seq, COUNT(DISTINCT ws.ws_order_number) AS num_orders FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE d.d_same_day_lq = 2415662 GROUP BY d.d_year, d.d_month_seq ORDER BY d.d_year, d.d_month_seq;
SELECT p.p_promo_name, COUNT(cs.cs_order_number) AS num_orders, SUM(cs.cs_net_paid) AS total_revenue FROM catalog_sales cs JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk WHERE cs.cs_sold_date_sk BETWEEN 2415355 AND 2415598 AND p.p_discount_active = 'Y' GROUP BY p.p_promo_name HAVING COUNT(cs.cs_order_number) > 50 ORDER BY total_revenue DESC;
SELECT t.t_hour, COUNT(sr.sr_ticket_number) AS num_returns, SUM(sr.sr_net_loss) AS total_loss FROM store_returns sr JOIN time_dim t ON sr.sr_return_time_sk = t.t_time_sk WHERE sr.sr_returned_date_sk BETWEEN 2415525 AND 2415909 GROUP BY t.t_hour ORDER BY num_returns DESC;
SELECT r.r_reason_desc, COUNT(cr.cr_order_number) AS num_returns, SUM(cr.cr_net_loss) AS total_loss FROM catalog_returns cr JOIN reason r ON cr.cr_reason_sk = r.r_reason_sk WHERE cr.cr_returned_date_sk BETWEEN 2415525 AND 2415909 GROUP BY r.r_reason_desc HAVING COUNT(cr.cr_order_number) > 10 ORDER BY total_loss DESC;