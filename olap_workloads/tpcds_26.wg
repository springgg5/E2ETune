SELECT c.c_salutation, c.c_first_name, COUNT(*) AS num_orders FROM customer c JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk WHERE c.c_salutation IN ('Dr.', 'Ms.', 'Mrs.') GROUP BY c.c_salutation, c.c_first_name ORDER BY num_orders DESC LIMIT 10;
SELECT sm.sm_carrier, COUNT(*) AS num_shipments FROM ship_mode sm JOIN web_sales ws ON sm.sm_ship_mode_sk = ws.ws_ship_mode_sk WHERE sm.sm_carrier IN ('PRIVATECARRIER', 'MSC', 'DHL') GROUP BY sm.sm_carrier ORDER BY num_shipments DESC;
SELECT cs.cs_warehouse_sk, SUM(cs.cs_net_paid_inc_ship) AS total_revenue FROM catalog_sales cs WHERE cs.cs_warehouse_sk IN (5, 3, 4) AND cs.cs_bill_customer_sk IN (45471, 12612, 40584) GROUP BY cs.cs_warehouse_sk ORDER BY total_revenue DESC;
SELECT ca.ca_city, ca.ca_state, AVG(cd.cd_purchase_estimate) AS avg_purchase_estimate FROM customer_address ca JOIN customer c ON ca.ca_address_sk = c.c_current_addr_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk GROUP BY ca.ca_city, ca.ca_state ORDER BY avg_purchase_estimate DESC LIMIT 10;
SELECT i.i_category, COUNT(*) AS num_items, SUM(inv.inv_quantity_on_hand) AS total_inventory FROM item i JOIN inventory inv ON i.i_item_sk = inv.inv_item_sk GROUP BY i.i_category HAVING SUM(inv.inv_quantity_on_hand) > 1000 ORDER BY num_items DESC, total_inventory DESC;