SELECT w_state, COUNT(*) AS num_warehouses FROM warehouse GROUP BY w_state ORDER BY num_warehouses DESC;
SELECT i_category, AVG(i_current_price) AS avg_price FROM item GROUP BY i_category ORDER BY avg_price DESC;
SELECT s_state, SUM(ss_sales_price) AS total_sales FROM store_sales JOIN store ON ss_store_sk = s_store_sk GROUP BY s_state ORDER BY total_sales DESC;
SELECT c_birth_country, COUNT(*) AS num_customers FROM customer WHERE c_preferred_cust_flag = 'Y' GROUP BY c_birth_country ORDER BY num_customers DESC;
SELECT ws.ws_web_site_sk, ws.ws_web_page_sk, SUM(ws.ws_net_paid) AS total_revenue FROM web_sales ws JOIN web_site ws_site ON ws.ws_web_site_sk = ws_site.web_site_sk WHERE ws_site.web_zip = '35709' GROUP BY ws.ws_web_site_sk, ws.ws_web_page_sk ORDER BY total_revenue DESC;
SELECT p_promo_name, SUM(cs_sales_price) AS total_sales FROM catalog_sales JOIN promotion ON cs_promo_sk = p_promo_sk WHERE p_start_date_sk >= 2447148 AND p_end_date_sk <= 2448820 GROUP BY p_promo_name ORDER BY total_sales DESC;
SELECT t_hour, COUNT(*) AS num_orders FROM store_sales JOIN time_dim ON ss_sold_time_sk = t_time_sk WHERE t_second = 57 GROUP BY t_hour ORDER BY num_orders DESC;
SELECT ca_state, AVG(cd_purchase_estimate) AS avg_purchase_estimate FROM customer_demographics JOIN customer ON c_current_cdemo_sk = cd_demo_sk JOIN customer_address ON c_current_addr_sk = ca_address_sk GROUP BY ca_state ORDER BY avg_purchase_estimate DESC;
SELECT i.i_item_id, i.i_category, COUNT(*) AS num_sold FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk WHERE ss.ss_sold_date_sk BETWEEN 2446944 AND 2448820 GROUP BY i.i_item_id, i.i_category HAVING COUNT(*) > 10 ORDER BY num_sold DESC;
SELECT r_reason_desc, COUNT(*) AS num_returns FROM store_returns JOIN reason ON sr_reason_sk = r_reason_sk GROUP BY r_reason_desc ORDER BY num_returns DESC;