SELECT c_name, c_city, c_nation, c_region, SUM(lo_extendedprice * (1 - lo_discount)) AS revenue FROM lineorder_flat WHERE lo_custkey IN (106652, 5458, 33656) AND lo_shippriority = '0' GROUP BY c_name, c_city, c_nation, c_region ORDER BY revenue DESC;
SELECT p_category, p_brand, p_color, p_type, p_size, COUNT(*) AS num_orders, AVG(lo_quantity) AS avg_quantity, AVG(lo_extendedprice) AS avg_extendedprice, AVG(lo_discount) AS avg_discount, AVG(lo_supplycost) AS avg_supplycost FROM lineorder_flat WHERE lo_orderdate >= 19940101 AND lo_orderdate <= 19941231 AND lo_orderpriority IN ('1-URGENT', '2-HIGH') GROUP BY p_category, p_brand, p_color, p_type, p_size HAVING COUNT(*) > 10 ORDER BY num_orders DESC, avg_quantity DESC;