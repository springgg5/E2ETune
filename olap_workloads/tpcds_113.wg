SELECT ws.ws_item_sk, ws.ws_order_number, SUM(ws.ws_sales_price) as total_sales, COUNT(ws.ws_item_sk) as total_items_sold FROM web_sales ws WHERE ws.ws_list_price IN (127.35, 24.43, 112.38) AND ws.ws_warehouse_sk IN (4, 5, 1) GROUP BY ws.ws_item_sk, ws.ws_order_number HAVING COUNT(ws.ws_item_sk) > 10 ORDER BY total_sales DESC, total_items_sold DESC;
SELECT wp.wp_url, wp.wp_type, COUNT(ws.ws_item_sk) as total_items_sold, SUM(ws.ws_sales_price) as total_sales FROM web_page wp JOIN web_sales ws ON wp.wp_web_page_sk = ws.ws_web_page_sk WHERE wp.wp_access_date_sk IN (2452623, 2452597, 2452645) AND wp.wp_url = 'http://www.foo.com' GROUP BY wp.wp_url, wp.wp_type ORDER BY total_sales DESC;
SELECT ws.ws_bill_cdemo_sk, cd.cd_gender, cd.cd_marital_status, COUNT(ws.ws_item_sk) as total_items_sold, SUM(ws.ws_sales_price) as total_sales FROM web_sales ws JOIN customer_demographics cd ON ws.ws_bill_cdemo_sk = cd.cd_demo_sk WHERE ws.ws_bill_cdemo_sk IN (1098805, 1564842, 1375609) GROUP BY ws.ws_bill_cdemo_sk, cd.cd_gender, cd.cd_marital_status ORDER BY total_sales DESC;
SELECT s.s_store_name, s.s_city, s.s_state, COUNT(ss.ss_item_sk) as total_items_sold, SUM(ss.ss_sales_price) as total_sales FROM store s JOIN store_sales ss ON s.s_store_sk = ss.ss_store_sk WHERE s.s_market_id IN (SELECT s_market_id FROM store GROUP BY s_market_id HAVING COUNT(s_store_id) > 5) GROUP BY s.s_store_name, s.s_city, s.s_state ORDER BY total_sales DESC;