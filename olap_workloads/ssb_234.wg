SELECT c.c_nation, SUM(lo.lo_extendedprice * lo.lo_discount) AS total_discounted_price FROM lineorder lo JOIN customer c ON lo.lo_custkey = c.c_custkey WHERE lo.lo_discount IN (8, 6, 9) AND c.c_nation IN ('EGYPT', 'ETHIOPIA', 'SAUDI ARABIA') GROUP BY c.c_nation ORDER BY c.c_nation;
SELECT p.p_category, COUNT(lo.lo_orderkey) AS num_orders, AVG(lo.lo_quantity) AS avg_quantity, SUM(lo.lo_revenue) AS total_revenue FROM lineorder lo JOIN part p ON lo.lo_partkey = p.p_partkey WHERE lo.lo_partkey IN (276210, 457496, 50363) GROUP BY p.p_category ORDER BY p.p_category;
SELECT d.d_year, d.d_month, SUM(lo.lo_ordtotalprice) AS total_monthly_sales FROM lineorder lo JOIN date_dim d ON lo.lo_orderdate = d.d_datekey WHERE lo.lo_orderpriority = '1-URGENT' GROUP BY d.d_year, d.d_month ORDER BY d.d_year, d.d_month;
SELECT s.s_region, COUNT(lo.lo_orderkey) AS num_orders, SUM(lo.lo_supplycost) AS total_supply_cost FROM lineorder lo JOIN supplier s ON lo.lo_suppkey = s.s_suppkey WHERE lo.lo_suppkey IN (6204, 38929, 2864) GROUP BY s.s_region ORDER BY s.s_region;
SELECT c.c_mktsegment, COUNT(lo.lo_orderkey) AS num_orders, SUM(lo.lo_revenue) AS total_revenue, AVG(lo.lo_tax) AS avg_tax FROM lineorder lo JOIN customer c ON lo.lo_custkey = c.c_custkey WHERE c.c_custkey IN (338722, 338748, 338518) GROUP BY c.c_mktsegment ORDER BY c.c_mktsegment;
SELECT p.p_brand, COUNT(lo.lo_orderkey) AS num_orders, AVG(lo.lo_quantity) AS avg_quantity, SUM(lo.lo_revenue) AS total_revenue FROM lineorder lo JOIN part p ON lo.lo_partkey = p.p_partkey WHERE lo.lo_shipmode = 'REG AIR' GROUP BY p.p_brand ORDER BY p.p_brand;
SELECT d.d_year, d.d_month, COUNT(lo.lo_orderkey) AS num_orders, SUM(lo.lo_ordtotalprice) AS total_monthly_sales FROM lineorder lo JOIN date_dim d ON lo.lo_commitdate = d.d_datekey WHERE lo.lo_orderpriority = '5-LOW' AND d.d_holidayfl = 'Y' GROUP BY d.d_year, d.d_month ORDER BY d.d_year, d.d_month;
SELECT s.s_nation, COUNT(lo.lo_orderkey) AS num_orders, SUM(lo.lo_revenue) AS total_revenue, AVG(lo.lo_supplycost) AS avg_supply_cost FROM lineorder lo JOIN supplier s ON lo.lo_suppkey = s.s_suppkey WHERE lo.lo_discount = 9 GROUP BY s.s_nation ORDER BY s.s_nation;