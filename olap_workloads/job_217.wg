SELECT t.id, t.title, COUNT(mk.keyword_id) AS keyword_count FROM title AS t JOIN movie_keyword AS mk ON t.id = mk.movie_id WHERE t.production_year > 2000 GROUP BY t.id, t.title HAVING COUNT(mk.keyword_id) > 5 ORDER BY keyword_count DESC, t.title ASC LIMIT 10;
SELECT k.keyword, COUNT(mk.movie_id) AS movie_count FROM keyword AS k JOIN movie_keyword AS mk ON k.id = mk.keyword_id WHERE k.phonetic_code IN ('L36', 'G542', 'T236') GROUP BY k.keyword HAVING COUNT(mk.movie_id) > 10 ORDER BY movie_count DESC;
SELECT p.name, COUNT(ci.movie_id) AS movie_count FROM name AS p JOIN cast_info AS ci ON p.id = ci.person_id WHERE ci.role_id = 1 GROUP BY p.name HAVING COUNT(ci.movie_id) > 5 ORDER BY movie_count DESC LIMIT 10;
SELECT t.title, COUNT(ml.linked_movie_id) AS linked_movie_count FROM title AS t JOIN movie_link AS ml ON t.id = ml.movie_id WHERE ml.link_type_id IN (11, 7, 5) GROUP BY t.title HAVING COUNT(ml.linked_movie_id) > 3 ORDER BY linked_movie_count DESC;
SELECT t.title, AVG(mi.info::float) AS average_rating FROM title AS t JOIN movie_info AS mi ON t.id = mi.movie_id WHERE mi.info_type_id = 101 GROUP BY t.title HAVING AVG(mi.info::float) > 8.0 ORDER BY average_rating DESC LIMIT 10;
SELECT p.name, COUNT(pi.person_id) AS person_info_count FROM name AS p JOIN person_info AS pi ON p.id = pi.person_id WHERE pi.info_type_id = 38 GROUP BY p.name HAVING COUNT(pi.person_id) > 2 ORDER BY person_info_count DESC;
SELECT t.title, COUNT(mc.company_id) AS company_count FROM title AS t JOIN movie_companies AS mc ON t.id = mc.movie_id WHERE mc.company_type_id = 2 GROUP BY t.title HAVING COUNT(mc.company_id) > 3 ORDER BY company_count DESC;
SELECT t.title, COUNT(DISTINCT ci.person_id) AS actor_count FROM title AS t JOIN cast_info AS ci ON t.id = ci.movie_id WHERE ci.role_id = 1 AND t.production_year BETWEEN 2000 AND 2010 GROUP BY t.title HAVING COUNT(DISTINCT ci.person_id) > 10 ORDER BY actor_count DESC;