SELECT c_region, COUNT(DISTINCT lo_orderkey) AS num_orders, SUM(lo_extendedprice * (1 - lo_discount)) AS revenue FROM lineorder_flat WHERE lo_orderdate >= 19940101 AND lo_orderdate <= 19941231 GROUP BY c_region ORDER BY revenue DESC;
SELECT p_category, p_brand, SUM(lo_quantity) AS total_quantity, AVG(lo_extendedprice) AS avg_price FROM lineorder_flat WHERE lo_orderdate >= 19950101 AND lo_orderdate <= 19951231 AND lo_discount BETWEEN 5 AND 7 AND lo_quantity < 24 GROUP BY p_category, p_brand ORDER BY total_quantity DESC, avg_price ASC;
SELECT c_nation, s_nation, lo_orderpriority, COUNT(*) AS num_orders FROM lineorder_flat WHERE lo_orderdate >= 19960101 AND lo_orderdate <= 19961231 AND (lo_orderkey = 21111654 OR lo_orderkey = 29982150 OR lo_orderkey = 27233059) AND (lo_linenumber = 4 OR lo_linenumber = 5 OR lo_linenumber = 6) GROUP BY c_nation, s_nation, lo_orderpriority ORDER BY num_orders DESC;
SELECT c_city, s_city, p_mfgr, SUM(lo_supplycost) AS total_supply_cost, COUNT(DISTINCT lo_orderkey) AS num_orders FROM lineorder_flat WHERE c_address = 'AhSwQEXHj956' OR c_address = 'lv9MfsC4OODnk1E' OR c_address = '676krHLMgVmFFWbTfm0yc4B' GROUP BY c_city, s_city, p_mfgr HAVING COUNT(DISTINCT lo_orderkey) > 1 ORDER BY total_supply_cost DESC, num_orders ASC;